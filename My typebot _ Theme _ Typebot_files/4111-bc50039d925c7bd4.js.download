try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},l=(new e.Error).stack;l&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[l]="f56571a4-69db-4d37-9cf9-c7eb86bbcba0",e._sentryDebugIdIdentifier="sentry-dbid-f56571a4-69db-4d37-9cf9-c7eb86bbcba0")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4111],{4087:(e,l,n)=>{n.d(l,{C:()=>s});var t=n(6029),i=n(44444),o=n(90869),a=n(58255);n(55729);let s=e=>{let{type:l,...n}=e,s=(0,o.dU)("gray.900","gray.200");switch(l){case a.B.START:return(0,t.jsx)(i.iF,{color:s,...n});case a.B.COMMAND:return(0,t.jsx)(i.t$,{color:s,...n});case a.B.REPLY:return(0,t.jsx)(i.qx,{color:s,...n});case a.B.INVALID_REPLY:return(0,t.jsx)(i.aX,{color:s,...n})}}},10714:(e,l,n)=>{n.d(l,{X:()=>s,a:()=>r});var t=n(6029),i=n(94283),o=n(90944),a=n(58255);n(55729);let s=e=>{let{type:l,...n}=e,{t:a}=(0,o.WD)(),s=r(a)[l];return(0,t.jsx)(i.E,{fontSize:"sm",...n,children:s})},r=e=>({[a.B.START]:e("editor.sidebarBlock.start.label"),[a.B.COMMAND]:e("editor.sidebarBlock.command.label"),[a.B.REPLY]:e("editor.sidebarBlock.reply.label"),[a.B.INVALID_REPLY]:e("editor.sidebarBlock.invalidReply.label")})},25685:(e,l,n)=>{n.d(l,{mI:()=>i,t6:()=>t,tq:()=>a,wA:()=>s,wX:()=>r,zT:()=>o});let t=20,i=300,o={left:{x:0,y:20},top:{x:150,y:0},right:{x:300,y:20}},a=230,s=e=>({x:400-e.x,y:100-e.y,scale:1}),r=20},25942:(e,l,n)=>{n.d(l,{U:()=>o});var t=n(59309),i=n(12482);let o=e=>{let{folderId:l,workspaceId:n}=e,{data:o,isLoading:a,refetch:s}=(0,i.I)(t.id.typebot.listTypebots.queryOptions({workspaceId:n,folderId:l},{enabled:!!n}));return{typebots:null==o?void 0:o.typebots,isLoading:a,refetch:s}}},35098:(e,l,n)=>{n.d(l,{Gj:()=>a,Lt:()=>s,ZV:()=>r,jh:()=>d});var t=n(6029),i=n(55729);let o=(0,i.createContext)({}),a=e=>{let{children:l}=e,[n,a]=(0,i.useState)(),[s,r]=(0,i.useState)(),[d,u]=(0,i.useState)(),[c,p]=(0,i.useState)(),[h,b]=(0,i.useState)(),[x,v]=(0,i.useState)();return(0,t.jsx)(o.Provider,{value:{draggedBlock:n,setDraggedBlock:a,draggedBlockType:s,setDraggedBlockType:r,draggedItem:d,setDraggedItem:u,mouseOverGroup:h,setMouseOverGroup:b,mouseOverBlock:x,setMouseOverBlock:v,draggedEventType:c,setDraggedEventType:p},children:l})},s=e=>{let{ref:l,onDrag:n,distanceTolerance:t=20,isDisabled:o=!1,deps:a=[]}=e,s=(0,i.useRef)(),r=(0,i.useCallback)(()=>{s.current&&(s.current=void 0)},[]);(0,i.useEffect)(()=>(window.addEventListener("mouseup",r),()=>{window.removeEventListener("mouseup",r)}),[r]),(0,i.useEffect)(()=>{var e;let n=e=>{if(o||!l.current)return;e.stopPropagation();let{top:n,left:t}=l.current.getBoundingClientRect();s.current={absolute:{x:e.clientX,y:e.clientY},relative:{x:e.clientX-t,y:e.clientY-n}}};return null==(e=l.current)||e.addEventListener("mousedown",n),()=>{var e;null==(e=l.current)||e.removeEventListener("mousedown",n)}},[o,...a]),(0,i.useEffect)(()=>{let e=!1,l=l=>{if(!s.current||e)return;let i=l.target;if("INPUT"===i.tagName||"TEXTAREA"===i.tagName||"SELECT"===i.tagName||"true"===i.contentEditable||i.closest("[contenteditable=true]"))return;let{clientX:o,clientY:a}=l;(Math.abs(s.current.absolute.x-o)>t||Math.abs(s.current.absolute.y-a)>t)&&(e=!0,n(s.current))};return document.addEventListener("mousemove",l),()=>{document.removeEventListener("mousemove",l)}},[t,n])},r=(e,l)=>{let{closestIndex:n}=l.current.reduce((l,n,t)=>{let i=Math.abs(e-n.getBoundingClientRect().top);return i<l.value?{closestIndex:t,value:i}:l},{closestIndex:0,value:0xe8d4a50fff});return n},d=()=>(0,i.useContext)(o)},55345:(e,l,n)=>{n.d(l,{N:()=>o});var t=n(2283),i=n(13808);let o=e=>(0,t.O9)(e)&&(e.plan===i.cw.PRO||e.plan===i.cw.LIFETIME||e.plan===i.cw.CUSTOM||e.plan===i.cw.ENTERPRISE||e.plan===i.cw.UNLIMITED)},84111:(e,l,n)=>{n.d(l,{T:()=>a_});var t,i=n(6029),o=n(48874),a=n(98269),s=n(90170),r=n(60945),d=n(49377),u=n(8972),c=n(76308),p=n(66425),h=n(26739),b=n(55800),x=n(13808),v=n(12225),m=n(55729),g=n(82626),j=n(49832),f=n(25685);let y=e=>{let{initial:l,movement:n}=e;return n[0]<0&&n[1]<0?{origin:{x:l[0]+n[0],y:l[1]+n[1]},dimension:{width:Math.abs(n[0]),height:Math.abs(n[1])}}:n[0]<0?{origin:{x:l[0]+n[0],y:l[1]},dimension:{width:Math.abs(n[0]),height:n[1]}}:n[1]<0?{origin:{x:l[0],y:l[1]+n[1]},dimension:{width:n[0],height:Math.abs(n[1])}}:{origin:{x:l[0],y:l[1]},dimension:{width:n[0],height:n[1]}}},I=(e,l)=>e.origin.x<l.right&&e.origin.x+e.dimension.width>l.left&&e.origin.y<l.bottom&&e.origin.y+e.dimension.height>l.top,C=(e,l)=>({x:(e.x-l.x-f.mI/(3/l.scale))/l.scale,y:(e.y-l.y-(o.$+20*l.scale))/l.scale});var k=n(41055),E=n(35098),w=n(97894),S=n(44444),T=n(44811),V=n(28144),M=n(90869),A=n(22070),B=n(58972),R=n(58255);let O=/\{\{([^{}]+)\}\}/g,D=/"\w*variableid":"([^"]+)"/gi,L=(e,l)=>{var n;return[...null!=(n=JSON.stringify(e).match(O))?n:[]].reduce((e,n)=>{var t;let i=n.slice(2,-2),o=null==(t=l.find(e=>e.name===i))?void 0:t.id;return!o||e.find(e=>e===o)?e:e.concat(o)},[])},P=e=>{let l=JSON.stringify(e).matchAll(D),n=new Set;for(let e of l)n.add(e[1]);return Array.from(n)};var N=n(59391);let G=e=>{let{graphPosition:l,isReadOnly:n,focusedElementIds:t,blurElements:o}=e,[s,d]=(0,m.useState)(),{typebot:u,deleteGroups:c,pasteGroups:p,pasteEvents:h,deleteEvents:b}=(0,a.V)(),x=(0,m.useRef)(null),v=(0,k.r)((0,j.k)(e=>e.elementsInClipboard)),{copyElements:g,setFocusedElements:f,updateElementCoordinates:y}=(0,k.r)((0,j.k)(e=>({copyElements:e.copyElements,updateElementCoordinates:e.updateElementCoordinates,setFocusedElements:e.setFocusedElements})));(0,r.M)("pointerup",e=>e.stopPropagation(),x.current),(0,r.M)("mousemove",e=>{d({x:e.clientX,y:e.clientY})});let I=()=>{if(!u)return;let e=u.groups.filter(e=>t.includes(e.id)),l=u.events.filter(e=>t.includes(e.id)&&e.type!==R.B.START);if(0===l.length&&0===e.length)return;let n=u.edges.filter(l=>e.find(e=>e.id===l.to.groupId)),i=W([...e,...l],u.variables),o={groups:e,events:l,edges:n,variables:i};return g(o),o},E=()=>{c(t),b(t),o()},w=e=>{if(!v||n||!s)return;let t=null!=e?e:v,i=[...t.groups,...t.events].sort((e,l)=>e.graphCoordinates.x-l.graphCoordinates.x)[0],{newGroups:o,oldToNewIdsMapping:a}=p(t,{newCoordinates:{mousePosition:C(s,l),farLeftElement:{id:i.id,...i.graphCoordinates}}});o.forEach(e=>{y(e.id,e.graphCoordinates)});let{newEvents:r}=h(t,{oldToNewIdsMapping:a,updateCoordinates:{mousePosition:C(s,l),farLeftElement:{id:i.id,...i.graphCoordinates}}});r.forEach(e=>{y(e.id,e.graphCoordinates)}),f([...o,...r].map(e=>e.id))};return(0,T.K)({copy:()=>{I()&&(0,N.oR)("Elements copied to clipboard")},cut:()=>{I(),E()},duplicate:()=>{w(I())},backspace:E,paste:w,selectAll:()=>{var e;u&&f(null!=(e=u.groups.map(e=>e.id).concat(u.events.map(e=>e.id)))?e:[])}}),(0,i.jsxs)(V.z,{ref:x,rounded:"md",spacing:0,bgColor:(0,M.dU)("white","gray.950"),shadow:"md",children:[(0,i.jsxs)(A.$,{pointerEvents:"none",color:(0,M.dU)("orange.500","orange.200"),borderRightWidth:"1px",borderRightRadius:"none",bgColor:(0,M.dU)("white",void 0),size:"sm",children:[t.length," selected"]}),(0,i.jsx)(B.K,{borderRightWidth:"1px",borderRightRadius:"none",borderLeftRadius:"none","aria-label":"Copy",onClick:()=>{I(),(0,N.oR)("Groups copied to clipboard")},bgColor:(0,M.dU)("white",void 0),icon:(0,i.jsx)(S.Td,{}),size:"sm"}),(0,i.jsx)(B.K,{"aria-label":"Delete",borderLeftRadius:"none",bgColor:(0,M.dU)("white",void 0),icon:(0,i.jsx)(S.uc,{}),size:"sm",onClick:E})]})},W=(e,l)=>{if(!JSON.stringify(e))return[];let n=L(e,l);return[...P(e),...n].reduce((e,n)=>{if(!n||e.find(e=>e.id===n))return e;let t=l.find(e=>e.id===n);return t?[...e,{id:t.id,name:t.name,isSessionVariable:t.isSessionVariable}]:e},[])};var U=n(79596),z=n(1069);function F(e){var l;let[n,t]=(0,m.useState)(!1),[o,a]=(0,m.useState)(!1),[s,d]=(0,m.useState)(!1),[c,p]=(0,m.useState)([0,0]),h=(0,m.useRef)(null);(0,m.useEffect)(()=>{if(n)setTimeout(()=>{a(!0),setTimeout(()=>{d(!0)})});else{d(!1);let e=setTimeout(()=>{a(n)},1e3);return()=>clearTimeout(e)}},[n]),(0,r.M)("contextmenu",l=>{if(!e.isDisabled)if(l.currentTarget===h.current){var n;l.preventDefault(),l.stopPropagation(),null==(n=e.onOpen)||n.call(e),t(!0),p([l.pageX,l.pageY])}else t(!1)},h.current);let b=(0,m.useCallback)(()=>{var l,n;null==(n=e.menuProps)||null==(l=n.onClose)||l.call(n),t(!1)},[null==(l=e.menuProps)?void 0:l.onClose,t]);return(0,i.jsxs)(i.Fragment,{children:[e.children(h,n),o&&(0,i.jsx)(u.Z,{...e.portalProps,children:(0,i.jsxs)(U.W,{isOpen:s,gutter:0,...e.menuProps,onClose:b,children:[(0,i.jsx)(z.I,{"aria-hidden":!0,w:1,h:1,style:{position:"absolute",left:c[0],top:c[1],cursor:"default"},...e.menuButtonProps}),e.renderMenu({onClose:b})]})})]})}var K=n(4368),_=n(90682),H=n(90184),Q=n(22194),Y=n(86158),J=n(71196),Z=n(29328),X=n(75534),q=n(84179),$=n(90944),ee=n(70100);let el=e=>{var l,n,t,o,a;let{options:s,onOptionsChange:r}=e,{t:d}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(H.J,{label:d("blocks.inputs.settings.multipleChoice.label"),initialValue:null!=(l=null==s?void 0:s.isMultipleChoice)?l:ee.Z.isMultipleChoice,onCheckChange:e=>r({...s,isMultipleChoice:e}),children:(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.submitButton.label"),defaultValue:null!=(n=null==s?void 0:s.buttonLabel)?n:d("blocks.inputs.settings.buttonText.label"),onChange:e=>r({...s,buttonLabel:e})})}),(0,i.jsxs)(H.J,{label:d("blocks.inputs.settings.isSearchable.label"),initialValue:null!=(t=null==s?void 0:s.isSearchable)?t:ee.Z.isSearchable,onCheckChange:e=>r({...s,isSearchable:e}),children:[(0,i.jsx)(Y.R,{label:"Default display buttons",initialValue:null!=(o=null==s?void 0:s.areInitialSearchButtonsVisible)?o:ee.Z.areInitialSearchButtonsVisible,onCheckChange:e=>r({...s,areInitialSearchButtonsVisible:e})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.input.placeholder.label"),defaultValue:null!=(a=null==s?void 0:s.searchInputPlaceholder)?a:d("blocks.inputs.settings.input.filterOptions.label"),onChange:e=>r({...s,searchInputPlaceholder:e})})]}),(0,i.jsxs)(X.MJ,{children:[(0,i.jsxs)(q.l,{children:[d("blocks.inputs.button.settings.dynamicData.label")," ",(0,i.jsx)(_.t,{children:d("blocks.inputs.button.settings.dynamicData.infoText.label")})]}),(0,i.jsx)(J.x,{initialVariableId:null==s?void 0:s.dynamicVariableId,onSelectVariable:e=>r({...s,dynamicVariableId:null==e?void 0:e.id})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:d("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==s?void 0:s.variableId,onSelectVariable:e=>r({...s,variableId:null==e?void 0:e.id})})]})]})};var en=n(20749),et=n(63682),ei=n(47026);let eo=e=>{var l,n;let{options:t,onOptionsChange:o}=e;return(0,i.jsx)(Z.B,{children:(0,i.jsx)(et.B,{addLabel:(null!=(n=null==t||null==(l=t.saveResponseMapping)?void 0:l.length)?n:0)===0?"Save in variable":void 0,initialItems:null==t?void 0:t.saveResponseMapping,onItemsChange:e=>{o({...t,saveResponseMapping:e})},children:e=>(0,i.jsx)(ea,{...e})})})},ea=e=>{let{item:l,onItemChange:n}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(en.Q,{currentItem:l.field,items:ei.Y,onItemSelect:e=>{n({...l,field:e})}}),(0,i.jsx)(J.x,{initialVariableId:l.variableId,onSelectVariable:e=>{n({...l,variableId:e?e.id:void 0})}})]})};var es=n(11390);let er={hasTime:!1,isRange:!1,labels:{button:es.GY,from:"From:",to:"To:"},format:"dd/MM/yyyy",formatWithTime:"dd/MM/yyyy HH:mm"},ed=e=>{var l,n,t,o,a,s,r,d,u;let{options:c,onOptionsChange:p}=e,{t:h}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(H.J,{label:h("blocks.inputs.date.settings.isRange.label"),initialValue:null!=(o=null==c?void 0:c.isRange)?o:er.isRange,onCheckChange:e=>p({...c,isRange:e}),children:[(0,i.jsx)(Q.ks,{label:h("blocks.inputs.date.settings.from.label"),defaultValue:null!=(a=null==c||null==(l=c.labels)?void 0:l.from)?a:er.labels.from,onChange:e=>p({...c,labels:{...null==c?void 0:c.labels,from:e}})}),(0,i.jsx)(Q.ks,{label:h("blocks.inputs.date.settings.to.label"),defaultValue:null!=(s=null==c||null==(n=c.labels)?void 0:n.to)?s:h("blocks.inputs.date.settings.toInputValue.label"),onChange:e=>p({...c,labels:{...null==c?void 0:c.labels,to:e}})})]}),(0,i.jsx)(Y.R,{label:h("blocks.inputs.date.settings.withTime.label"),initialValue:null!=(r=null==c?void 0:c.hasTime)?r:er.hasTime,onCheckChange:e=>p({...c,hasTime:e})}),(0,i.jsx)(Q.ks,{label:h("blocks.inputs.settings.button.label"),defaultValue:null!=(d=null==c||null==(t=c.labels)?void 0:t.button)?d:er.labels.button,onChange:e=>p({...c,labels:{...null==c?void 0:c.labels,button:e}})}),(0,i.jsx)(Q.ks,{label:h("blocks.inputs.settings.min.label"),defaultValue:null==c?void 0:c.min,placeholder:(null==c?void 0:c.hasTime)?"YYYY-MM-DDTHH:mm":"YYYY-MM-DD",onChange:e=>{if(""===e)return p({...c,min:void 0});p({...c,min:e})}}),(0,i.jsx)(Q.ks,{label:h("blocks.inputs.settings.max.label"),defaultValue:null==c?void 0:c.max,placeholder:(null==c?void 0:c.hasTime)?"YYYY-MM-DDTHH:mm":"YYYY-MM-DD",onChange:e=>{if(""===e)return p({...c,max:void 0});p({...c,max:e})}}),(0,i.jsx)(Q.ks,{label:h("blocks.inputs.date.settings.format.label"),defaultValue:null!=(u=null==c?void 0:c.format)?u:(null==c?void 0:c.hasTime)?er.formatWithTime:er.format,moreInfoTooltip:"\n					".concat(h("blocks.inputs.date.settings.format.example.label")," dd/MM/yyyy, MM/dd/yy, yyyy-MM-dd\n				"),placeholder:(null==c?void 0:c.hasTime)?"dd/MM/yyyy HH:mm":"dd/MM/yyyy",onChange:e=>{if(""===e)return p({...c,format:void 0});p({...c,format:e})}}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:h("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==c?void 0:c.variableId,onSelectVariable:e=>p({...c,variableId:null==e?void 0:e.id})})]})]})},eu={labels:{button:es.GY,placeholder:"Type your email..."},retryMessageContent:"This email doesn't seem to be valid. Can you type it again?"},ec=e=>{var l,n,t,o,a;let{options:s,onOptionsChange:r}=e,{t:d}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.placeholder.label"),defaultValue:null!=(t=null==s||null==(l=s.labels)?void 0:l.placeholder)?t:eu.labels.placeholder,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,placeholder:e}})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.button.label"),defaultValue:null!=(o=null==s||null==(n=s.labels)?void 0:n.button)?o:eu.labels.button,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,button:e}})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.retryMessage.label"),defaultValue:null!=(a=null==s?void 0:s.retryMessageContent)?a:eu.retryMessageContent,onChange:e=>r({...s,retryMessageContent:e})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:d("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==s?void 0:s.variableId,onSelectVariable:e=>r({...s,variableId:null==e?void 0:e.id})})]})]})};var ep=n(31083),eh=n(28562),eb=n(50456),ex=n(40513),ev=n(63046),em=n(4587),eg=n(85288),ej=n(43053);let ef=e=>{var l,n,t,o,a,s,r,d,u,c,p,h,b,x,v,m,g,j,f,y;let{options:I,onOptionsChange:C}=e,{t:k}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Y.R,{label:k("blocks.inputs.file.settings.required.label"),initialValue:null!=(p=null==I?void 0:I.isRequired)?p:ej.i.isRequired,onCheckChange:e=>C({...I,isRequired:e})}),(0,i.jsx)(H.J,{label:k("blocks.inputs.file.settings.allowedFileTypes.label"),initialValue:null==I||null==(l=I.allowedFileTypes)?void 0:l.isEnabled,onCheckChange:e=>C({...I,allowedFileTypes:{...null==I?void 0:I.allowedFileTypes,isEnabled:e}}),children:(0,i.jsx)(ep.u,{items:null==I||null==(n=I.allowedFileTypes)?void 0:n.types,onChange:e=>C({...I,allowedFileTypes:{...null==I?void 0:I.allowedFileTypes,types:e}}),placeholder:k("blocks.inputs.file.settings.allowedFileTypes.placeholder")})}),(0,i.jsx)(Y.R,{label:k("blocks.inputs.file.settings.allowMultiple.label"),initialValue:null!=(h=null==I?void 0:I.isMultipleAllowed)?h:ej.i.isMultipleAllowed,onCheckChange:e=>C({...I,isMultipleAllowed:e})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:k((null==I?void 0:I.isMultipleAllowed)?"blocks.inputs.file.settings.saveMultipleUpload.label":"blocks.inputs.file.settings.saveSingleUpload.label")}),(0,i.jsx)(J.x,{initialVariableId:null==I?void 0:I.variableId,onSelectVariable:e=>C({...I,variableId:null==e?void 0:e.id})})]}),(0,i.jsx)(en.Q,{label:"Visibility:",direction:"row",moreInfoTooltip:'This setting determines who can see the uploaded files. "Public" means that anyone who has the link can see the files. "Private" means that only a member of this workspace can see the files. Check the docs for more information.',currentItem:null!=(b=null==I?void 0:I.visibility)?b:ej.i.visibility,onItemSelect:e=>C({...I,visibility:e}),items:ej.R}),(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:[k("blocks.inputs.file.settings.labels"),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{as:Z.B,spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",children:k("blocks.inputs.settings.placeholder.label")}),(0,i.jsx)(eh.B,{lang:"html",onChange:e=>C({...I,labels:{...null==I?void 0:I.labels,placeholder:e}}),defaultValue:null!=(x=null==I||null==(t=I.labels)?void 0:t.placeholder)?x:ej.i.labels.placeholder,height:"100px",withVariableButton:!1})]}),(0,i.jsx)(Q.ks,{label:k("blocks.inputs.settings.button.label"),defaultValue:null!=(v=null==I||null==(o=I.labels)?void 0:o.button)?v:ej.i.labels.button,onChange:e=>C({...I,labels:{...null==I?void 0:I.labels,button:e}}),withVariableButton:!1}),(null==I?void 0:I.isMultipleAllowed)&&(0,i.jsx)(Q.ks,{label:k("blocks.inputs.file.settings.clear.label"),defaultValue:null!=(m=null==I||null==(a=I.labels)?void 0:a.clear)?m:ej.i.labels.clear,onChange:e=>C({...I,labels:{...null==I?void 0:I.labels,clear:e}}),withVariableButton:!1}),!(null!=(g=null==I?void 0:I.isRequired)?g:ej.i.isRequired)&&(0,i.jsx)(Q.ks,{label:k("blocks.inputs.file.settings.skip.label"),defaultValue:null!=(j=null==I||null==(s=I.labels)?void 0:s.skip)?j:ej.i.labels.skip,onChange:e=>C({...I,labels:{...null==I?void 0:I.labels,skip:e}}),withVariableButton:!1}),(0,i.jsx)(Q.ks,{label:"Single file success",defaultValue:null!=(f=null==I||null==(d=I.labels)||null==(r=d.success)?void 0:r.single)?f:ej.i.labels.success.single,onChange:e=>{var l;return C({...I,labels:{...null==I?void 0:I.labels,success:{...null==I||null==(l=I.labels)?void 0:l.success,single:e}}})},withVariableButton:!1}),(null==I?void 0:I.isMultipleAllowed)&&(0,i.jsx)(Q.ks,{label:"Multi files success",moreInfoTooltip:"Include {total} to show the total number of files uploaded",defaultValue:null!=(y=null==I||null==(c=I.labels)||null==(u=c.success)?void 0:u.multiple)?y:ej.i.labels.success.multiple,onChange:e=>{var l;return C({...I,labels:{...null==I?void 0:I.labels,success:{...null==I||null==(l=I.labels)?void 0:l.success,multiple:e}}})},withVariableButton:!1})]})]})})]})};var ey=n(9804),eI=n(94283),eC=n(61910),ek=n(21522);let eE=[{code:"AED",description:"United Arab Emirates Dirham"},{code:"AFN",description:"Afghan Afghani**"},{code:"ALL",description:"Albanian Lek"},{code:"AMD",description:"Armenian Dram"},{code:"ANG",description:"Netherlands Antillean Gulden"},{code:"AOA",description:"Angolan Kwanza**"},{code:"ARS",description:"Argentine Peso**"},{code:"AUD",description:"Australian Dollar"},{code:"AWG",description:"Aruban Florin"},{code:"AZN",description:"Azerbaijani Manat"},{code:"BAM",description:"Bosnia & Herzegovina Convertible Mark"},{code:"BBD",description:"Barbadian Dollar"},{code:"BDT",description:"Bangladeshi Taka"},{code:"BGN",description:"Bulgarian Lev"},{code:"BIF",description:"Burundian Franc"},{code:"BMD",description:"Bermudian Dollar"},{code:"BND",description:"Brunei Dollar"},{code:"BOB",description:"Bolivian Boliviano**"},{code:"BRL",description:"Brazilian Real**"},{code:"BSD",description:"Bahamian Dollar"},{code:"BWP",description:"Botswana Pula"},{code:"BZD",description:"Belize Dollar"},{code:"CAD",description:"Canadian Dollar"},{code:"CDF",description:"Congolese Franc"},{code:"CHF",description:"Swiss Franc"},{code:"CLP",description:"Chilean Peso**"},{code:"CNY",description:"Chinese Renminbi Yuan"},{code:"COP",description:"Colombian Peso**"},{code:"CRC",description:"Costa Rican Col\xf3n**"},{code:"CVE",description:"Cape Verdean Escudo**"},{code:"CZK",description:"Czech Koruna**"},{code:"DJF",description:"Djiboutian Franc**"},{code:"DKK",description:"Danish Krone"},{code:"DOP",description:"Dominican Peso"},{code:"DZD",description:"Algerian Dinar"},{code:"EGP",description:"Egyptian Pound"},{code:"ETB",description:"Ethiopian Birr"},{code:"EUR",description:"Euro"},{code:"FJD",description:"Fijian Dollar"},{code:"FKP",description:"Falkland Islands Pound**"},{code:"GBP",description:"British Pound"},{code:"GEL",description:"Georgian Lari"},{code:"GIP",description:"Gibraltar Pound"},{code:"GMD",description:"Gambian Dalasi"},{code:"GNF",description:"Guinean Franc**"},{code:"GTQ",description:"Guatemalan Quetzal**"},{code:"GYD",description:"Guyanese Dollar"},{code:"HKD",description:"Hong Kong Dollar"},{code:"HNL",description:"Honduran Lempira**"},{code:"HRK",description:"Croatian Kuna"},{code:"HTG",description:"Haitian Gourde"},{code:"HUF",description:"Hungarian Forint**"},{code:"IDR",description:"Indonesian Rupiah"},{code:"ILS",description:"Israeli New Sheqel"},{code:"INR",description:"Indian Rupee**"},{code:"ISK",description:"Icelandic Kr\xf3na"},{code:"JMD",description:"Jamaican Dollar"},{code:"JPY",description:"Japanese Yen"},{code:"KES",description:"Kenyan Shilling"},{code:"KGS",description:"Kyrgyzstani Som"},{code:"KHR",description:"Cambodian Riel"},{code:"KMF",description:"Comorian Franc"},{code:"KRW",description:"South Korean Won"},{code:"KYD",description:"Cayman Islands Dollar"},{code:"KZT",description:"Kazakhstani Tenge"},{code:"LAK",description:"Lao Kip**"},{code:"LBP",description:"Lebanese Pound"},{code:"LKR",description:"Sri Lankan Rupee"},{code:"LRD",description:"Liberian Dollar"},{code:"LSL",description:"Lesotho Loti"},{code:"MAD",description:"Moroccan Dirham"},{code:"MDL",description:"Moldovan Leu"},{code:"MGA",description:"Malagasy Ariary"},{code:"MKD",description:"Macedonian Denar"},{code:"MNT",description:"Mongolian T\xf6gr\xf6g"},{code:"MOP",description:"Macanese Pataca"},{code:"MRO",description:"Mauritanian Ouguiya"},{code:"MUR",description:"Mauritian Rupee**"},{code:"MVR",description:"Maldivian Rufiyaa"},{code:"MWK",description:"Malawian Kwacha"},{code:"MXN",description:"Mexican Peso**"},{code:"MYR",description:"Malaysian Ringgit"},{code:"MZN",description:"Mozambican Metical"},{code:"NAD",description:"Namibian Dollar"},{code:"NGN",description:"Nigerian Naira"},{code:"NIO",description:"Nicaraguan C\xf3rdoba**"},{code:"NOK",description:"Norwegian Krone"},{code:"NPR",description:"Nepalese Rupee"},{code:"NZD",description:"New Zealand Dollar"},{code:"PAB",description:"Panamanian Balboa**"},{code:"PEN",description:"Peruvian Nuevo Sol**"},{code:"PGK",description:"Papua New Guinean Kina"},{code:"PHP",description:"Philippine Peso"},{code:"PKR",description:"Pakistani Rupee"},{code:"PLN",description:"Polish Złoty"},{code:"PYG",description:"Paraguayan Guaran\xed**"},{code:"QAR",description:"Qatari Riyal"},{code:"RON",description:"Romanian Leu"},{code:"RSD",description:"Serbian Dinar"},{code:"RUB",description:"Russian Ruble"},{code:"RWF",description:"Rwandan Franc"},{code:"SAR",description:"Saudi Riyal"},{code:"SBD",description:"Solomon Islands Dollar"},{code:"SCR",description:"Seychellois Rupee"},{code:"SEK",description:"Swedish Krona"},{code:"SGD",description:"Singapore Dollar"},{code:"SHP",description:"Saint Helenian Pound**"},{code:"SLL",description:"Sierra Leonean Leone"},{code:"SOS",description:"Somali Shilling"},{code:"SRD",description:"Surinamese Dollar**"},{code:"STD",description:"S\xe3o Tom\xe9 and Pr\xedncipe Dobra"},{code:"SVC",description:"Salvadoran Col\xf3n**"},{code:"SZL",description:"Swazi Lilangeni"},{code:"THB",description:"Thai Baht"},{code:"TJS",description:"Tajikistani Somoni"},{code:"TOP",description:"Tongan Paʻanga"},{code:"TRY",description:"Turkish Lira"},{code:"TTD",description:"Trinidad and Tobago Dollar"},{code:"TWD",description:"New Taiwan Dollar"},{code:"TZS",description:"Tanzanian Shilling"},{code:"UAH",description:"Ukrainian Hryvnia"},{code:"UGX",description:"Ugandan Shilling"},{code:"USD",description:"United States Dollar"},{code:"UYU",description:"Uruguayan Peso**"},{code:"UZS",description:"Uzbekistani Som"},{code:"VND",description:"Vietnamese Đồng"},{code:"VUV",description:"Vanuatu Vatu"},{code:"WST",description:"Samoan Tala"},{code:"XAF",description:"Central African Cfa Franc"},{code:"XCD",description:"East Caribbean Dollar"},{code:"XOF",description:"West African Cfa Franc**"},{code:"XPF",description:"Cfp Franc**"},{code:"YER",description:"Yemeni Rial"},{code:"ZAR",description:"South African Rand"},{code:"ZMW",description:"Zambian Kwacha"}],ew=e=>{var l,n,t,o,a;let{options:s,onOptionsChange:r}=e,{t:d}=(0,$.WD)();(0,m.useEffect)(()=>{if(!(null==s?void 0:s.locale)){let e=navigator.language;e.match(eC.U2)&&r({...s,locale:e})}});let u=e=>r({...s,currency:e}),c=e=>r({...s,style:e}),p=e=>r({...s,unit:e});return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.placeholder.label"),defaultValue:null!=(t=null==s||null==(l=s.labels)?void 0:l.placeholder)?t:eC.iF,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,placeholder:e}})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.button.label"),defaultValue:null!=(o=null==s||null==(n=s.labels)?void 0:n.button)?o:eC.Bw,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,button:e}})}),(0,i.jsx)(Q.Q7,{label:d("blocks.inputs.settings.min.label"),defaultValue:null==s?void 0:s.min,onValueChange:e=>r({...s,min:e})}),(0,i.jsx)(Q.Q7,{label:d("blocks.inputs.settings.max.label"),defaultValue:null==s?void 0:s.max,onValueChange:e=>r({...s,max:e})}),(0,i.jsx)(Q.Q7,{label:d("blocks.inputs.number.settings.step.label"),defaultValue:null==s?void 0:s.step,onValueChange:e=>r({...s,step:e})}),(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:d("blocks.inputs.number.settings.format.label")}),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{children:[(0,i.jsx)(en.Q,{items:Object.values(eC.tm).map(e=>({label:d(eC.q8[e]),value:e})),currentItem:null!=(a=null==s?void 0:s.style)?a:eC.MC,onItemSelect:e=>c(e)}),(null==s?void 0:s.style)===eC.tm.CURRENCY&&(0,i.jsxs)(X.MJ,{mt:4,children:[(0,i.jsx)(q.l,{children:d("blocks.inputs.number.settings.currency.label")}),(0,i.jsx)(ey.l,{items:eE.map(e=>{let{code:l,description:n}=e;return{label:n,value:l}}),onSelect:e=>u(e),placeholder:d("blocks.inputs.number.settings.currency.label"),selectedItem:null==s?void 0:s.currency})]}),(null==s?void 0:s.style)===eC.tm.UNIT&&(0,i.jsxs)(X.MJ,{mt:4,children:[(0,i.jsx)(q.l,{children:d("blocks.inputs.number.settings.unit.label")}),(0,i.jsx)(ey.l,{items:Object.values(eC._N).map(e=>({label:d(eC.My[e]),value:e})),onSelect:e=>p(e),placeholder:d("blocks.inputs.number.settings.unit.label"),selectedItem:null==s?void 0:s.unit})]}),(0,i.jsxs)(X.MJ,{mt:4,children:[(0,i.jsx)(q.l,{children:d("blocks.inputs.number.settings.locale.label")}),(0,i.jsx)(Q.ks,{defaultValue:null==s?void 0:s.locale,helperText:d("blocks.inputs.number.settings.locale.helper"),placeholder:"en-US",onChange:e=>{var l;let n=ek.b.shape.locale.safeParse(e).success?e:null!=(l=null==s?void 0:s.locale)?l:navigator.language;r({...s,locale:n})}})]})]})]})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:d("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==s?void 0:s.variableId,onSelectVariable:e=>{r({...s,variableId:null==e?void 0:e.id})}})]})]})};var eS=n(32708),eT=n(47827),eV=n(15131),eM=n(82361),eA=n(57243);let eB=e=>{var l,n,t,o,a,s;let{address:r,onAddressChange:d}=e,{t:u}=(0,$.WD)();return(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:[u("blocks.inputs.payment.settings.address.label"),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{py:4,as:Z.B,spacing:"4",children:[(0,i.jsx)(Q.ks,{label:u("blocks.inputs.payment.settings.address.country.label"),defaultValue:null!=(l=null==r?void 0:r.country)?l:"",onChange:e=>d({...r,country:e})}),(0,i.jsx)(Q.ks,{label:u("blocks.inputs.payment.settings.address.line.label",{line:"1"}),defaultValue:null!=(n=null==r?void 0:r.line1)?n:"",onChange:e=>d({...r,line1:e})}),(0,i.jsx)(Q.ks,{label:u("blocks.inputs.payment.settings.address.line.label",{line:"2"}),defaultValue:null!=(t=null==r?void 0:r.line2)?t:"",onChange:e=>d({...r,line2:e})}),(0,i.jsx)(Q.ks,{label:u("blocks.inputs.payment.settings.address.city.label"),defaultValue:null!=(o=null==r?void 0:r.city)?o:"",onChange:e=>d({...r,city:e})}),(0,i.jsx)(Q.ks,{label:u("blocks.inputs.payment.settings.address.state.label"),defaultValue:null!=(a=null==r?void 0:r.state)?a:"",onChange:e=>d({...r,state:e})}),(0,i.jsx)(Q.ks,{label:u("blocks.inputs.payment.settings.address.postalCode.label"),defaultValue:null!=(s=null==r?void 0:r.postalCode)?s:"",onChange:e=>d({...r,postalCode:e})})]})]})})};var eR=n(77428);let eO=e=>{var l,n,t,o,a,s,r,d,u,c,p;let{options:h,onOptionsChange:b}=e,{workspace:x}=(0,eT.h)(),{isOpen:v,onOpen:m,onClose:g}=(0,eV.j)(),{t:j}=(0,$.WD)(),f=e=>{b({...h,credentialsId:e})};return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:j("blocks.inputs.payment.settings.provider.label")}),(0,i.jsx)(en.Q,{onItemSelect:e=>{b({...h,provider:e})},items:Object.values(eA.C),currentItem:null!=(d=null==h?void 0:h.provider)?d:eA.Q.provider})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:j("blocks.inputs.payment.settings.account.label")}),x&&(0,i.jsx)(eS.s,{type:"stripe",scope:{type:"workspace",workspaceId:x.id},currentCredentialsId:null==h?void 0:h.credentialsId,onCredentialsSelect:f,onCreateNewClick:m,credentialsName:j("blocks.inputs.payment.settings.accountText.label",{provider:"Stripe"})})]}),(0,i.jsxs)(V.z,{children:[(0,i.jsx)(Q.ks,{label:j("blocks.inputs.payment.settings.priceAmount.label"),onChange:e=>b({...h,amount:e}),defaultValue:null==h?void 0:h.amount,placeholder:"30.00"}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:j("blocks.inputs.payment.settings.currency.label")}),(0,i.jsx)(eM.l,{placeholder:"Select option",value:null!=(u=null==h?void 0:h.currency)?u:eA.Q.currency,onChange:e=>b({...h,currency:e.target.value}),children:eE.map(e=>(0,i.jsx)("option",{value:e.code,children:e.code},e.code))})]})]}),(0,i.jsx)(Q.ks,{label:j("blocks.inputs.settings.button.label"),onChange:e=>b({...h,labels:{...null==h?void 0:h.labels,button:e}}),defaultValue:null!=(c=null==h||null==(l=h.labels)?void 0:l.button)?c:eA.Q.labels.button}),(0,i.jsx)(Q.ks,{label:j("blocks.inputs.payment.settings.successMessage.label"),onChange:e=>b({...h,labels:{...null==h?void 0:h.labels,success:e}}),defaultValue:null!=(p=null==h||null==(n=h.labels)?void 0:n.success)?p:eA.Q.labels.success}),(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:[j("blocks.inputs.payment.settings.additionalInformation.label"),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{py:4,as:Z.B,spacing:"6",children:[(0,i.jsx)(Q.ks,{label:j("blocks.inputs.settings.description.label"),defaultValue:null==h||null==(t=h.additionalInformation)?void 0:t.description,onChange:e=>b({...h,additionalInformation:{...null==h?void 0:h.additionalInformation,description:e}}),placeholder:j("blocks.inputs.payment.settings.additionalInformation.description.placeholder.label")}),(0,i.jsx)(Q.ks,{label:j("blocks.inputs.payment.settings.additionalInformation.name.label"),defaultValue:null==h||null==(o=h.additionalInformation)?void 0:o.name,onChange:e=>b({...h,additionalInformation:{...null==h?void 0:h.additionalInformation,name:e}}),placeholder:"John Smith"}),(0,i.jsx)(Q.ks,{label:j("blocks.inputs.payment.settings.additionalInformation.email.label"),defaultValue:null==h||null==(a=h.additionalInformation)?void 0:a.email,onChange:e=>b({...h,additionalInformation:{...null==h?void 0:h.additionalInformation,email:e}}),placeholder:"john@gmail.com"}),(0,i.jsx)(Q.ks,{label:j("blocks.inputs.payment.settings.additionalInformation.phone.label"),defaultValue:null==h||null==(s=h.additionalInformation)?void 0:s.phoneNumber,onChange:e=>b({...h,additionalInformation:{...null==h?void 0:h.additionalInformation,phoneNumber:e}}),placeholder:"+33XXXXXXXXX"}),(0,i.jsx)(eB,{address:null==h||null==(r=h.additionalInformation)?void 0:r.address,onAddressChange:e=>b({...h,additionalInformation:{...null==h?void 0:h.additionalInformation,address:e}})})]})]})}),(0,i.jsx)(eR.N,{isOpen:v,onClose:g,onNewCredentials:f})]})},eD={labels:{button:es.GY,placeholder:"Type your phone number..."},retryMessageContent:"This phone number doesn't seem to be valid. Can you type it again?"},eL=e=>{let{countryCode:l,onSelect:n}=e,{t}=(0,$.WD)();return(0,i.jsxs)(eM.l,{placeholder:t("blocks.inputs.phone.settings.international.placeholder.label"),value:l,onChange:e=>{n(e.target.value)},children:[(0,i.jsx)("option",{value:"DZ",children:"Algeria (+213)"}),(0,i.jsx)("option",{value:"AD",children:"Andorra (+376)"}),(0,i.jsx)("option",{value:"AO",children:"Angola (+244)"}),(0,i.jsx)("option",{value:"AI",children:"Anguilla (+1264)"}),(0,i.jsx)("option",{value:"AG",children:"Antigua & Barbuda (+1268)"}),(0,i.jsx)("option",{value:"AR",children:"Argentina (+54)"}),(0,i.jsx)("option",{value:"AM",children:"Armenia (+374)"}),(0,i.jsx)("option",{value:"AW",children:"Aruba (+297)"}),(0,i.jsx)("option",{value:"AU",children:"Australia (+61)"}),(0,i.jsx)("option",{value:"AT",children:"Austria (+43)"}),(0,i.jsx)("option",{value:"AZ",children:"Azerbaijan (+994)"}),(0,i.jsx)("option",{value:"BS",children:"Bahamas (+1242)"}),(0,i.jsx)("option",{value:"BH",children:"Bahrain (+973)"}),(0,i.jsx)("option",{value:"BD",children:"Bangladesh (+880)"}),(0,i.jsx)("option",{value:"BB",children:"Barbados (+1246)"}),(0,i.jsx)("option",{value:"BY",children:"Belarus (+375)"}),(0,i.jsx)("option",{value:"BE",children:"Belgium (+32)"}),(0,i.jsx)("option",{value:"BZ",children:"Belize (+501)"}),(0,i.jsx)("option",{value:"BJ",children:"Benin (+229)"}),(0,i.jsx)("option",{value:"BM",children:"Bermuda (+1441)"}),(0,i.jsx)("option",{value:"BT",children:"Bhutan (+975)"}),(0,i.jsx)("option",{value:"BO",children:"Bolivia (+591)"}),(0,i.jsx)("option",{value:"BA",children:"Bosnia Herzegovina (+387)"}),(0,i.jsx)("option",{value:"BW",children:"Botswana (+267)"}),(0,i.jsx)("option",{value:"BR",children:"Brazil (+55)"}),(0,i.jsx)("option",{value:"BN",children:"Brunei (+673)"}),(0,i.jsx)("option",{value:"BG",children:"Bulgaria (+359)"}),(0,i.jsx)("option",{value:"BF",children:"Burkina Faso (+226)"}),(0,i.jsx)("option",{value:"BI",children:"Burundi (+257)"}),(0,i.jsx)("option",{value:"KH",children:"Cambodia (+855)"}),(0,i.jsx)("option",{value:"CM",children:"Cameroon (+237)"}),(0,i.jsx)("option",{value:"CA",children:"Canada (+1)"}),(0,i.jsx)("option",{value:"CV",children:"Cape Verde Islands (+238)"}),(0,i.jsx)("option",{value:"KY",children:"Cayman Islands (+1345)"}),(0,i.jsx)("option",{value:"CF",children:"Central African Republic (+236)"}),(0,i.jsx)("option",{value:"CL",children:"Chile (+56)"}),(0,i.jsx)("option",{value:"CN",children:"China (+86)"}),(0,i.jsx)("option",{value:"CO",children:"Colombia (+57)"}),(0,i.jsx)("option",{value:"KM",children:"Comoros (+269)"}),(0,i.jsx)("option",{value:"CG",children:"Congo (+242)"}),(0,i.jsx)("option",{value:"CK",children:"Cook Islands (+682)"}),(0,i.jsx)("option",{value:"CR",children:"Costa Rica (+506)"}),(0,i.jsx)("option",{value:"CI",children:"Cote D'Ivoire (+225)"}),(0,i.jsx)("option",{value:"HR",children:"Croatia (+385)"}),(0,i.jsx)("option",{value:"CU",children:"Cuba (+53)"}),(0,i.jsx)("option",{value:"CY",children:"Cyprus North (+90392)"}),(0,i.jsx)("option",{value:"CY",children:"Cyprus South (+357)"}),(0,i.jsx)("option",{value:"CZ",children:"Czech Republic (+42)"}),(0,i.jsx)("option",{value:"DK",children:"Denmark (+45)"}),(0,i.jsx)("option",{value:"DJ",children:"Djibouti (+253)"}),(0,i.jsx)("option",{value:"DM",children:"Dominica (+1809)"}),(0,i.jsx)("option",{value:"DO",children:"Dominican Republic (+18XX)"}),(0,i.jsx)("option",{value:"EC",children:"Ecuador (+593)"}),(0,i.jsx)("option",{value:"EG",children:"Egypt (+20)"}),(0,i.jsx)("option",{value:"SV",children:"El Salvador (+503)"}),(0,i.jsx)("option",{value:"GQ",children:"Equatorial Guinea (+240)"}),(0,i.jsx)("option",{value:"ER",children:"Eritrea (+291)"}),(0,i.jsx)("option",{value:"EE",children:"Estonia (+372)"}),(0,i.jsx)("option",{value:"ET",children:"Ethiopia (+251)"}),(0,i.jsx)("option",{value:"FK",children:"Falkland Islands (+500)"}),(0,i.jsx)("option",{value:"FO",children:"Faroe Islands (+298)"}),(0,i.jsx)("option",{value:"FJ",children:"Fiji (+679)"}),(0,i.jsx)("option",{value:"FI",children:"Finland (+358)"}),(0,i.jsx)("option",{value:"FR",children:"France (+33)"}),(0,i.jsx)("option",{value:"GF",children:"French Guiana (+594)"}),(0,i.jsx)("option",{value:"PF",children:"French Polynesia (+689)"}),(0,i.jsx)("option",{value:"GA",children:"Gabon (+241)"}),(0,i.jsx)("option",{value:"GM",children:"Gambia (+220)"}),(0,i.jsx)("option",{value:"GE",children:"Georgia (+7880)"}),(0,i.jsx)("option",{value:"DE",children:"Germany (+49)"}),(0,i.jsx)("option",{value:"GH",children:"Ghana (+233)"}),(0,i.jsx)("option",{value:"GI",children:"Gibraltar (+350)"}),(0,i.jsx)("option",{value:"GR",children:"Greece (+30)"}),(0,i.jsx)("option",{value:"GL",children:"Greenland (+299)"}),(0,i.jsx)("option",{value:"GD",children:"Grenada (+1473)"}),(0,i.jsx)("option",{value:"GP",children:"Guadeloupe (+590)"}),(0,i.jsx)("option",{value:"GU",children:"Guam (+671)"}),(0,i.jsx)("option",{value:"GT",children:"Guatemala (+502)"}),(0,i.jsx)("option",{value:"GN",children:"Guinea (+224)"}),(0,i.jsx)("option",{value:"GW",children:"Guinea - Bissau (+245)"}),(0,i.jsx)("option",{value:"GY",children:"Guyana (+592)"}),(0,i.jsx)("option",{value:"HT",children:"Haiti (+509)"}),(0,i.jsx)("option",{value:"HN",children:"Honduras (+504)"}),(0,i.jsx)("option",{value:"HK",children:"Hong Kong (+852)"}),(0,i.jsx)("option",{value:"HU",children:"Hungary (+36)"}),(0,i.jsx)("option",{value:"IS",children:"Iceland (+354)"}),(0,i.jsx)("option",{value:"IN",children:"India (+91)"}),(0,i.jsx)("option",{value:"ID",children:"Indonesia (+62)"}),(0,i.jsx)("option",{value:"IR",children:"Iran (+98)"}),(0,i.jsx)("option",{value:"IQ",children:"Iraq (+964)"}),(0,i.jsx)("option",{value:"IE",children:"Ireland (+353)"}),(0,i.jsx)("option",{value:"IL",children:"Israel (+972)"}),(0,i.jsx)("option",{value:"IT",children:"Italy (+39)"}),(0,i.jsx)("option",{value:"JM",children:"Jamaica (+1876)"}),(0,i.jsx)("option",{value:"JP",children:"Japan (+81)"}),(0,i.jsx)("option",{value:"JO",children:"Jordan (+962)"}),(0,i.jsx)("option",{value:"KZ",children:"Kazakhstan (+7)"}),(0,i.jsx)("option",{value:"KE",children:"Kenya (+254)"}),(0,i.jsx)("option",{value:"KI",children:"Kiribati (+686)"}),(0,i.jsx)("option",{value:"KP",children:"Korea North (+850)"}),(0,i.jsx)("option",{value:"KR",children:"Korea South (+82)"}),(0,i.jsx)("option",{value:"KW",children:"Kuwait (+965)"}),(0,i.jsx)("option",{value:"KG",children:"Kyrgyzstan (+996)"}),(0,i.jsx)("option",{value:"LA",children:"Laos (+856)"}),(0,i.jsx)("option",{value:"LV",children:"Latvia (+371)"}),(0,i.jsx)("option",{value:"LB",children:"Lebanon (+961)"}),(0,i.jsx)("option",{value:"LS",children:"Lesotho (+266)"}),(0,i.jsx)("option",{value:"LR",children:"Liberia (+231)"}),(0,i.jsx)("option",{value:"LY",children:"Libya (+218)"}),(0,i.jsx)("option",{value:"LI",children:"Liechtenstein (+417)"}),(0,i.jsx)("option",{value:"LT",children:"Lithuania (+370)"}),(0,i.jsx)("option",{value:"LU",children:"Luxembourg (+352)"}),(0,i.jsx)("option",{value:"MO",children:"Macao (+853)"}),(0,i.jsx)("option",{value:"MK",children:"Macedonia (+389)"}),(0,i.jsx)("option",{value:"MG",children:"Madagascar (+261)"}),(0,i.jsx)("option",{value:"MW",children:"Malawi (+265)"}),(0,i.jsx)("option",{value:"MY",children:"Malaysia (+60)"}),(0,i.jsx)("option",{value:"MV",children:"Maldives (+960)"}),(0,i.jsx)("option",{value:"ML",children:"Mali (+223)"}),(0,i.jsx)("option",{value:"MT",children:"Malta (+356)"}),(0,i.jsx)("option",{value:"MH",children:"Marshall Islands (+692)"}),(0,i.jsx)("option",{value:"MQ",children:"Martinique (+596)"}),(0,i.jsx)("option",{value:"MR",children:"Mauritania (+222)"}),(0,i.jsx)("option",{value:"YT",children:"Mayotte (+269)"}),(0,i.jsx)("option",{value:"MX",children:"Mexico (+52)"}),(0,i.jsx)("option",{value:"FM",children:"Micronesia (+691)"}),(0,i.jsx)("option",{value:"MD",children:"Moldova (+373)"}),(0,i.jsx)("option",{value:"MC",children:"Monaco (+377)"}),(0,i.jsx)("option",{value:"MN",children:"Mongolia (+976)"}),(0,i.jsx)("option",{value:"MS",children:"Montserrat (+1664)"}),(0,i.jsx)("option",{value:"MA",children:"Morocco (+212)"}),(0,i.jsx)("option",{value:"MZ",children:"Mozambique (+258)"}),(0,i.jsx)("option",{value:"MN",children:"Myanmar (+95)"}),(0,i.jsx)("option",{value:"NA",children:"Namibia (+264)"}),(0,i.jsx)("option",{value:"NR",children:"Nauru (+674)"}),(0,i.jsx)("option",{value:"NP",children:"Nepal (+977)"}),(0,i.jsx)("option",{value:"NL",children:"Netherlands (+31)"}),(0,i.jsx)("option",{value:"NC",children:"New Caledonia (+687)"}),(0,i.jsx)("option",{value:"NZ",children:"New Zealand (+64)"}),(0,i.jsx)("option",{value:"NI",children:"Nicaragua (+505)"}),(0,i.jsx)("option",{value:"NE",children:"Niger (+227)"}),(0,i.jsx)("option",{value:"NG",children:"Nigeria (+234)"}),(0,i.jsx)("option",{value:"NU",children:"Niue (+683)"}),(0,i.jsx)("option",{value:"NF",children:"Norfolk Islands (+672)"}),(0,i.jsx)("option",{value:"NP",children:"Northern Marianas (+670)"}),(0,i.jsx)("option",{value:"NO",children:"Norway (+47)"}),(0,i.jsx)("option",{value:"OM",children:"Oman (+968)"}),(0,i.jsx)("option",{value:"PW",children:"Palau (+680)"}),(0,i.jsx)("option",{value:"PA",children:"Panama (+507)"}),(0,i.jsx)("option",{value:"PG",children:"Papua New Guinea (+675)"}),(0,i.jsx)("option",{value:"PY",children:"Paraguay (+595)"}),(0,i.jsx)("option",{value:"PE",children:"Peru (+51)"}),(0,i.jsx)("option",{value:"PH",children:"Philippines (+63)"}),(0,i.jsx)("option",{value:"PL",children:"Poland (+48)"}),(0,i.jsx)("option",{value:"PT",children:"Portugal (+351)"}),(0,i.jsx)("option",{value:"PR",children:"Puerto Rico (+1787)"}),(0,i.jsx)("option",{value:"QA",children:"Qatar (+974)"}),(0,i.jsx)("option",{value:"RE",children:"Reunion (+262)"}),(0,i.jsx)("option",{value:"RO",children:"Romania (+40)"}),(0,i.jsx)("option",{value:"RU",children:"Russia (+7)"}),(0,i.jsx)("option",{value:"RW",children:"Rwanda (+250)"}),(0,i.jsx)("option",{value:"SM",children:"San Marino (+378)"}),(0,i.jsx)("option",{value:"ST",children:"Sao Tome & Principe (+239)"}),(0,i.jsx)("option",{value:"SA",children:"Saudi Arabia (+966)"}),(0,i.jsx)("option",{value:"SN",children:"Senegal (+221)"}),(0,i.jsx)("option",{value:"CS",children:"Serbia (+381)"}),(0,i.jsx)("option",{value:"SC",children:"Seychelles (+248)"}),(0,i.jsx)("option",{value:"SL",children:"Sierra Leone (+232)"}),(0,i.jsx)("option",{value:"SG",children:"Singapore (+65)"}),(0,i.jsx)("option",{value:"SK",children:"Slovak Republic (+421)"}),(0,i.jsx)("option",{value:"SI",children:"Slovenia (+386)"}),(0,i.jsx)("option",{value:"SB",children:"Solomon Islands (+677)"}),(0,i.jsx)("option",{value:"SO",children:"Somalia (+252)"}),(0,i.jsx)("option",{value:"ZA",children:"South Africa (+27)"}),(0,i.jsx)("option",{value:"ES",children:"Spain (+34)"}),(0,i.jsx)("option",{value:"LK",children:"Sri Lanka (+94)"}),(0,i.jsx)("option",{value:"SH",children:"St. Helena (+290)"}),(0,i.jsx)("option",{value:"KN",children:"St. Kitts (+1869)"}),(0,i.jsx)("option",{value:"SC",children:"St. Lucia (+1758)"}),(0,i.jsx)("option",{value:"SD",children:"Sudan (+249)"}),(0,i.jsx)("option",{value:"SR",children:"Suriname (+597)"}),(0,i.jsx)("option",{value:"SZ",children:"Swaziland (+268)"}),(0,i.jsx)("option",{value:"SE",children:"Sweden (+46)"}),(0,i.jsx)("option",{value:"CH",children:"Switzerland (+41)"}),(0,i.jsx)("option",{value:"SI",children:"Syria (+963)"}),(0,i.jsx)("option",{value:"TW",children:"Taiwan (+886)"}),(0,i.jsx)("option",{value:"TJ",children:"Tajikstan (+7)"}),(0,i.jsx)("option",{value:"TH",children:"Thailand (+66)"}),(0,i.jsx)("option",{value:"TZ",children:"Tanzania - United Rebublic (+255)"}),(0,i.jsx)("option",{value:"TG",children:"Togo (+228)"}),(0,i.jsx)("option",{value:"TO",children:"Tonga (+676)"}),(0,i.jsx)("option",{value:"TT",children:"Trinidad & Tobago (+1868)"}),(0,i.jsx)("option",{value:"TN",children:"Tunisia (+216)"}),(0,i.jsx)("option",{value:"TR",children:"Turkey (+90)"}),(0,i.jsx)("option",{value:"TM",children:"Turkmenistan (+7)"}),(0,i.jsx)("option",{value:"TM",children:"Turkmenistan (+993)"}),(0,i.jsx)("option",{value:"TC",children:"Turks & Caicos Islands (+1649)"}),(0,i.jsx)("option",{value:"TV",children:"Tuvalu (+688)"}),(0,i.jsx)("option",{value:"UG",children:"Uganda (+256)"}),(0,i.jsx)("option",{value:"GB",children:"UK (+44)"}),(0,i.jsx)("option",{value:"UA",children:"Ukraine (+380)"}),(0,i.jsx)("option",{value:"AE",children:"United Arab Emirates (+971)"}),(0,i.jsx)("option",{value:"UY",children:"Uruguay (+598)"}),(0,i.jsx)("option",{value:"US",children:"USA (+1)"}),(0,i.jsx)("option",{value:"UZ",children:"Uzbekistan (+7)"}),(0,i.jsx)("option",{value:"VU",children:"Vanuatu (+678)"}),(0,i.jsx)("option",{value:"VA",children:"Vatican City (+379)"}),(0,i.jsx)("option",{value:"VE",children:"Venezuela (+58)"}),(0,i.jsx)("option",{value:"VN",children:"Vietnam (+84)"}),(0,i.jsx)("option",{value:"VG",children:"Virgin Islands - British (+1284)"}),(0,i.jsx)("option",{value:"VI",children:"Virgin Islands - US (+1340)"}),(0,i.jsx)("option",{value:"WF",children:"Wallis & Futuna (+681)"}),(0,i.jsx)("option",{value:"YE",children:"Yemen (North)(+969)"}),(0,i.jsx)("option",{value:"YE",children:"Yemen (South)(+967)"}),(0,i.jsx)("option",{value:"ZM",children:"Zambia (+260)"}),(0,i.jsx)("option",{value:"ZW",children:"Zimbabwe (+263)"})]})},eP=e=>{var l,n,t,o,a;let{options:s,onOptionsChange:r}=e,{t:d}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.placeholder.label"),defaultValue:null!=(t=null==s||null==(l=s.labels)?void 0:l.placeholder)?t:eD.labels.placeholder,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,placeholder:e}})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.button.label"),defaultValue:null!=(o=null==s||null==(n=s.labels)?void 0:n.button)?o:eD.labels.button,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,button:e}})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"button",children:d("blocks.inputs.phone.settings.defaultCountry.label")}),(0,i.jsx)(eL,{onSelect:e=>r({...s,defaultCountryCode:e}),countryCode:null==s?void 0:s.defaultCountryCode})]}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.retryMessage.label"),defaultValue:null!=(a=null==s?void 0:s.retryMessageContent)?a:eD.retryMessageContent,onChange:e=>r({...s,retryMessageContent:e})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:d("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==s?void 0:s.variableId,onSelectVariable:e=>r({...s,variableId:null==e?void 0:e.id})})]})]})},eN={buttonLabel:es.GY,searchInputPlaceholder:"Filter the options...",isMultipleChoice:!1,isSearchable:!1,dynamicItems:{isEnabled:!1}},eG=e=>{var l,n,t,o,a,s,r,d,u;let{options:c,onOptionsChange:p}=e,{t:h}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(H.J,{label:h("blocks.inputs.settings.isSearchable.label"),initialValue:null!=(a=null==c?void 0:c.isSearchable)?a:eN.isSearchable,onCheckChange:e=>p({...c,isSearchable:e}),children:(0,i.jsx)(Q.ks,{label:h("blocks.inputs.settings.input.placeholder.label"),defaultValue:null!=(s=null==c?void 0:c.searchInputPlaceholder)?s:eN.searchInputPlaceholder,onChange:e=>p({...c,searchInputPlaceholder:e})})}),(0,i.jsx)(H.J,{label:h("blocks.inputs.settings.multipleChoice.label"),initialValue:null!=(r=null==c?void 0:c.isMultipleChoice)?r:eN.isMultipleChoice,onCheckChange:e=>p({...c,isMultipleChoice:e}),children:(0,i.jsx)(Q.ks,{label:h("blocks.inputs.settings.submitButton.label"),defaultValue:null!=(d=null==c?void 0:c.buttonLabel)?d:eN.buttonLabel,onChange:e=>p({...c,buttonLabel:e})})}),(0,i.jsxs)(H.J,{label:h("blocks.inputs.picture.settings.dynamicItems.label"),initialValue:null!=(u=null==c||null==(l=c.dynamicItems)?void 0:l.isEnabled)?u:eN.dynamicItems.isEnabled,onCheckChange:e=>p({...c,dynamicItems:{...null==c?void 0:c.dynamicItems,isEnabled:e}}),children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:h("blocks.inputs.picture.settings.dynamicItems.images.label")}),(0,i.jsx)(J.x,{initialVariableId:null==c||null==(n=c.dynamicItems)?void 0:n.pictureSrcsVariableId,onSelectVariable:e=>p({...c,dynamicItems:{...null==c?void 0:c.dynamicItems,pictureSrcsVariableId:null==e?void 0:e.id}})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:h("blocks.inputs.picture.settings.dynamicItems.titles.label")}),(0,i.jsx)(J.x,{initialVariableId:null==c||null==(t=c.dynamicItems)?void 0:t.titlesVariableId,onSelectVariable:e=>p({...c,dynamicItems:{...null==c?void 0:c.dynamicItems,titlesVariableId:null==e?void 0:e.id}})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:h("blocks.inputs.picture.settings.dynamicItems.descriptions.label")}),(0,i.jsx)(J.x,{initialVariableId:null==c||null==(o=c.dynamicItems)?void 0:o.descriptionsVariableId,onSelectVariable:e=>p({...c,dynamicItems:{...null==c?void 0:c.dynamicItems,descriptionsVariableId:null==e?void 0:e.id}})})]})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:h("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==c?void 0:c.variableId,onSelectVariable:e=>p({...c,variableId:null==e?void 0:e.id})})]})]})},eW={buttonType:"Numbers",length:10,labels:{button:es.GY},startsAt:0,customIcon:{isEnabled:!1},isOneClickSubmitEnabled:!1},eU=e=>{var l,n,t,o,a,s,r,d,u,c,p,h;let{options:b,onOptionsChange:x}=e,{t:v}=(0,$.WD)(),m=null!=(s=null==b?void 0:b.length)?s:eW.length,g=null!=(r=null==b?void 0:b.isOneClickSubmitEnabled)?r:eW.isOneClickSubmitEnabled,j=null!=(d=null==b?void 0:b.buttonType)?d:eW.buttonType;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"button",children:v("blocks.inputs.rating.settings.maximum.label")}),(0,i.jsx)(en.Q,{onItemSelect:e=>x({...b,length:e}),items:[3,4,5,6,7,8,9,10],currentItem:m})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"button",children:v("blocks.inputs.rating.settings.type.label")}),(0,i.jsx)(en.Q,{onItemSelect:e=>x({...b,buttonType:e}),items:["Icons","Numbers"],currentItem:j})]}),"Numbers"===j&&(0,i.jsx)(Q.Q7,{defaultValue:null!=(u=null==b?void 0:b.startsAt)?u:eW.startsAt,onValueChange:e=>x({...b,startsAt:e}),label:"Starts at",direction:"row"}),"Icons"===j&&(0,i.jsx)(Y.R,{label:v("blocks.inputs.rating.settings.customIcon.label"),initialValue:null!=(c=null==b||null==(l=b.customIcon)?void 0:l.isEnabled)?c:eW.customIcon.isEnabled,onCheckChange:e=>x({...b,customIcon:{...null==b?void 0:b.customIcon,isEnabled:e}})}),"Icons"===j&&(null==b||null==(n=b.customIcon)?void 0:n.isEnabled)&&(0,i.jsx)(Q.ks,{label:v("blocks.inputs.rating.settings.iconSVG.label"),defaultValue:b.customIcon.svg,onChange:e=>x({...b,customIcon:{...null==b?void 0:b.customIcon,svg:e}}),placeholder:"<svg>...</svg>"}),(0,i.jsx)(Q.ks,{label:v("blocks.inputs.rating.settings.rateLabel.label",{rate:"Icons"===j?"1":null!=(p=null==b?void 0:b.startsAt)?p:eW.startsAt}),defaultValue:null==b||null==(t=b.labels)?void 0:t.left,onChange:e=>x({...b,labels:{...null==b?void 0:b.labels,left:e}}),placeholder:v("blocks.inputs.rating.settings.notLikely.placeholder.label")}),(0,i.jsx)(Q.ks,{label:v("blocks.inputs.rating.settings.rateLabel.label",{rate:m}),defaultValue:null==b||null==(o=b.labels)?void 0:o.right,onChange:e=>x({...b,labels:{...null==b?void 0:b.labels,right:e}}),placeholder:v("blocks.inputs.rating.settings.extremelyLikely.placeholder.label")}),(0,i.jsx)(Y.R,{label:v("blocks.inputs.rating.settings.oneClickSubmit.label"),moreInfoContent:v("blocks.inputs.rating.settings.oneClickSubmit.infoText.label"),initialValue:g,onCheckChange:e=>x({...b,isOneClickSubmitEnabled:e})}),!g&&(0,i.jsx)(Q.ks,{label:v("blocks.inputs.settings.button.label"),defaultValue:null!=(h=null==b||null==(a=b.labels)?void 0:a.button)?h:eW.labels.button,onChange:e=>x({...b,labels:{...null==b?void 0:b.labels,button:e}})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:v("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==b?void 0:b.variableId,onSelectVariable:e=>x({...b,variableId:null==e?void 0:e.id})})]})]})},ez={isLong:!1,labels:{button:es.GY,placeholder:"Type your answer..."},audioClip:{isEnabled:!1,visibility:"Auto"},attachments:{isEnabled:!1,visibility:"Auto"}};var eF=n(8756);let eK=e=>{var l,n,t,o,a,s,r,d,u,c,p,h,b,x,v,m;let{options:g,onOptionsChange:j}=e,{t:f}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Y.R,{label:f("blocks.inputs.text.settings.longText.label"),initialValue:null!=(u=null==g?void 0:g.isLong)?u:ez.isLong,onCheckChange:e=>j({...g,isLong:e})}),(0,i.jsx)(Q.ks,{label:f("blocks.inputs.settings.placeholder.label"),defaultValue:null!=(c=null==g||null==(l=g.labels)?void 0:l.placeholder)?c:ez.labels.placeholder,onChange:e=>j({...g,labels:{...null==g?void 0:g.labels,placeholder:e}})}),(0,i.jsx)(Q.ks,{label:f("blocks.inputs.settings.button.label"),defaultValue:null!=(p=null==g||null==(n=g.labels)?void 0:n.button)?p:ez.labels.button,onChange:e=>j({...g,labels:{...null==g?void 0:g.labels,button:e}})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"input-mode",children:"Input mode"}),(0,i.jsx)(ey.l,{selectedItem:null!=(h=null==g?void 0:g.inputMode)?h:"text",items:eF.iX,onSelect:e=>j({...g,inputMode:e}),placeholder:"Select input mode..."})]}),(0,i.jsxs)(H.J,{label:"Allow audio clip",initialValue:null!=(b=null==g||null==(t=g.audioClip)?void 0:t.isEnabled)?b:ez.audioClip.isEnabled,onCheckChange:e=>j({...g,audioClip:{...null==g?void 0:g.audioClip,isEnabled:e}}),children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:"Save the URL in a variable:"}),(0,i.jsx)(J.x,{initialVariableId:null==g||null==(o=g.audioClip)?void 0:o.saveVariableId,onSelectVariable:e=>j({...g,audioClip:{...null==g?void 0:g.audioClip,saveVariableId:null==e?void 0:e.id}})})]}),(0,i.jsx)(en.Q,{label:"Visibility:",moreInfoTooltip:'This setting determines who can see the uploaded files. "Public" means that anyone who has the link can see the files. "Private" means that only a members of this workspace can see the files.',currentItem:null!=(x=null==g||null==(a=g.audioClip)?void 0:a.visibility)?x:ez.audioClip.visibility,onItemSelect:e=>j({...g,audioClip:{...null==g?void 0:g.audioClip,visibility:e}}),items:ej.R})]}),(0,i.jsxs)(H.J,{label:"Allow attachments",initialValue:null!=(v=null==g||null==(s=g.attachments)?void 0:s.isEnabled)?v:ez.attachments.isEnabled,onCheckChange:e=>j({...g,attachments:{...null==g?void 0:g.attachments,isEnabled:e}}),children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:"Save the URLs in a variable:"}),(0,i.jsx)(J.x,{initialVariableId:null==g||null==(r=g.attachments)?void 0:r.saveVariableId,onSelectVariable:e=>j({...g,attachments:{...null==g?void 0:g.attachments,saveVariableId:null==e?void 0:e.id}})})]}),(0,i.jsx)(en.Q,{label:"Visibility:",moreInfoTooltip:'This setting determines who can see the uploaded files. "Public" means that anyone who has the link can see the files. "Private" means that only a members of this workspace can see the files.',currentItem:null!=(m=null==g||null==(d=g.attachments)?void 0:d.visibility)?m:ez.attachments.visibility,onItemSelect:e=>j({...g,attachments:{...null==g?void 0:g.attachments,visibility:e}}),items:ej.R})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:f("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==g?void 0:g.variableId,onSelectVariable:e=>j({...g,variableId:null==e?void 0:e.id})})]})]})};var e_=n(38847);let eH={labels:{button:es.GY},format:"HH:mm"},eQ=e=>{var l,n,t;let{options:o,onOptionsChange:a}=e,{t:s}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(e_.k,{label:s("blocks.inputs.date.settings.format.label"),defaultValue:null!=(n=null==o?void 0:o.format)?n:eH.format,moreInfoTooltip:"\n					Unicode Technical Standard #35 (i.e. for 24h format: HH:mm, for AM/PM format: hh:mm a)\n				",placeholder:eH.format,onChange:e=>{a({...o,format:e})}}),(0,i.jsx)(e_.k,{label:s("blocks.inputs.settings.button.label"),defaultValue:null!=(t=null==o||null==(l=o.labels)?void 0:l.button)?t:eH.labels.button,onChange:e=>a({...o,labels:{button:e}})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:s("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==o?void 0:o.variableId,onSelectVariable:e=>{a({...o,variableId:null==e?void 0:e.id})}})]})]})},eY={labels:{button:es.GY,placeholder:"Type a URL..."},retryMessageContent:"This URL doesn't seem to be valid. Can you type it again?"},eJ=e=>{var l,n,t,o,a;let{options:s,onOptionsChange:r}=e,{t:d}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.placeholder.label"),defaultValue:null!=(t=null==s||null==(l=s.labels)?void 0:l.placeholder)?t:eY.labels.placeholder,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,placeholder:e}})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.button.label"),defaultValue:null!=(o=null==s||null==(n=s.labels)?void 0:n.button)?o:eY.labels.button,onChange:e=>r({...s,labels:{...null==s?void 0:s.labels,button:e}})}),(0,i.jsx)(Q.ks,{label:d("blocks.inputs.settings.retryMessage.label"),defaultValue:null!=(a=null==s?void 0:s.retryMessageContent)?a:eY.retryMessageContent,onChange:e=>r({...s,retryMessageContent:e})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:d("blocks.inputs.settings.saveAnswer.label")}),(0,i.jsx)(J.x,{initialVariableId:null==s?void 0:s.variableId,onSelectVariable:e=>r({...s,variableId:null==e?void 0:e.id})})]})]})};var eZ=n(76366);let eX=e=>{var l,n,t,o,a,s,r,d;let{options:u,onOptionsChange:c}=e,p=null!=(s=null==u?void 0:u.task)?s:eZ.t.task;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(en.Q,{currentItem:null!=(r=null==u?void 0:u.task)?r:eZ.t.task,onItemSelect:e=>{c({...u,task:e})},items:eZ.E}),"Show widget"===p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q.ks,{isRequired:!0,label:"Base URL",defaultValue:null!=(d=null==u?void 0:u.baseUrl)?d:eZ.t.baseUrl,onChange:e=>{c({...u,baseUrl:e})},withVariableButton:!1}),(0,i.jsx)(Q.ks,{isRequired:!0,label:"Website token",defaultValue:null==u?void 0:u.websiteToken,onChange:e=>c({...u,websiteToken:e}),moreInfoTooltip:"Can be found in Chatwoot under Settings > Inboxes > Settings > Configuration, in the code snippet."}),(0,i.jsx)(eb.n,{allowMultiple:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Set user details",(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{pb:4,as:Z.B,spacing:"4",children:[(0,i.jsx)(Q.ks,{label:"ID",defaultValue:null==u||null==(l=u.user)?void 0:l.id,onChange:e=>{c({...u,user:{...null==u?void 0:u.user,id:e}})}}),(0,i.jsx)(Q.ks,{label:"Name",defaultValue:null==u||null==(n=u.user)?void 0:n.name,onChange:e=>{c({...u,user:{...null==u?void 0:u.user,name:e}})}}),(0,i.jsx)(Q.ks,{label:"Email",defaultValue:null==u||null==(t=u.user)?void 0:t.email,onChange:e=>{c({...u,user:{...null==u?void 0:u.user,email:e}})}}),(0,i.jsx)(Q.ks,{label:"Avatar URL",defaultValue:null==u||null==(o=u.user)?void 0:o.avatarUrl,onChange:e=>{c({...u,user:{...null==u?void 0:u.user,avatarUrl:e}})}}),(0,i.jsx)(Q.ks,{label:"Phone number",defaultValue:null==u||null==(a=u.user)?void 0:a.phoneNumber,onChange:e=>{c({...u,user:{...null==u?void 0:u.user,phoneNumber:e}})}})]})]})})]})]})},eq=e=>{var l;let{options:n,onOptionsChange:t}=e;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:"Measurement ID:",moreInfoTooltip:"Can be found by clicking on your data stream in Google Analytics dashboard",defaultValue:null==n?void 0:n.trackingId,placeholder:"G-123456...",onChange:e=>t({...n,trackingId:e})}),(0,i.jsx)(Q.ks,{label:"Event action:",defaultValue:null==n?void 0:n.action,placeholder:"Example: conversion",onChange:e=>t({...n,action:e})}),(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsx)("h2",{children:(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(p.az,{flex:"1",textAlign:"left",children:"Advanced"}),(0,i.jsx)(em.Q,{})]})}),(0,i.jsxs)(eg.v,{pb:4,as:Z.B,spacing:"6",children:[(0,i.jsx)(Q.ks,{label:"Event category:",defaultValue:null==n?void 0:n.category,placeholder:"Example: Typebot",onChange:e=>t({...n,category:e})}),(0,i.jsx)(Q.ks,{label:"Event label:",defaultValue:null==n?void 0:n.label,placeholder:"Example: Campaign Z",onChange:e=>t({...n,label:e})}),(0,i.jsx)(Q.Q7,{direction:"column",label:"Event value:",defaultValue:null==n?void 0:n.value,placeholder:"Example: 0",onValueChange:e=>t({...n,value:e})}),(0,i.jsx)(Q.ks,{label:"Send to:",moreInfoTooltip:"Useful to send a conversion event to Google Ads",defaultValue:null==n||null==(l=n.sendTo)?void 0:l.toString(),placeholder:"Example: AW-123456789",onChange:e=>t({...n,sendTo:e})})]})]})})]})};var e$=n(70290),e0=n(2283),e1=n(98444),e2=n(97036),e4=n(2965);let e3=e=>{let{credentialsId:l,spreadsheetId:n,workspaceId:t,onError:i}=e,o=(0,e2.stringify)({credentialsId:l}),{data:a,error:s,mutate:r}=(0,e4.Ay)(l&&n&&t?"/api/integrations/google-sheets/spreadsheets/".concat(n,"/sheets?").concat(o):null,e1.G);return s&&i&&i(s),{sheets:null==a?void 0:a.sheets,isLoading:!s&&!a,mutate:r}},e5=e=>{var l;let{item:n,onItemChange:t,columns:o}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",w:"full",children:[(0,i.jsx)(en.Q,{currentItem:n.column,onItemSelect:e=>{n.column!==e&&t({...n,column:e})},items:o,placeholder:"Select a column"}),(0,i.jsx)(Q.ks,{defaultValue:null!=(l=n.value)?l:"",onChange:e=>{n.value!==e&&t({...n,value:e})},placeholder:"Type a value..."})]})},e9=e=>{let{item:l,onItemChange:n,columns:t}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(en.Q,{currentItem:l.column,onItemSelect:e=>{l.column!==e&&n({...l,column:e})},items:t,placeholder:"Select a column"}),(0,i.jsx)(J.x,{initialVariableId:l.variableId,onSelectVariable:e=>{l.variableId!==(null==e?void 0:e.id)&&n({...l,variableId:null==e?void 0:e.id})},placeholder:"Select a variable"})]})};var e6=n(91525),e7=n(59309),e8=n(12482),le=n(10548),ll=n(47025);let ln=e=>{let{spreadsheetId:l,workspaceId:n,credentialsId:t,onSpreadsheetIdSelect:o}=e,[a,s]=(0,m.useState)(!1),{data:r}=(0,e8.I)(e7.id.sheets.getAccessToken.queryOptions({workspaceId:n,credentialsId:t})),{data:u,status:c}=(0,e8.I)(e7.id.sheets.getSpreadsheetName.queryOptions({workspaceId:n,credentialsId:t,spreadsheetId:l},{enabled:!!l}));(0,m.useEffect)(()=>{p("gapi","https://apis.google.com/js/api.js",()=>{window.gapi.load("picker",()=>{s(!0)})})},[]);let p=(e,l,n)=>{if(document.getElementById(e))return void n();let t=document.createElement("script");t.type="text/javascript",t.onload=()=>{n()},t.src=l,document.head.appendChild(t)},h=()=>{if(r){if(!a)throw Error("Google Picker not inited");new window.google.picker.PickerBuilder().addView(new window.google.picker.View(window.google.picker.ViewId.SPREADSHEETS).setMimeTypes("application/vnd.google-apps.spreadsheet")).setOAuthToken(r.accessToken).setDeveloperKey(le._.NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY).setCallback(b).build().setVisible(!0)}},b=e=>{var l;if("picked"!==e.action)return;let n=null==(l=e.docs[0])?void 0:l.id;n&&o(n)};return u&&""!==u.name?(0,i.jsxs)(d.s,{justifyContent:"space-between",children:[(0,i.jsxs)(V.z,{spacing:2,children:[(0,i.jsx)(ll.R,{}),(0,i.jsx)(eI.E,{fontWeight:"medium",children:u.name})]}),(0,i.jsx)(B.K,{size:"sm",icon:(0,i.jsx)(S.oS,{}),onClick:h,isLoading:!a,"aria-label":"Pick another spreadsheet"})]}):(0,i.jsx)(A.$,{onClick:h,isLoading:!a||(0,e0.O9)(l)&&"pending"===c,children:"Pick a spreadsheet"})};var lt=n(14124);let li=e=>{var l;let{item:n,columns:t,onItemChange:o}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(en.Q,{currentItem:n.column,onItemSelect:e=>{e!==n.column&&o({...n,column:e})},items:t,placeholder:"Select a column"}),(0,i.jsx)(en.Q,{currentItem:n.comparisonOperator,onItemSelect:e=>{e!==n.comparisonOperator&&o({...n,comparisonOperator:e})},items:Object.values(lt.J),placeholder:"Select an operator"}),n.comparisonOperator!==lt.J.IS_SET&&n.comparisonOperator!==lt.J.IS_EMPTY&&(0,i.jsx)(Q.ks,{defaultValue:null!=(l=n.value)?l:"",onChange:e=>{e!==n.value&&o({...n,value:e})},placeholder:"Type a value..."})]})},lo=e=>{var l;let{filter:n,columns:t,onFilterChange:o}=e,a=e=>n&&o({...n,logicalOperator:e});return(0,i.jsx)(et.B,{initialItems:null!=(l=null==n?void 0:n.comparisons)?l:[],onItemsChange:e=>{var l;return o({...n,logicalOperator:null!=(l=null==n?void 0:n.logicalOperator)?l:lt.u.AND,comparisons:e})},ComponentBetweenItems:()=>(0,i.jsx)(d.s,{justify:"center",children:(0,i.jsx)(en.Q,{currentItem:null==n?void 0:n.logicalOperator,onItemSelect:a,items:Object.values(lt.u)})}),addLabel:"Add filter rule",children:e=>(0,i.jsx)(li,{...e,columns:t})})};var la=n(96378);let ls=e=>{let{sheets:l,isLoading:n,sheetId:t,onSelectSheetId:o}=e;return n?(0,i.jsx)(la.p,{value:"Loading...",isDisabled:!0}):l&&0!==l.length?(0,i.jsx)(ey.l,{selectedItem:t,items:(null!=l?l:[]).map(e=>({label:e.name,value:e.id})),onSelect:o,placeholder:"Select the sheet"}):(0,i.jsxs)(V.z,{children:[(0,i.jsx)(la.p,{value:"No sheets found",isDisabled:!0}),(0,i.jsx)(_.t,{children:"Make sure your spreadsheet contains at least a sheet with a header row. Also make sure your header row does not contain duplicates."})]})},lr=e=>{let{options:l,onOptionsChange:n,blockId:t}=e,{workspace:o}=(0,eT.h)(),{typebot:s}=(0,a.V)(),{save:r}=(0,a.V)(),{sheets:d,isLoading:u}=e3({credentialsId:null==l?void 0:l.credentialsId,spreadsheetId:null==l?void 0:l.spreadsheetId,workspaceId:null==o?void 0:o.id}),{isOpen:c,onOpen:p,onClose:h}=(0,eV.j)(),b=(0,m.useMemo)(()=>null==d?void 0:d.find(e=>e.id===(null==l?void 0:l.sheetId)),[d,null==l?void 0:l.sheetId]),x=async()=>{await r(),p()};return(0,i.jsxs)(Z.B,{spacing:4,children:[o&&(0,i.jsx)(eS.s,{type:"google sheets",scope:{type:"workspace",workspaceId:o.id},currentCredentialsId:null==l?void 0:l.credentialsId,onCredentialsSelect:e=>n({...l,credentialsId:e}),onCreateNewClick:x,credentialsName:"Sheets account"}),s&&(0,i.jsx)(e6.A,{typebotId:s.id,blockId:t,isOpen:c,onClose:h}),(null==l?void 0:l.credentialsId)&&o&&(0,i.jsx)(ln,{spreadsheetId:l.spreadsheetId,workspaceId:o.id,credentialsId:l.credentialsId,onSpreadsheetIdSelect:e=>n({...l,spreadsheetId:e})}),(null==l?void 0:l.spreadsheetId)&&l.credentialsId&&(0,i.jsx)(ls,{sheets:null!=d?d:[],isLoading:u,sheetId:l.sheetId,onSelectSheetId:e=>n({...l,sheetId:e})}),(null==l?void 0:l.spreadsheetId)&&l.credentialsId&&(0,e0.O9)(l.sheetId)&&(0,i.jsx)(en.Q,{currentItem:"action"in l?l.action:void 0,onItemSelect:e=>n({credentialsId:null==l?void 0:l.credentialsId,spreadsheetId:null==l?void 0:l.spreadsheetId,sheetId:null==l?void 0:l.sheetId,action:e}),items:Object.values(e$.GE),placeholder:"Select an operation"}),(null==l?void 0:l.action)&&(0,i.jsx)(ld,{options:l,sheet:b,onOptionsChange:n})]})},ld=e=>{var l,n,t;let{options:o,sheet:a,onOptionsChange:s}=e,r=e=>s({...o,filter:e});switch(o.action){case e$.GE.INSERT_ROW:return(0,i.jsx)(et.B,{initialItems:o.cellsToInsert,onItemsChange:e=>s({...o,cellsToInsert:e}),addLabel:"Add a value",children:e=>{var l;let{item:n,onItemChange:t}=e;return(0,i.jsx)(e5,{item:n,onItemChange:t,columns:null!=(l=null==a?void 0:a.columns)?l:[]})}});case e$.GE.UPDATE_ROW:return(0,i.jsxs)(eb.n,{allowMultiple:!0,children:[(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Row(s) to update"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(lo,{columns:null!=(l=null==a?void 0:a.columns)?l:[],filter:o.filter,onFilterChange:r})})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Cells to update"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:o.cellsToUpsert,onItemsChange:e=>s({...o,cellsToUpsert:e}),addLabel:"Add a value",children:e=>{var l;let{item:n,onItemChange:t}=e;return(0,i.jsx)(e5,{item:n,onItemChange:t,columns:null!=(l=null==a?void 0:a.columns)?l:[]})}})})]})]});case e$.GE.GET:return(0,i.jsx)(eb.n,{allowMultiple:!0,children:(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Select row(s)"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{pt:"4",as:Z.B,children:[(0,i.jsx)(en.Q,{items:e$.qw,currentItem:null!=(n=o.totalRowsToExtract)?n:e$.DT.totalRowsToExtract,onItemSelect:e=>s({...o,totalRowsToExtract:e})}),(0,i.jsx)(lo,{columns:null!=(t=null==a?void 0:a.columns)?t:[],filter:o.filter,onFilterChange:r})]})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Columns to extract"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:o.cellsToExtract,onItemsChange:e=>s({...o,cellsToExtract:e}),addLabel:"Add a value",hasDefaultItem:!0,children:e=>{var l;let{item:n,onItemChange:t}=e;return(0,i.jsx)(e9,{item:n,onItemChange:t,columns:null!=(l=null==a?void 0:a.columns)?l:[]})}})})]})]})});default:return(0,i.jsx)(i.Fragment,{})}};var lu=n(20873),lc=n(68498);let lp=e=>{let l=[];for(let n in e)if(e[n]&&"object"==typeof e[n]&&!Array.isArray(e[n])){let t=lp(e[n]);l=l.concat(t.map(e=>"".concat(lh(n,e)).concat(lb(e))))}else if(Array.isArray(e[n])){if("object"!=typeof e[n][0]){e[n].every(e=>"object"!=typeof e)&&l.push(n),l=l.concat(e[n].map((e,l)=>"".concat(n,"[").concat(l,"]")));continue}let t=new Set;for(let l of e[n])lp(l).forEach(e=>t.add(e));e[n].length>1&&(l=l.concat([...t].map(e=>"".concat(n,".flatMap(item => ").concat(lh("item",e)).concat(lb(e),")")))),l=l.concat([...t].map(e=>"".concat(n).concat(lh("0",e)).concat(lb(e))))}else l.push(n);return l},lh=(e,l)=>{let n=e;return(e.includes(" ")||e.includes("-")||!isNaN(e))&&(n=lx(e)),lb(l).startsWith("[")?n:"".concat(n,".")},lb=e=>(e.includes(" ")||e.includes("-")||!isNaN(e))&&!e.includes(".flatMap(item => item")&&!e.includes("['")&&!e.includes("']")?lx(e):"".concat(e),lx=e=>isNaN(e)?"['".concat(e,"']"):"[".concat(e,"]");var lv=n(23384);let lm=(e,l)=>e?[...l,...e.filter(e=>e.variableId).map(e=>({...l.find(l=>l.id===e.variableId),value:lg(e.value)}),{})].filter(e=>e.value):[],lg=e=>{if(!e)return"";try{var l;let n=JSON.parse(e);if(Array.isArray(n))return n.map(lv.J).filter(e0.O9);return null!=(l=(0,lv.J)(n))?l:e}catch(l){return e}},lj=(e,l,n)=>{let{blockId:t}=n;return(0,e0.w$)({url:"/api/typebots/".concat(e,"/blocks/").concat(t,"/testHttpRequest"),method:"POST",body:{variables:l}})},lf=e=>(0,i.jsx)(lI,{...e,keyPlaceholder:"e.g. email",valuePlaceholder:"e.g. {{Email}}"}),ly=e=>(0,i.jsx)(lI,{...e,keyPlaceholder:"e.g. Content-Type",valuePlaceholder:"e.g. application/json"}),lI=e=>{var l,n;let{item:t,onItemChange:o,keyPlaceholder:a,valuePlaceholder:s}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(Q.ks,{label:"Key:",defaultValue:null!=(l=t.key)?l:"",onChange:e=>{e!==t.key&&o({...t,key:e})},placeholder:a}),(0,i.jsx)(Q.ks,{label:"Value:",defaultValue:null!=(n=t.value)?n:"",onChange:e=>{e!==t.value&&o({...t,value:e})},placeholder:s})]})};var lC=n(39349),lk=n(32073),lE=n(67732),lw=n(60049),lS=n(51536),lT=n(46370),lV=n(33218),lM=n(49224);let lA=e=>{var l;let{items:n,onChange:t,debounceTimeout:o,placeholder:a,withVariableButton:s=!0,value:r,defaultValue:d,isRequired:c}=e,p=(0,M.dU)("gray.200","gray.700"),{onOpen:h,onClose:b,isOpen:x}=(0,eV.j)(),[v,j]=(0,m.useState)(!1),[f,y]=(0,m.useState)(null!=d?d:""),[I,C]=(0,m.useState)(null!=(l=f.length)?l:0),k=(0,g.YQ)(t,le._.NEXT_PUBLIC_E2E_TEST?0:o);(0,m.useEffect)(()=>{!v&&""===f&&d&&""!==d&&y(null!=d?d:"")},[d,f,v]);let[E,w]=(0,m.useState)(),S=(0,m.useRef)(null),T=(0,m.useRef)([]),B=(0,m.useRef)(null),{ref:R}=(0,lC.Z)(),O=(""===f?null!=n?n:[]:[...(null!=n?n:[]).filter(e=>e.toLowerCase().startsWith((null!=f?f:"").toLowerCase())&&e.toLowerCase()!==f.toLowerCase())]).slice(0,50);(0,lS.j)({ref:S,handler:b,isEnabled:x}),(0,m.useEffect)(()=>()=>{k.flush()},[k]);let D=e=>{v||j(!0),x||h(),y(e),k(e)},L=e=>()=>{var l;y(e),k(e),w(void 0),null==(l=B.current)||l.focus()};return(0,i.jsx)(X.MJ,{isRequired:c,children:(0,i.jsxs)(V.z,{ref:S,spacing:0,w:"full",children:[(0,i.jsxs)(lT.A,{isOpen:x,initialFocusRef:B,offset:[0,1],isLazy:!0,placement:"bottom-start",children:[(0,i.jsx)(lV.d,{children:(0,i.jsx)(la.p,{autoComplete:"off",ref:B,value:null!=r?r:f,onChange:e=>D(e.target.value),onFocus:h,onBlur:e=>{let l=e.target.selectionStart;l&&C(l)},onKeyDown:e=>{var l,n;if("Enter"===e.key&&(0,e0.O9)(E))return L(O[E])(),w(void 0);if("ArrowDown"===e.key)return void 0===E||E===O.length-1?w(0):(null==(l=T.current[E+1])||l.scrollIntoView({behavior:"smooth",block:"nearest"}),w(E+1));if("ArrowUp"===e.key){if(0===E||void 0===E)return w(O.length-1);null==(n=T.current[E-1])||n.scrollIntoView({behavior:"smooth",block:"nearest"}),w(E-1)}},placeholder:n?a:"Loading...",isDisabled:!n})}),O.length>0&&(0,i.jsx)(u.Z,{containerRef:R,children:(0,i.jsx)(lM.h,{maxH:"35vh",maxW:"35vw",overflowY:"auto",role:"menu",w:"inherit",shadow:"md",onMouseDown:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),children:O.map((e,l)=>(0,i.jsx)(A.$,{ref:e=>{T.current[l]=e},minH:"40px",onClick:L(e),fontSize:"16px",fontWeight:"normal",rounded:"none",colorScheme:"gray",role:"menuitem",variant:"ghost",bg:E===l?p:"transparent",justifyContent:"flex-start",transition:"none",children:e},l))})})]}),s&&(0,i.jsx)(lk.e,{onSelectVariable:e=>{if(!e)return;let{text:l,carretPosition:n}=(0,lE.k)({variable:e,text:f,at:I});D(l),(0,lw.T)({at:n,input:B.current})}})]})})},lB=e=>{let{item:l,onItemChange:n,dataItems:t}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsxs)(X.MJ,{children:[(0,i.jsx)(q.l,{htmlFor:"name",children:"Data:"}),(0,i.jsx)(lA,{items:t,defaultValue:l.bodyPath,onChange:e=>n({...l,bodyPath:e}),placeholder:"Select the data",withVariableButton:!0})]}),(0,i.jsxs)(X.MJ,{children:[(0,i.jsx)(q.l,{htmlFor:"value",children:"Set variable:"}),(0,i.jsx)(J.x,{onSelectVariable:e=>n({...l,variableId:null==e?void 0:e.id}),placeholder:"Search for a variable",initialVariableId:l.variableId})]})]})},lR=e=>{var l;let{item:n,onItemChange:t}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsxs)(X.MJ,{children:[(0,i.jsx)(q.l,{htmlFor:"name"+n.id,children:"Variable name:"}),(0,i.jsx)(J.x,{id:"name"+n.id,initialVariableId:n.variableId,onSelectVariable:e=>t({...n,variableId:null==e?void 0:e.id})})]}),(0,i.jsx)(Q.ks,{label:"Test value:",defaultValue:null!=(l=n.value)?l:"",onChange:e=>{e!==n.value&&t({...n,value:e})}})]})},lO=e=>{var l,n,t,o;let{blockId:s,httpRequest:r,options:d,onHttpRequestChange:u,onOptionsChange:c,onNewTestResponse:p}=e,{typebot:h,save:b}=(0,a.V)(),[x,v]=(0,m.useState)(!1),[g,j]=(0,m.useState)(),[f,y]=(0,m.useState)([]),I=async()=>{var e;if(!h)return;v(!0),null==d||d.webhook,await b();let{data:l,error:n}=await lj(h.id,lm(null!=(e=null==d?void 0:d.variablesForTest)?e:[],h.variables),{blockId:s});if(n)return(0,lu.o)({description:n.message});j(JSON.stringify(l,void 0,2)),y(lp(l)),v(!1),null==p||p()},C=(0,m.useMemo)(()=>function(e){return(0,i.jsx)(lB,{...e,dataItems:f})},[f]),k=null!=(l=null==d?void 0:d.isCustomBody)?l:lc.UW.isCustomBody;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Advanced configuration",(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{pt:"4",as:Z.B,spacing:"3",children:[(0,i.jsx)(Y.R,{label:"Execute on client",moreInfoContent:"If enabled, the httpRequest will be executed on the client. It means it will be executed in the browser of your visitor. Make sure to enable CORS and do not expose sensitive data.",initialValue:null!=(n=null==d?void 0:d.isExecutedOnClient)?n:lc.UW.isExecutedOnClient,onCheckChange:e=>c({...d,isExecutedOnClient:e})}),(0,i.jsxs)(V.z,{justify:"space-between",children:[(0,i.jsx)(eI.E,{children:"Method:"}),(0,i.jsx)(en.Q,{currentItem:null!=(t=null==r?void 0:r.method)?t:lc.y3.method,onItemSelect:e=>u({...r,method:e}),items:Object.values(lc.ym)})]}),(0,i.jsxs)(eb.n,{allowMultiple:!0,children:[(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Query params",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:null==r?void 0:r.queryParams,onItemsChange:e=>u({...r,queryParams:e}),addLabel:"Add a param",children:e=>(0,i.jsx)(lf,{...e})})})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Headers",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:null==r?void 0:r.headers,onItemsChange:e=>u({...r,headers:e}),addLabel:"Add a value",children:e=>(0,i.jsx)(ly,{...e})})})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Body",(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{py:4,as:Z.B,spacing:"6",children:[(0,i.jsx)(Y.R,{label:"Custom body",initialValue:k,onCheckChange:e=>c({...d,isCustomBody:e})}),k&&(0,i.jsx)(eh.B,{defaultValue:null==r?void 0:r.body,lang:"json",onChange:e=>u({...r,body:e}),debounceTimeout:0,withLineNumbers:!0})]})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Advanced parameters",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(Q.Q7,{label:"Timeout (s)",defaultValue:null!=(o=null==d?void 0:d.timeout)?o:lc.fr,min:1,max:lc.kJ,onValueChange:e=>c({...d,timeout:e}),withVariableButton:!1})})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Variable values for test",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:null==d?void 0:d.variablesForTest,onItemsChange:e=>c({...d,variablesForTest:e}),addLabel:"Add an entry",children:e=>(0,i.jsx)(lR,{...e})})})]})]})]})]})}),(null==r?void 0:r.url)&&(0,i.jsx)(A.$,{onClick:I,colorScheme:"orange",isLoading:x,children:"Test the request"}),g&&(0,i.jsx)(eh.B,{isReadOnly:!0,lang:"json",value:g}),(g||(null==d?void 0:d.responseVariableMapping)&&d.responseVariableMapping.length>0)&&(0,i.jsx)(eb.n,{allowMultiple:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Save in variables",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:null==d?void 0:d.responseVariableMapping,onItemsChange:e=>c({...d,responseVariableMapping:e}),addLabel:"Add an entry",children:e=>(0,i.jsx)(C,{...e})})})]})})]})},lD=e=>{var l;let{block:{id:n,options:t},onOptionsChange:o}=e,a=(0,m.useRef)(null),s=async e=>{o({...t,webhook:e})};return(0,i.jsxs)(Z.B,{spacing:0,children:[(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{placeholder:"Paste URL...",defaultValue:null==t||null==(l=t.webhook)?void 0:l.url,onChange:e=>{o({...t,webhook:{...null==t?void 0:t.webhook,url:e}})}}),(0,i.jsx)(lO,{blockId:n,httpRequest:null==t?void 0:t.webhook,options:t,onHttpRequestChange:s,onOptionsChange:o,onNewTestResponse:()=>{setTimeout(()=>{var e;null==(e=a.current)||e.scrollIntoView({behavior:"smooth",block:"end"})},100)}})]}),(0,i.jsx)("div",{ref:a})]})};var lL=n(38859),lP=n(70205),lN=n(88131);let lG=e=>{var l;let{block:{id:n,options:t},onOptionsChange:o}=e,a=(0,m.useRef)(null),s=async e=>{o({...t,webhook:e})},r=null==t||null==(l=t.webhook)?void 0:l.url;return(0,i.jsxs)(Z.B,{spacing:0,children:[(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(lL.F,{status:r?"success":"info",rounded:"md",children:[(0,i.jsx)(lP._,{}),r?(0,i.jsx)(i.Fragment,{children:"Your scenario is correctly configured \uD83D\uDE80"}):(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:"Head up to Make.com to configure this block:"}),(0,i.jsxs)(A.$,{as:lN.N,href:"https://www.make.com/en/integrations/typebot",isExternal:!0,colorScheme:"orange",children:[(0,i.jsx)(eI.E,{mr:"2",children:"Make.com"})," ",(0,i.jsx)(S.pT,{})]})]})]}),(0,i.jsx)(lO,{blockId:n,httpRequest:null==t?void 0:t.webhook,options:t,onHttpRequestChange:s,onOptionsChange:o,onNewTestResponse:()=>{setTimeout(()=>{var e;null==(e=a.current)||e.scrollIntoView({behavior:"smooth",block:"end"})},100)}})]}),(0,i.jsx)("div",{ref:a})]})};var lW=n(41227),lU=n(37191),lz=n(32263),lF=n(67039),lK=n(50427),l_=n(57470),lH=n(7959),lQ=n(86747),lY=n(31445),lJ=n(16932);let lZ=e=>{let{isOpen:l,onClose:n,onNewCredentials:t}=e,{workspace:o}=(0,eT.h)(),[a,s]=(0,m.useState)(""),[r,d]=(0,m.useState)(""),[u,c]=(0,m.useState)(!1),{mutate:p}=(0,lJ.n)(e7.id.credentials.createCredentials.mutationOptions({onMutate:()=>c(!0),onSettled:()=>c(!1),onError:e=>{(0,lu.o)({description:e.message})},onSuccess:e=>{e7.qQ.invalidateQueries({queryKey:e7.id.credentials.listCredentials.queryKey()}),t(e.credentialsId),n()}})),h=async e=>{e.preventDefault(),o&&p({scope:"workspace",workspaceId:o.id,credentials:{type:"openai",name:r,data:{apiKey:a}}})};return(0,i.jsxs)(lz.aF,{isOpen:l,onClose:n,size:"lg",children:[(0,i.jsx)(lF.m,{}),(0,i.jsxs)(lK.$,{children:[(0,i.jsx)(l_.r,{children:"Add OpenAI account"}),(0,i.jsx)(lH.s,{}),(0,i.jsxs)("form",{onSubmit:h,children:[(0,i.jsxs)(lQ.c,{as:Z.B,spacing:"6",children:[(0,i.jsx)(e_.k,{isRequired:!0,label:"Name",onChange:d,placeholder:"My account",withVariableButton:!1,debounceTimeout:0}),(0,i.jsx)(e_.k,{isRequired:!0,type:"password",label:"API key",helperText:(0,i.jsxs)(i.Fragment,{children:["You can generate an API key"," ",(0,i.jsx)(lU.Y,{href:"https://platform.openai.com/account/api-keys",isExternal:!0,children:"here"}),"."]}),onChange:s,placeholder:"sk-...",withVariableButton:!1,debounceTimeout:0}),(0,i.jsxs)(lL.F,{status:"warning",children:[(0,i.jsx)(lP._,{}),"Make sure to add a payment method to your OpenAI account. Otherwise, it will not work after a few messages."]})]}),(0,i.jsx)(lY.j,{children:(0,i.jsx)(A.$,{type:"submit",isLoading:u,isDisabled:""===a||""===r,colorScheme:"orange",children:"Create"})})]})]})]})},lX=e=>{let{baseUrl:l,apiVersion:n,defaultValue:t,onChange:o,credentialsId:a,type:s}=e,{workspace:r}=(0,eT.h)(),{data:d}=(0,e8.I)(e7.id.openAI.listModels.queryOptions({credentialsId:a,baseUrl:null!=l?l:lW.yL.baseUrl,workspaceId:null==r?void 0:r.id,apiVersion:n,type:s},{enabled:!!r}));return(0,i.jsx)(ey.l,{items:null==d?void 0:d.models,selectedItem:t,onSelect:o,placeholder:"Select a model"})},lq=e=>{let{options:l,onOptionsChange:n}=e;return(0,i.jsxs)(Z.B,{spacing:4,pt:"2",children:[(0,i.jsxs)(eI.E,{fontSize:"sm",color:"gray.500",children:["Read the"," ",(0,i.jsx)(lU.Y,{href:"https://platform.openai.com/docs/api-reference/audio/createSpeech",isExternal:!0,children:"API reference"})," ","to better understand the available options."]}),l.credentialsId&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(lX,{credentialsId:l.credentialsId,defaultValue:l.model,baseUrl:l.baseUrl,apiVersion:l.apiVersion,type:"tts",onChange:e=>{n({...l,model:e})}}),(0,i.jsx)(Q.TM,{defaultValue:l.input,onChange:e=>{n({...l,input:e})},label:"Input:"}),(0,i.jsxs)(X.MJ,{children:[(0,i.jsx)(q.l,{children:"Voice:"}),(0,i.jsx)(en.Q,{currentItem:l.voice,onItemSelect:e=>{n({...l,voice:e})},items:lW.kN,placeholder:"Select a voice",w:"full"})]}),(0,i.jsxs)(X.MJ,{children:[(0,i.jsx)(q.l,{children:"Save URL:"}),(0,i.jsx)(J.x,{initialVariableId:l.saveUrlInVariableId,onSelectVariable:e=>{n({...l,saveUrlInVariableId:null==e?void 0:e.id})}})]})]})]})},l$=[...lW.Qv,...lW.NO],l0=e=>{let{item:l,onItemChange:n}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(en.Q,{currentItem:l.role,items:l$.filter(e=>!lW.hW.includes(e)),onItemSelect:e=>{n({...l,role:e,content:void 0})},placeholder:"Select type"}),(0,i.jsx)(l1,{item:l,onChangeSingleMessageContent:e=>{"Messages sequence ✨"!==l.role&&"Dialogue"!==l.role&&n({...l,content:e})},onChangeDialogueVariableId:e=>{"Dialogue"===l.role&&n({...l,dialogueVariableId:null==e?void 0:e.id})},onStartsByChange:e=>{"Dialogue"===l.role&&n({...l,startsBy:e})}})]})},l1=e=>{let{onChangeSingleMessageContent:l,onChangeDialogueVariableId:n,onStartsByChange:t,item:o}=e;switch(o.role){case void 0:case"assistant":case"user":case"system":return(0,i.jsx)(Q.TM,{defaultValue:o.content,onChange:l,placeholder:"Content",minH:"150px"});case"Dialogue":var a;return(0,i.jsxs)(Z.B,{alignItems:"flex-end",children:[(0,i.jsx)(J.x,{initialVariableId:o.dialogueVariableId,onSelectVariable:n,placeholder:"Dialogue variable"}),(0,i.jsxs)(V.z,{children:[(0,i.jsx)(eI.E,{children:"starts by"}),(0,i.jsx)(en.Q,{size:"sm",currentItem:null!=(a=o.startsBy)?a:"user",onItemSelect:t,items:["user","assistant"]})]})]});case"Messages sequence ✨":return null}},l2=e=>{var l;let{item:n,onItemChange:t}=e;return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(en.Q,{currentItem:null!=(l=n.valueToExtract)?l:lW.cz.valueToExtract,items:lW.O2,onItemSelect:e=>{t({...n,valueToExtract:e})}}),(0,i.jsx)(J.x,{onSelectVariable:e=>{t({...n,variableId:e?e.id:void 0})},initialVariableId:n.variableId})]})},l4=e=>{var l;let{options:n,onOptionsChange:t}=e;return(0,i.jsxs)(Z.B,{spacing:4,pt:"2",children:[(0,i.jsxs)(eI.E,{fontSize:"sm",color:"gray.500",children:["Read the"," ",(0,i.jsx)(lU.Y,{href:"https://platform.openai.com/docs/api-reference/chat/create",isExternal:!0,children:"API reference"})," ","to better understand the available options."]}),n.credentialsId&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(lX,{credentialsId:n.credentialsId,defaultValue:n.model,baseUrl:n.baseUrl,apiVersion:n.apiVersion,type:"gpt",onChange:e=>{e&&t({...n,model:e})}}),(0,i.jsxs)(eb.n,{allowMultiple:!0,children:[(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Messages"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:n.messages,onItemsChange:e=>{t({...n,messages:e})},isOrdered:!0,hasDefaultItem:!0,addLabel:"Add message",children:e=>(0,i.jsx)(l0,{...e})})})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Advanced settings"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{children:(0,i.jsx)(Q.Q7,{label:"Temperature",placeholder:"1",max:2,min:0,step:.1,defaultValue:null==(l=n.advancedSettings)?void 0:l.temperature,onValueChange:e=>{t({...n,advancedSettings:{...n.advancedSettings,temperature:e}})}})})]}),(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Save answer"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:n.responseMapping,onItemsChange:e=>{t({...n,responseMapping:e})},newItemDefaultProps:{valueToExtract:"Message content"},hasDefaultItem:!0,children:e=>(0,i.jsx)(l2,{...e})})})]})]})]})]})},l3=e=>{var l;let{block:{options:n},onOptionsChange:t}=e,{workspace:o}=(0,eT.h)(),{isOpen:a,onOpen:s,onClose:r}=(0,eV.j)(),d=e=>{t({...n,credentialsId:e})},u=null!=(l=null==n?void 0:n.baseUrl)?l:lW.yL.baseUrl;return(0,i.jsxs)(Z.B,{children:[o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eS.s,{type:"openai",scope:{type:"workspace",workspaceId:o.id},currentCredentialsId:null==n?void 0:n.credentialsId,onCredentialsSelect:d,onCreateNewClick:s,credentialsName:"OpenAI account"}),(0,i.jsx)(lZ,{isOpen:a,onClose:r,onNewCredentials:d})]}),(null==n?void 0:n.credentialsId)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{children:[(0,i.jsx)(eI.E,{w:"full",textAlign:"left",children:"Customize provider"}),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{as:Z.B,spacing:4,children:[(0,i.jsx)(Q.ks,{label:"Base URL",defaultValue:u,onChange:e=>{t({...n,baseUrl:e})}}),u!==lW.yL.baseUrl&&(0,i.jsx)(Q.ks,{label:"API version",defaultValue:n.apiVersion,onChange:e=>{t({...n,apiVersion:e})}})]})]})}),(0,i.jsx)(en.Q,{currentItem:n.task,items:lW.PG.slice(0,-1),onItemSelect:e=>{t({credentialsId:null==n?void 0:n.credentialsId,task:e})},placeholder:"Select task"}),n.task&&(0,i.jsx)(l5,{options:n,onOptionsChange:t})]})]})},l5=e=>{let{options:l,onOptionsChange:n}=e;switch(l.task){case"Create chat completion":return(0,i.jsx)(l4,{options:l,onOptionsChange:n});case"Create speech":return(0,i.jsx)(lq,{options:l,onOptionsChange:n});case"Create image":return null}},l9=e=>{var l;let{block:{id:n,options:t},onOptionsChange:o}=e,a=(0,m.useRef)(null),s=async e=>{o({...t,webhook:e})},r=null==t||null==(l=t.webhook)?void 0:l.url;return(0,i.jsxs)(Z.B,{spacing:0,children:[(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(lL.F,{status:r?"success":"info",rounded:"md",children:[(0,i.jsx)(lP._,{}),r?(0,i.jsx)(i.Fragment,{children:"Your scenario is correctly configured \uD83D\uDE80"}):(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:"Head up to Pabbly Connect to get the webhook URL:"}),(0,i.jsxs)(A.$,{as:lN.N,href:"https://www.pabbly.com/connect/integrations/typebot/",isExternal:!0,colorScheme:"orange",children:[(0,i.jsx)(eI.E,{mr:"2",children:"Pabbly.com"})," ",(0,i.jsx)(S.pT,{})]})]})]}),(0,i.jsx)(Q.ks,{placeholder:"Paste webhook URL...",defaultValue:null!=r?r:"",onChange:e=>{o({...t,webhook:{...null==t?void 0:t.webhook,url:e}})},withVariableButton:!1,debounceTimeout:0}),(0,i.jsx)(lO,{blockId:n,httpRequest:null==t?void 0:t.webhook,options:t,onHttpRequestChange:s,onOptionsChange:o,onNewTestResponse:()=>{setTimeout(()=>{var e;null==(e=a.current)||e.scrollIntoView({behavior:"smooth",block:"end"})},100)}})]}),(0,i.jsx)("div",{ref:a})]})};var l6=n(22115);let l7=e=>{var l,n,t,o;let{options:a,onOptionsChange:s}=e;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{defaultValue:null!=(l=null==a?void 0:a.pixelId)?l:"",onChange:e=>s({...a,pixelId:(0,e0.Im)(e)?void 0:e}),withVariableButton:!1,placeholder:'Pixel ID (e.g. "123456789")'}),(0,i.jsx)(Y.R,{label:"Skip initialization",moreInfoContent:"Check this if the bot is embedded in your website and the pixel is already initialized.",initialValue:null!=(n=null==a?void 0:a.isInitSkip)?n:l6.IN.isInitSkip,onCheckChange:e=>s({...a,isInitSkip:e})}),(0,i.jsxs)(H.J,{label:"Track event",initialValue:(0,e0.O9)(null==a?void 0:a.params),onCheckChange:e=>s({...a,params:!e||(null==a?void 0:a.params)?void 0:[]}),children:[(0,i.jsxs)(eI.E,{fontSize:"sm",color:"gray.500",children:["Read the"," ",(0,i.jsx)(lU.Y,{href:"https://developers.facebook.com/docs/meta-pixel/reference#standard-events",isExternal:!0,children:"reference"})," ","to better understand the available options."]}),(0,i.jsx)(ey.l,{items:["Custom",...l6.qn],selectedItem:null==a?void 0:a.eventType,placeholder:"Select event type",onSelect:(e,l)=>s({...a,params:[],eventType:l})}),(null==a?void 0:a.eventType)==="Custom"&&(0,i.jsx)(Q.ks,{defaultValue:null!=(t=a.name)?t:"",onChange:e=>{(null==a?void 0:a.eventType)==="Custom"&&s({...a,name:(0,e0.Im)(e)?void 0:e})},placeholder:"Event name"}),(null==a?void 0:a.eventType)&&("Custom"===a.eventType||l6.$r.filter(e=>e.associatedEvents.includes(a.eventType)).length>0)&&(0,i.jsx)(et.B,{initialItems:null!=(o=null==a?void 0:a.params)?o:[],onItemsChange:e=>s({...a,params:e}),addLabel:"Add parameter",children:e=>(0,i.jsx)(l8,{...e,eventType:null==a?void 0:a.eventType})})]})]})},l8=e=>{let{item:l,eventType:n,onItemChange:t}=e,o=n&&"Custom"!==n?l6.$r.filter(e=>e.associatedEvents.includes(n)):[],a=o.find(e=>e.key===l.key),s=e=>t({...l,key:e}),r=e=>t({...l,value:e});return n?(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:["Custom"===n?(0,i.jsx)(Q.ks,{defaultValue:l.key,onChange:s,placeholder:"Key"}):(0,i.jsx)(en.Q,{currentItem:l.key,items:o.map(e=>e.key),onItemSelect:s,placeholder:"Select key"}),(null==a?void 0:a.type)==="code"?(0,i.jsx)(eh.B,{lang:"javascript",defaultValue:l.value,onChange:r}):(0,i.jsx)(Q.ks,{defaultValue:l.value,onChange:r,placeholder:"Value"})]}):null};var ne=n(90218),nl=n(26430);let nn={credentialsId:"default",isCustomBody:!1,isBodyCode:!1};var nt=n(27875);let ni=e=>{var l,n,t,o,a,s,r,u,c,p,h,b;let{options:x,onOptionsChange:v}=e,{workspace:m}=(0,eT.h)(),{isOpen:g,onOpen:j,onClose:f}=(0,eV.j)(),y=e=>{v({...x,credentialsId:void 0===e?"default":e})},I=e=>v({...x,body:e});return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:"From: "}),m&&(0,i.jsx)(eS.s,{type:"smtp",scope:{type:"workspace",workspaceId:m.id},currentCredentialsId:no({workspace:m,credentialsId:null==x?void 0:x.credentialsId}),onCredentialsSelect:y,onCreateNewClick:j,defaultCredentialLabel:(0,ne._)(m)||null==(n=le._.NEXT_PUBLIC_SMTP_FROM)||null==(l=n.match(/<(.*)>/))?void 0:l.pop(),credentialsName:"SMTP account"})]}),(0,i.jsx)(Q.ks,{label:"To:",onChange:e=>{let l=e.split(",").map(e=>e.trim()).filter(e0.hj);v({...x,recipients:l})},defaultValue:null==x||null==(t=x.recipients)?void 0:t.join(", "),placeholder:"email1@gmail.com, email2@gmail.com"}),(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsx)(ev.J,{children:(0,i.jsxs)(V.z,{justifyContent:"space-between",w:"full",children:[(0,i.jsx)(eI.E,{children:"Advanced"}),(0,i.jsx)(em.Q,{})]})}),(0,i.jsxs)(eg.v,{as:Z.B,children:[(0,i.jsx)(Q.ks,{label:"Reply to:",onChange:e=>v({...x,replyTo:e}),defaultValue:null==x?void 0:x.replyTo,placeholder:"email@gmail.com"}),(0,i.jsx)(Q.ks,{label:"Cc:",onChange:e=>{let l=e.split(",").map(e=>e.trim()).filter(e0.hj);v({...x,cc:l})},defaultValue:null!=(s=null==x||null==(o=x.cc)?void 0:o.join(", "))?s:"",placeholder:"email1@gmail.com, email2@gmail.com"}),(0,i.jsx)(Q.ks,{label:"Bcc:",onChange:e=>{let l=e.split(",").map(e=>e.trim()).filter(e0.hj);v({...x,bcc:l})},defaultValue:null!=(r=null==x||null==(a=x.bcc)?void 0:a.join(", "))?r:"",placeholder:"email1@gmail.com, email2@gmail.com"})]})]})}),(0,i.jsx)(Q.ks,{label:"Subject:",onChange:e=>v({...x,subject:e}),defaultValue:null!=(u=null==x?void 0:x.subject)?u:""}),(0,i.jsx)(Y.R,{label:"Custom content",moreInfoContent:"By default, the email body will be a recap of what has been collected so far. You can override it with this option.",initialValue:null!=(c=null==x?void 0:x.isCustomBody)?c:nn.isCustomBody,onCheckChange:e=>v({...x,isCustomBody:e})}),(null==x?void 0:x.isCustomBody)&&(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(d.s,{justifyContent:"space-between",children:[(0,i.jsx)(eI.E,{children:"Content: "}),(0,i.jsxs)(V.z,{children:[(0,i.jsx)(eI.E,{fontSize:"sm",children:"Text"}),(0,i.jsx)(nl.d,{size:"sm",isChecked:null!=(p=x.isBodyCode)?p:nn.isBodyCode,onChange:()=>v({...x,isBodyCode:null==x||!x.isBodyCode||!x.isBodyCode})}),(0,i.jsx)(eI.E,{fontSize:"sm",children:"Code"})]})]}),x.isBodyCode?(0,i.jsx)(eh.B,{defaultValue:null!=(h=x.body)?h:"",onChange:I,lang:"html",withLineNumbers:!0}):(0,i.jsx)(Q.TM,{"data-testid":"body-input",minH:"300px",onChange:I,defaultValue:null!=(b=x.body)?b:""}),(0,i.jsxs)(Z.B,{pb:"4",children:[(0,i.jsxs)(V.z,{children:[(0,i.jsx)(q.l,{m:"0",htmlFor:"variable",children:"Attach files:"}),(0,i.jsx)(_.t,{children:"The selected variable should have previously collected files from the File upload input block."})]}),(0,i.jsx)(J.x,{initialVariableId:null==x?void 0:x.attachmentsVariableId,onSelectVariable:e=>v({...x,attachmentsVariableId:null==e?void 0:e.id})})]})]}),(0,i.jsx)(nt.o,{isOpen:g,onClose:f,onNewCredentials:y})]})},no=e=>{let{workspace:l,credentialsId:n}=e;return n||((0,ne._)(l)?void 0:nn.credentialsId)},na=e=>{var l;let{block:{id:n,options:t},onOptionsChange:o}=e,a=(0,m.useRef)(null),s=async e=>{o({...t,webhook:e})},r=null==t||null==(l=t.webhook)?void 0:l.url;return(0,i.jsxs)(Z.B,{spacing:0,children:[(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(lL.F,{status:r?"success":"info",rounded:"md",children:[(0,i.jsx)(lP._,{}),r?(0,i.jsx)(i.Fragment,{children:"Your zap is correctly configured \uD83D\uDE80"}):(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:"Head up to Zapier to configure this block:"}),(0,i.jsxs)(A.$,{as:lN.N,href:"https://zapier.com/apps/typebot/integrations",isExternal:!0,colorScheme:"orange",children:[(0,i.jsx)(eI.E,{mr:"2",children:"Zapier"})," ",(0,i.jsx)(S.pT,{})]})]})]}),(0,i.jsx)(lO,{blockId:n,httpRequest:null==t?void 0:t.webhook,options:t,onHttpRequestChange:s,onOptionsChange:o,onNewTestResponse:()=>{setTimeout(()=>{var e;null==(e=a.current)||e.scrollIntoView({behavior:"smooth",block:"end"})},100)}})]}),(0,i.jsx)("div",{ref:a})]})},ns={aPercent:50},nr=e=>{var l;let{options:n,onOptionsChange:t}=e;return(0,i.jsx)(Z.B,{spacing:4,children:(0,i.jsx)(Q.Q7,{defaultValue:null!=(l=null==n?void 0:n.aPercent)?l:ns.aPercent,onValueChange:e=>(0,e0.O9)(e)?t({...n,aPercent:e}):null,withVariableButton:!1,label:"Percent of users to follow A:",direction:"column",max:100,min:0})})};var nd=n(9533),nu=n(38184),nc=n(13880),np=n(87458),nh=n(11497),nb=n(75106),nx=n(77569),nv=n(28811),nm=n(46897),ng=n(84271),nj=n(6162);let nf=e=>{let{items:l,defaultValue:n,placeholder:t,label:o,helperText:a,moreInfoTooltip:s,isRequired:r,onChange:d}=e,u=(0,m.useRef)(null),{value:c,setValue:p,replaceDefaultValue:h,isTouched:b}=(0,nh.I)({ref:u}),x=(0,nc.p)({items:l,filterQuery:c,isInputTouched:b}),v=(0,np.d)(e=>{let l=x.items.find(l=>(0,nm.I)(l)===e);d(l?(0,nm.Z)(l):e)});return(0,m.useEffect)(()=>{if(!n||b||!l||(null==l?void 0:l.length)===0)return;let e=l.find(e=>(0,nm.Z)(e)===n);h(e?(0,nm.I)(e):n)},[n,null==l?void 0:l.length,b]),(0,i.jsxs)(nj.D.Root,{required:r,className:"flex flex-col gap-1",children:[(0,i.jsxs)(ng.G.Root,{placeholder:t,collection:x,className:(0,nv.cx)("flex justify-between flex-col gap-2"),onInputValueChange:e=>{p(e.inputValue),v(e.inputValue)},onSelect:e=>{d((0,nm.Z)(e.itemValue))},inputValue:c,allowCustomValue:!0,children:[o&&(0,i.jsxs)(ng.G.Label,{children:[o," ",s&&(0,i.jsx)(_.t,{children:s})]}),(0,i.jsxs)("div",{className:"flex items-center w-full",children:[(0,i.jsx)(ng.G.Control,{children:(0,i.jsx)(ng.G.Input,{})}),(0,i.jsx)(lk.e,{onSelectVariable:e=>{p("{{".concat(e.name,"}}")),d("{{".concat(e.name,"}}"))}})]}),(0,i.jsx)(nb.Z,{children:(0,i.jsx)(ng.G.Positioner,{className:"ark-positioner-z-10",children:x.size>0&&(x.size>1||(0,nm.I)(x.items[0])!==c)&&(0,i.jsx)(ng.G.Content,{className:nx.ow,children:x.items.map(e=>(0,i.jsx)(ng.G.Item,{item:e,className:nx.up,children:(0,nm.I)(e)},(0,nm.Z)(e)))})})})]}),a&&(0,i.jsx)(nj.D.HelperText,{children:a})]})},ny=e=>{let{groups:l,groupId:n,onChange:t,isLoading:o}=e;return o?(0,i.jsx)(la.p,{value:"Loading...",isDisabled:!0}):l&&0!==l.length?(0,i.jsx)(nf,{items:l.map(e=>({label:e.title,value:e.id})),defaultValue:n,onChange:t,placeholder:"Select a group"}):(0,i.jsx)(la.p,{value:"No groups found",isDisabled:!0})},nI=e=>{let{options:l,onOptionsChange:n}=e,{typebot:t}=(0,a.V)(),o=(0,m.useMemo)(()=>{if(!(!(null==l?void 0:l.groupId)||(0,nu.J)(null==l?void 0:l.groupId)))return null==t?void 0:t.groups.find((0,e0.$H)(null==l?void 0:l.groupId))},[null==l?void 0:l.groupId,null==t?void 0:t.groups]);return t?(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(ny,{groups:t.groups,groupId:null==l?void 0:l.groupId,onChange:e=>n({...l,groupId:e})}),o&&(o.blocks.length>1||(null==l?void 0:l.blockId))&&(0,i.jsx)(ey.l,{selectedItem:null==l?void 0:l.blockId,items:o.blocks.map((e,l)=>({label:"Block #".concat((l+1).toString()),value:e.id,icon:(0,i.jsx)(nd.t,{type:e.type})})),onSelect:e=>n({...l,blockId:e}),placeholder:"Select a block"})]}):null},nC={isNewTab:!1},nk=e=>{var l;let{options:n,onOptionsChange:t}=e;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:"Url:",defaultValue:null==n?void 0:n.url,placeholder:"Type a URL...",onChange:e=>t({...n,url:e})}),(0,i.jsx)(Y.R,{label:"Open in new tab",initialValue:null!=(l=null==n?void 0:n.isNewTab)?l:nC.isNewTab,onCheckChange:e=>t({...n,isNewTab:e})})]})},nE={name:"Script",isExecutedOnClient:!0},nw=e=>{var l,n;let{options:t,onOptionsChange:o}=e;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:"Name:",defaultValue:null!=(l=null==t?void 0:t.name)?l:nE.name,onChange:e=>o({...t,name:e}),withVariableButton:!1}),(0,i.jsx)(Y.R,{label:"Execute on client",moreInfoContent:"Check this if you need access to client variables like `window` or `document`.",initialValue:null!=(n=null==t?void 0:t.isExecutedOnClient)?n:nE.isExecutedOnClient,onCheckChange:e=>o({...t,isExecutedOnClient:e})}),(0,i.jsx)(eh.B,{defaultValue:null==t?void 0:t.content,lang:"javascript",onChange:e=>o({...t,content:e}),withLineNumbers:!0})]})};var nS=n(92812),nT=n(71426),nV=n(49942),nM=n(27474);let nA=[{label:"(GMT-11:00) Midway Island, Samoa",value:"Pacific/Midway"},{label:"(GMT-10:00) Hawaii",value:"Pacific/Honolulu"},{label:"(GMT-09:00) Alaska",value:"America/Juneau"},{label:"(GMT-08:00) Tijuana",value:"America/Tijuana"},{label:"(GMT-08:00) Pacific Time",value:"America/Los_Angeles"},{label:"(GMT-07:00) Mountain Time",value:"America/Boise"},{label:"(GMT-07:00) Dawson, Yukon",value:"America/Dawson"},{label:"(GMT-07:00) Chihuahua, La Paz, Mazatlan",value:"America/Chihuahua"},{label:"(GMT-07:00) Arizona",value:"America/Phoenix"},{label:"(GMT-06:00) Central Time",value:"America/Chicago"},{label:"(GMT-06:00) Saskatchewan",value:"America/Regina"},{label:"(GMT-06:00) Guadalajara, Mexico City, Monterrey",value:"America/Mexico_City"},{label:"(GMT-06:00) Central America",value:"America/Belize"},{label:"(GMT-05:00) Eastern Time",value:"America/Detroit"},{label:"(GMT-05:00) Bogota, Lima, Quito",value:"America/Bogota"},{label:"(GMT-04:00) Caracas, La Paz",value:"America/Caracas"},{label:"(GMT-04:00) Santiago",value:"America/Santiago"},{label:"(GMT-03:30) Newfoundland and Labrador",value:"America/St_Johns"},{label:"(GMT-03:00) Brasilia",value:"America/Sao_Paulo"},{label:"(GMT-03:00) Montevideo",value:"America/Montevideo"},{label:"(GMT-03:00) Buenos Aires, Georgetown",value:"America/Argentina/Buenos_Aires"},{label:"(GMT-03:00) Greenland",value:"America/Godthab"},{label:"(GMT-01:00) Azores",value:"Atlantic/Azores"},{label:"(GMT-01:00) Cape Verde Islands",value:"Atlantic/Cape_Verde"},{label:"(GMT+00:00) UTC",value:"GMT"},{label:"(GMT+00:00) Edinburgh, London",value:"Europe/London"},{label:"(GMT+00:00) Dublin",value:"Europe/Dublin"},{label:"(GMT+00:00) Lisbon",value:"Europe/Lisbon"},{label:"(GMT+00:00) Casablanca, Monrovia",value:"Africa/Casablanca"},{label:"(GMT+00:00) Canary Islands",value:"Atlantic/Canary"},{label:"(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague",value:"Europe/Belgrade"},{label:"(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb",value:"Europe/Sarajevo"},{label:"(GMT+01:00) Brussels, Copenhagen, Madrid, Paris",value:"Europe/Brussels"},{label:"(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna",value:"Europe/Amsterdam"},{label:"(GMT+01:00) West Central Africa",value:"Africa/Algiers"},{label:"(GMT+02:00) Bucharest",value:"Europe/Bucharest"},{label:"(GMT+02:00) Cairo",value:"Africa/Cairo"},{label:"(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius",value:"Europe/Helsinki"},{label:"(GMT+02:00) Athens",value:"Europe/Athens"},{label:"(GMT+02:00) Jerusalem",value:"Asia/Jerusalem"},{label:"(GMT+02:00) Harare, Pretoria",value:"Africa/Harare"},{label:"(GMT+03:00) Istanbul, Minsk, Moscow, St. Petersburg, Volgograd",value:"Europe/Moscow"},{label:"(GMT+03:00) Kuwait, Riyadh",value:"Asia/Kuwait"},{label:"(GMT+03:00) Nairobi",value:"Africa/Nairobi"},{label:"(GMT+03:00) Baghdad",value:"Asia/Baghdad"},{label:"(GMT+03:30) Tehran",value:"Asia/Tehran"},{label:"(GMT+04:00) Abu Dhabi, Muscat",value:"Asia/Dubai"},{label:"(GMT+04:00) Baku, Tbilisi, Yerevan",value:"Asia/Baku"},{label:"(GMT+04:30) Kabul",value:"Asia/Kabul"},{label:"(GMT+05:00) Ekaterinburg",value:"Asia/Yekaterinburg"},{label:"(GMT+05:00) Islamabad, Karachi, Tashkent",value:"Asia/Karachi"},{label:"(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi",value:"Asia/Kolkata"},{label:"(GMT+05:30) Sri Jayawardenepura",value:"Asia/Colombo"},{label:"(GMT+05:45) Kathmandu",value:"Asia/Kathmandu"},{label:"(GMT+06:00) Astana, Dhaka",value:"Asia/Dhaka"},{label:"(GMT+06:00) Almaty, Novosibirsk",value:"Asia/Almaty"},{label:"(GMT+06:30) Yangon Rangoon",value:"Asia/Rangoon"},{label:"(GMT+07:00) Bangkok, Hanoi, Jakarta",value:"Asia/Bangkok"},{label:"(GMT+07:00) Krasnoyarsk",value:"Asia/Krasnoyarsk"},{label:"(GMT+08:00) Beijing, Chongqing, Hong Kong SAR, Urumqi",value:"Asia/Shanghai"},{label:"(GMT+08:00) Kuala Lumpur, Singapore",value:"Asia/Kuala_Lumpur"},{label:"(GMT+08:00) Taipei",value:"Asia/Taipei"},{label:"(GMT+08:00) Perth",value:"Australia/Perth"},{label:"(GMT+08:00) Irkutsk, Ulaanbaatar",value:"Asia/Irkutsk"},{label:"(GMT+09:00) Seoul",value:"Asia/Seoul"},{label:"(GMT+09:00) Osaka, Sapporo, Tokyo",value:"Asia/Tokyo"},{label:"(GMT+09:00) Yakutsk",value:"Asia/Yakutsk"},{label:"(GMT+09:30) Darwin",value:"Australia/Darwin"},{label:"(GMT+09:30) Adelaide",value:"Australia/Adelaide"},{label:"(GMT+10:00) Canberra, Melbourne, Sydney",value:"Australia/Sydney"},{label:"(GMT+10:00) Brisbane",value:"Australia/Brisbane"},{label:"(GMT+10:00) Hobart",value:"Australia/Hobart"},{label:"(GMT+10:00) Vladivostok",value:"Asia/Vladivostok"},{label:"(GMT+10:00) Guam, Port Moresby",value:"Pacific/Guam"},{label:"(GMT+11:00) Magadan, Solomon Islands, New Caledonia",value:"Asia/Magadan"},{label:"(GMT+12:00) Kamchatka, Marshall Islands",value:"Asia/Kamchatka"},{label:"(GMT+12:00) Fiji Islands",value:"Pacific/Fiji"},{label:"(GMT+13:00) Auckland, Wellington",value:"Pacific/Auckland"},{label:"(GMT+13:00) Nuku'alofa",value:"Pacific/Tongatapu"}],nB=nM.ZD.filter(e=>!nM.Sr.includes(e)),nR=e=>{var l;let{options:n,onOptionsChange:t}=e,{typebot:o,updateVariable:s}=(0,a.V)(),r=null==o?void 0:o.variables.find(e=>e.id===(null==n?void 0:n.variableId)),d=(null==n?void 0:n.type)&&nM.F5.includes(n.type),u=(null==n?void 0:n.variableId)&&(null==o?void 0:o.groups.some(e=>e.blocks.some(e=>{var l;return(0,b.Ke)(e)&&(null==(l=e.options)?void 0:l.variableId)===n.variableId})));return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable-search",children:"Search or create variable:"}),(0,i.jsx)(J.x,{onSelectVariable:e=>t({...n,variableId:null==e?void 0:e.id}),initialVariableId:null==n?void 0:n.variableId,id:"variable-search"})]}),(0,i.jsxs)(Z.B,{spacing:"4",children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{mb:"0",fontWeight:"medium",children:"Value:"}),(0,i.jsx)(ey.l,{selectedItem:null!=(l=null==n?void 0:n.type)?l:nM.gD.type,items:nB.map(e=>({label:e,value:e,icon:nM.wi.includes(e)?(0,i.jsx)(nT.k,{}):void 0})),onSelect:e=>t({...n,type:e})})]}),r&&!d&&!u&&(0,i.jsx)(Y.R,{label:"Save in results",moreInfoContent:"By default, the variable is saved only for the user chat session. Check this option if you want to also store the variable in the typebot Results table.",initialValue:!r.isSessionVariable,onCheckChange:e=>{(null==r?void 0:r.id)&&s(r.id,{isSessionVariable:!e})}},r.id),(0,i.jsx)(nO,{options:n,onOptionsChange:t})]})]})},nO=e=>{var l,n,t,o,a,s,r;let{options:d,onOptionsChange:u}=e,c=e=>u({...d,type:(0,e0.O9)(null==d?void 0:d.type)?"Custom":void 0,expressionToEvaluate:e});switch(null==d?void 0:d.type){case"Custom":case void 0:return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Y.R,{label:"Execute on client",moreInfoContent:"Check this if you need access to client-only variables like `window` or `document`.",initialValue:null!=(l=null==d?void 0:d.isExecutedOnClient)?l:nM.gD.isExecutedOnClient,onCheckChange:e=>u({...d,isExecutedOnClient:e})}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(nS.h,{size:"sm",options:["Text","Code"],defaultValue:(null!=(n=null==d?void 0:d.isCode)?n:nM.gD.isCode)?"Code":"Text",onSelect:e=>{null!=d&&d.type&&"Custom"!==d.type||u({...d,expressionDescription:"Code"!==e||null==d?void 0:d.expressionDescription,isCode:"Code"===e})}}),(null==d?void 0:d.isCode)?(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(Q.ks,{placeholder:"Code description",defaultValue:null==d?void 0:d.expressionDescription,onChange:e=>{null!=d&&d.type&&"Custom"!==d.type||u({...d,expressionDescription:e})},withVariableButton:!1}),(0,i.jsx)(eh.B,{defaultValue:null!=(t=null==d?void 0:d.expressionToEvaluate)?t:"",onChange:c,lang:"javascript",withLineNumbers:!0}),(0,i.jsx)(J.x,{label:"Save error",initialVariableId:d.saveErrorInVariableId,onSelectVariable:e=>{null!=d&&d.type&&"Custom"!==d.type||u({...d,saveErrorInVariableId:null==e?void 0:e.id})}})]}):(0,i.jsx)(Q.TM,{defaultValue:null!=(o=null==d?void 0:d.expressionToEvaluate)?o:"",onChange:c,width:"full"})]})]});case"Pop":case"Shift":return(0,i.jsx)(J.x,{initialVariableId:d.saveItemInVariableId,onSelectVariable:e=>{d&&("Pop"===d.type||"Shift"===d.type)&&u({...d,saveItemInVariableId:null==e?void 0:e.id})},placeholder:"Shift"===d.type?"Shifted item":"Popped item"});case"Map item with same index":return(0,i.jsxs)(Z.B,{p:"2",rounded:"md",borderWidth:1,children:[(0,i.jsx)(J.x,{initialVariableId:null==(a=d.mapListItemParams)?void 0:a.baseItemVariableId,onSelectVariable:e=>{d&&"Map item with same index"===d.type&&u({...d,mapListItemParams:{...d.mapListItemParams,baseItemVariableId:null==e?void 0:e.id}})},placeholder:"Base item"}),(0,i.jsx)(J.x,{initialVariableId:null==(s=d.mapListItemParams)?void 0:s.baseListVariableId,onSelectVariable:e=>{d&&"Map item with same index"===d.type&&u({...d,mapListItemParams:{...d.mapListItemParams,baseListVariableId:null==e?void 0:e.id}})},placeholder:"Base list"}),(0,i.jsx)(J.x,{initialVariableId:null==(r=d.mapListItemParams)?void 0:r.targetListVariableId,onSelectVariable:e=>{d&&"Map item with same index"===d.type&&u({...d,mapListItemParams:{...d.mapListItemParams,targetListVariableId:null==e?void 0:e.id}})},placeholder:"Target list"})]});case"Append value(s)":return(0,i.jsx)(Q.TM,{defaultValue:d.item,onChange:e=>{d&&"Append value(s)"===d.type&&u({...d,item:e})}});case"Moment of the day":return(0,i.jsxs)(lL.F,{fontSize:"sm",children:[(0,i.jsx)(lP._,{}),(0,i.jsxs)(eI.E,{children:["Will return either ",(0,i.jsx)(nV.vw,{size:"sm",children:"morning"}),","," ",(0,i.jsx)(nV.vw,{size:"sm",children:"afternoon"}),",",(0,i.jsx)(nV.vw,{size:"sm",children:"evening"})," or"," ",(0,i.jsx)(nV.vw,{size:"sm",children:"night"})," based on the current user time."]})]});case"Environment name":return(0,i.jsxs)(lL.F,{fontSize:"sm",children:[(0,i.jsx)(lP._,{}),(0,i.jsxs)(eI.E,{children:["Will return either ",(0,i.jsx)(nV.vw,{size:"sm",children:"web"})," or"," ",(0,i.jsx)(nV.vw,{size:"sm",children:"whatsapp"}),"."]})]});case"Device type":return(0,i.jsxs)(lL.F,{fontSize:"sm",children:[(0,i.jsx)(lP._,{}),(0,i.jsxs)(eI.E,{children:["Will return either ",(0,i.jsx)(nV.vw,{size:"sm",children:"desktop"}),","," ",(0,i.jsx)(nV.vw,{size:"sm",children:"tablet"})," or ",(0,i.jsx)(nV.vw,{size:"sm",children:"mobile"}),"."]})]});case"Now":case"Yesterday":case"Tomorrow":return(0,i.jsx)(ey.l,{items:nA,onSelect:e=>u({...d,timeZone:e}),placeholder:"Select time zone",selectedItem:null==d?void 0:d.timeZone});case"Contact name":case"Phone number":case"Random ID":case"User ID":case"Today":case"Result ID":case"Empty":case"Transcript":case"Referral Click ID":case"Referral Source ID":return null}},nD={mergeResults:!1};var nL=n(48077),nP=n(25942),nN=n(82203),nG=n.n(nN),nW=n(81278);let nU=e=>{var l,n,t,o,a;let{idsToExclude:s,typebotId:r,onSelect:d,currentWorkspaceId:u}=e,{query:c}=(0,nW.useRouter)(),{typebots:p,isLoading:h}=(0,nP.U)({workspaceId:u});return h?(0,i.jsx)(la.p,{value:"Loading...",isDisabled:!0}):p&&0!==p.length?(0,i.jsxs)(V.z,{children:[(0,i.jsx)(ey.l,{selectedItem:r,items:[{label:"Current typebot",value:"current"},...(null!=p?p:[]).filter(e=>!s.includes(e.id)).map(e=>({icon:(0,i.jsx)(nL.e,{icon:e.icon,boxSize:"18px",emojiFontSize:"18px"}),label:e.name,value:e.id}))],onSelect:d,placeholder:"Select a typebot"}),r&&"current"!==r&&(0,i.jsx)(B.K,{"aria-label":"Navigate to typebot",icon:(0,i.jsx)(S.pT,{}),as:nG(),href:{pathname:"/typebots/[typebotId]/edit",query:{typebotId:r,parentId:c.parentId?Array.isArray(c.parentId)?c.parentId.concat(null!=(t=null==(l=c.typebotId)?void 0:l.toString())?t:""):[c.parentId,null!=(o=null==(n=c.typebotId)?void 0:n.toString())?o:""]:null!=(a=c.typebotId)?a:[]}}})]}):(0,i.jsx)(la.p,{value:"No typebots found",isDisabled:!0})},nz=e=>{var l,n,t;let{options:o,onOptionsChange:s}=e,{typebot:r}=(0,a.V)(),d=async e=>s({...o,typebotId:e,groupId:void 0}),{data:u}=(0,e8.I)(e7.id.typebot.getTypebot.queryOptions({typebotId:null==o?void 0:o.typebotId},{enabled:(0,e0.hj)(null==o?void 0:o.typebotId)&&(null==o?void 0:o.typebotId)!=="current"})),c=r&&(null==o?void 0:o.typebotId)===r.id||(null==o?void 0:o.typebotId)==="current";return(0,i.jsxs)(Z.B,{children:[r&&(0,i.jsx)(nU,{idsToExclude:[r.id],typebotId:null==o?void 0:o.typebotId,onSelect:d,currentWorkspaceId:r.workspaceId}),(null==o?void 0:o.typebotId)&&(0,i.jsx)(ny,{groups:r&&c?r.groups:null!=(n=null==u||null==(l=u.typebot)?void 0:l.groups)?n:[],groupId:o.groupId,onChange:e=>s({...o,groupId:e}),isLoading:(null==u?void 0:u.typebot)===void 0&&"current"!==o.typebotId&&r&&r.id!==o.typebotId},o.typebotId),!c&&(0,i.jsx)(Y.R,{label:"Merge answers",moreInfoContent:"If enabled, the answers collected in the linked typebot will be merged with the results of the current typebot.",initialValue:null!=(t=null==o?void 0:o.mergeResults)?t:nD.mergeResults,onCheckChange:e=>s({...o,mergeResults:e})})]})},nF={shouldPause:!1},nK=e=>{var l;let{options:n,onOptionsChange:t}=e;return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(Q.ks,{label:"Seconds to wait for:",defaultValue:null==n?void 0:n.secondsToWaitFor,onChange:e=>{t({...n,secondsToWaitFor:e})}}),(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Advanced",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{py:"4",children:(0,i.jsx)(Y.R,{label:"Pause the flow",moreInfoContent:"When enabled, the flow is paused until the client sends another message. This is automatic on the web bot.",initialValue:null!=(l=null==n?void 0:n.shouldPause)?l:nF.shouldPause,onCheckChange:e=>{t({...n,shouldPause:e})}})})]})})]})};var n_=n(81485),nH=n(27318),nQ=n(39737),nY=n(46186),nJ=n(8477),nZ=n(42791),nX=n(91767),nq=n(10497),n$=n(24586),n0=n(95373),n1=n(47342);let n2=e=>{let{blockId:l,options:n,onOptionsChange:t}=e,{typebot:o,save:r}=(0,a.V)(),{user:d}=(0,s.J)(),[u,c]=(0,m.useState)(),[p,h]=(0,m.useState)("closed"),[b,x]=(0,m.useState)(),v=(0,n1.Ay)({host:le._.NEXT_PUBLIC_PARTYKIT_HOST,room:"".concat(null==d?void 0:d.id,"/").concat(null==o?void 0:o.id,"/webhooks"),async onMessage(e){try{let l=JSON.parse(e.data);Object.keys(l).length>0&&(c(JSON.stringify(l,null,2)),x(lp(l))),h("closed"),v.close()}catch(e){(0,lu.o)(await (0,n0.A)({err:e}))}},async onError(e){console.error(e),console.log((await (0,n0.A)({err:e})).details),n$.Cp(e)},startClosed:!0}),g=async()=>{await r(),v.reconnect(),c(void 0),x(void 0),h("opened")},j=(0,m.useMemo)(()=>function(e){return(0,i.jsx)(lB,{...e,dataItems:null!=b?b:[]})},[b]),f=o?"".concat(le._.NEXT_PUBLIC_VIEWER_URL[0],"/api/v1/typebots/").concat(o.id,"/blocks/").concat(l):"";return(0,i.jsxs)(nH.t,{size:"sm",variant:"unstyled",children:[(0,i.jsxs)(nQ.w,{children:[(0,i.jsx)(nY.o,{children:"Test URL"}),(0,i.jsx)(nY.o,{children:"Production URL"})]}),(0,i.jsxs)(nJ.T,{children:[(0,i.jsx)(nZ.K,{pb:"0",children:(0,i.jsxs)(Z.B,{spacing:"4",children:[o&&(0,i.jsx)(X.MJ,{as:Z.B,children:(0,i.jsxs)(nX.M,{size:"sm",children:[(0,i.jsx)(la.p,{type:"text",defaultValue:"".concat(f,"/web/executeTestWebhook")}),(0,i.jsx)(nq.t,{width:"60px",children:(0,i.jsx)(n_.i,{size:"sm",textToCopy:"".concat(f,"/web/executeTestWebhook")})})]})}),(0,i.jsx)(A.$,{onClick:g,colorScheme:"orange",isLoading:"opened"===p,children:"Listen for test event"}),"opened"===p&&(0,i.jsx)(Z.B,{borderWidth:"1px",p:"4",borderRadius:"md",spacing:"3",children:(0,i.jsxs)(eI.E,{fontSize:"sm",children:["Waiting for an"," ",(0,i.jsx)(lU.Y,{href:"https://docs.typebot.io/api-reference/authentication",isExternal:!0,children:"authenticated"})," ",(0,i.jsx)(nV.vw,{children:"POST"})," request to the Test URL..."]})}),u&&(0,i.jsx)(eh.B,{isReadOnly:!0,lang:"json",value:u}),(u||(null==n?void 0:n.responseVariableMapping)&&n.responseVariableMapping.length>0)&&(0,i.jsx)(eb.n,{allowMultiple:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:["Save in variables",(0,i.jsx)(em.Q,{})]}),(0,i.jsx)(eg.v,{pt:"4",children:(0,i.jsx)(et.B,{initialItems:null==n?void 0:n.responseVariableMapping,onItemsChange:e=>t({...n,responseVariableMapping:e}),addLabel:"Add an entry",children:e=>(0,i.jsx)(j,{...e})})})]})})]})}),(0,i.jsx)(nZ.K,{pb:"0",children:o&&(0,i.jsxs)(X.MJ,{as:Z.B,children:[(0,i.jsxs)(nX.M,{size:"sm",children:[(0,i.jsx)(la.p,{type:"text",defaultValue:"".concat(f,"/results/{resultId}/executeWebhook")}),(0,i.jsx)(nq.t,{width:"60px",children:(0,i.jsx)(n_.i,{size:"sm",textToCopy:"".concat(f,"/results/{resultId}/executeWebhook")})})]}),(0,i.jsxs)(X.eK,{mt:"0",children:["You can easily get the Result ID"," ",(0,i.jsx)(lU.Y,{isExternal:!0,href:"https://docs.typebot.io/editor/blocks/logic/set-variable#result-id",children:"with a Set variable block"}),"."]})]})})]})]})},n4=e=>{let{options:l,onOptionsChange:n}=e,{t}=(0,$.WD)();return(0,i.jsx)(Z.B,{children:(0,i.jsx)(Q.ks,{placeholder:t("blocks.events.command.settings.command.placeholder"),defaultValue:null==l?void 0:l.command,onChange:e=>n({...l,command:e}),withVariableButton:!1})})},n3=e=>{let{options:l,onOptionsChange:n}=e,{t}=(0,$.WD)();return(0,i.jsx)(Z.B,{p:"2",spacing:4,children:(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:[t("blocks.events.reply.settings.variableMappingAccordion.title"),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{as:Z.B,spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:t("blocks.events.reply.settings.contentVariable.label")}),(0,i.jsx)(J.x,{initialVariableId:null==l?void 0:l.contentVariableId,onSelectVariable:e=>n({...l,contentVariableId:null==e?void 0:e.id})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(q.l,{mb:"0",htmlFor:"variable",children:[t("blocks.events.reply.settings.inputTypeVariable.label")," ",(0,i.jsx)(_.t,{children:t("blocks.events.reply.settings.inputTypeVariable.infoText")})]}),(0,i.jsx)(J.x,{initialVariableId:null==l?void 0:l.inputTypeVariableId,onSelectVariable:e=>n({...l,inputTypeVariableId:null==e?void 0:e.id})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(q.l,{mb:"0",htmlFor:"variable",children:[t("blocks.events.reply.settings.inputNameVariable.label")," ",(0,i.jsx)(_.t,{children:t("blocks.events.reply.settings.inputNameVariable.infoText")})]}),(0,i.jsx)(J.x,{initialVariableId:null==l?void 0:l.inputNameVariableId,onSelectVariable:e=>n({...l,inputNameVariableId:null==e?void 0:e.id})})]})]})]})})})},n5=e=>{let{options:l,onOptionsChange:n}=e,{t}=(0,$.WD)();return(0,i.jsx)(Z.B,{p:"2",spacing:4,children:(0,i.jsx)(eb.n,{allowToggle:!0,children:(0,i.jsxs)(ex.A,{children:[(0,i.jsxs)(ev.J,{justifyContent:"space-between",children:[t("blocks.events.reply.settings.variableMappingAccordion.title"),(0,i.jsx)(em.Q,{})]}),(0,i.jsxs)(eg.v,{as:Z.B,spacing:4,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(q.l,{mb:"0",htmlFor:"variable",children:t("blocks.events.reply.settings.contentVariable.label")}),(0,i.jsx)(J.x,{initialVariableId:null==l?void 0:l.contentVariableId,onSelectVariable:e=>n({...l,contentVariableId:null==e?void 0:e.id})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(q.l,{mb:"0",htmlFor:"variable",children:[t("blocks.events.reply.settings.inputTypeVariable.label")," ",(0,i.jsx)(_.t,{children:t("blocks.events.reply.settings.inputTypeVariable.infoText")})]}),(0,i.jsx)(J.x,{initialVariableId:null==l?void 0:l.inputTypeVariableId,onSelectVariable:e=>n({...l,inputTypeVariableId:null==e?void 0:e.id})})]}),(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(q.l,{mb:"0",htmlFor:"variable",children:[t("blocks.events.reply.settings.inputNameVariable.label")," ",(0,i.jsx)(_.t,{children:t("blocks.events.reply.settings.inputNameVariable.infoText")})]}),(0,i.jsx)(J.x,{initialVariableId:null==l?void 0:l.inputNameVariableId,onSelectVariable:e=>n({...l,inputNameVariableId:null==e?void 0:e.id})})]})]})]})})})};var n9=n(74279),n6=n(41497),n7=n(76685);let n8=e=>{var l,n,t;let{nodeType:i,blockDef:o}=e;return(0,e0.O9)(null!=(t=null==o||null==(l=o.onboarding)?void 0:l.youtubeId)?t:null==(n=n7.Q[i])?void 0:n.youtubeId)};var te=n(58935),tl=n(73925),tn=n(81208),tt=n(36948),ti=n(1293),to=n(43759),ta=n(22578),ts=n(20644),tr=n(15281);let td=e=>{if("cal-com"===e||"qr-code"===e)throw Error("Block has no auth");return e},tu=e=>{var l,n;let{currentCredentialsId:t,blockDef:o,onCredentialsSelect:a,onAddClick:s,scope:r,...d}=e,u=(0,nW.useRouter)(),{t:c}=(0,$.WD)(),{workspace:p,currentUserMode:h}=(0,eT.h)(),{data:b,refetch:x,isLoading:v}=(0,e8.I)(e7.id.credentials.listCredentials.queryOptions("workspace"===r?{scope:"workspace",workspaceId:p.id,type:td(o.id)}:{scope:"user",type:td(o.id)},{enabled:!!(null==p?void 0:p.id)})),[g,j]=(0,m.useState)(),{mutate:f}=(0,lJ.n)(e7.id.credentials.deleteCredentials.mutationOptions({onMutate:e=>{let{credentialsId:l}=e;j(l)},onError:e=>{(0,lu.o)({description:e.message})},onSuccess:e=>{let{credentialsId:l}=e;l===t&&a(void 0),x()},onSettled:()=>{j(void 0)}})),y=null==b?void 0:b.credentials.find(e=>e.id===t),I=(0,m.useCallback)(e=>()=>{a(e)},[a]),C=(0,m.useCallback)(()=>{u.asPath.includes("?")&&u.push(u.asPath.split("?")[0],void 0,{shallow:!0})},[u]);(0,m.useEffect)(()=>{u.isReady&&u.query.credentialsId&&(I(u.query.credentialsId.toString())(),C())},[C,I,u.isReady,u.query.credentialsId]);let k=e=>async l=>{p&&(l.stopPropagation(),f("workspace"===r?{scope:"workspace",workspaceId:p.id,credentialsId:e}:{scope:"user",credentialsId:e}))};return b&&(null==b?void 0:b.credentials.length)!==0?(0,i.jsxs)(U.W,{isLazy:!0,children:[(0,i.jsx)(z.I,{as:A.$,rightIcon:(0,i.jsx)(S.YJ,{transform:"rotate(-90deg)"}),colorScheme:"gray",justifyContent:"space-between",textAlign:"left",...d,children:(0,i.jsx)(eI.E,{noOfLines:1,overflowY:"visible",h:"sm"===d.size?"18px":"20px",children:y?y.name:"Select ".concat(null==(l=o.auth)?void 0:l.name)})}),(0,i.jsx)(ts.c,{children:(0,i.jsxs)(Z.B,{maxH:"35vh",overflowY:"auto",spacing:"0",children:[null==b?void 0:b.credentials.map(e=>(0,i.jsxs)(tr.D,{role:"menuitem",minH:"40px",onClick:I(e.id),fontSize:"16px",fontWeight:"normal",rounded:"none",justifyContent:"space-between",children:[e.name,(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.uc,{}),"aria-label":"Remove credentials",size:"xs",onClick:k(e.id),isLoading:g===e.id})]},e.id)),"guest"===h?null:(0,i.jsx)(tr.D,{maxW:"500px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",icon:(0,i.jsx)(S.c1,{}),onClick:s,children:c("connectNew")})]})})]}):(0,i.jsxs)(A.$,{colorScheme:"gray",textAlign:"left",leftIcon:(0,i.jsx)(S.c1,{}),onClick:s,isDisabled:"guest"===h,isLoading:v,...d,children:["Add ",null==(n=o.auth)?void 0:n.name]})};var tc=n(68401);let tp=e=>{let{blockDef:l,blockOptions:n,schema:t,onDataChange:o}=e,a=t._def.innerType,s=(null==n?void 0:n.action)?a._def.optionsMap.get(null==n?void 0:n.action):void 0,r=(0,m.useMemo)(()=>s?Object.keys(s.shape).slice(0,Object.keys(s.shape).findIndex(e=>"action"===e)+1):[],[s]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(en.Q,{currentItem:null==n?void 0:n.action,onItemSelect:e=>o({...n,action:e}),items:[...a._def.optionsMap.keys()].filter(e0.O9),placeholder:"Select an action"}),s&&(0,i.jsx)(tc.p,{schema:s,data:n,blockDef:l,blockOptions:n,onDataChange:o,ignoreKeys:r})]})},th=e=>{var l,n,t,o;let{block:a,onOptionsChange:s}=e,[r,d]=(0,m.useState)(0),{blockDef:u,blockSchema:c,actionDef:p}=(0,n9._)({nodeType:a.type,action:null==(l=a.options)?void 0:l.action}),{isOpen:h,onOpen:b,onClose:x}=(0,eV.j)(),v=e=>{s({...a.options,credentialsId:e})},g=e=>{var l,n;if(!p)return;let t=Object.keys(null!=(n=null==(l=p.options)?void 0:l.shape)?n:[]).reduce((e,l)=>({...e,[l]:a.options[l]&&"object"!=typeof a.options[l]?a.options[l]:void 0}),{});s({...e,...t}),d(e=>e+1)};return u&&c?(0,i.jsxs)(Z.B,{spacing:4,children:[u.auth&&(0,i.jsxs)(i.Fragment,{children:["oauth"===u.auth.type?(0,i.jsx)(ta.e,{scope:"workspace",blockDef:u,isOpen:h,onClose:x,onNewCredentials:v}):(0,i.jsx)(to.v,{scope:"workspace",blockDef:u,isOpen:h,onClose:x,onNewCredentials:v}),(0,i.jsx)(tu,{scope:"workspace",blockDef:u,currentCredentialsId:null==(n=a.options)?void 0:n.credentialsId,onCredentialsSelect:v,onAddClick:b},null!=(o=null==(t=a.options)?void 0:t.credentialsId)?o:"none")]}),(void 0!==a.options||void 0===u.auth)&&(0,i.jsxs)(i.Fragment,{children:[u.options&&(0,i.jsx)(tc.p,{schema:u.options,data:a.options,blockOptions:a.options,blockDef:u,onDataChange:s}),(0,i.jsx)(tp,{schema:c.shape.options,blockDef:u,blockOptions:a.options,onDataChange:e=>{if(p&&(null==e?void 0:e.action)&&e.action!==a.options.action)return void g(e);s(e)}},a.id+r)]})]}):null},tb=(e,l)=>{switch(e){case ti.G.TYPEBOT_LINK:return"https://docs.typebot.io/editor/blocks/logic/typebot-link";case ti.G.SET_VARIABLE:return"https://docs.typebot.io/editor/blocks/logic/set-variable";case ti.G.REDIRECT:return"https://docs.typebot.io/editor/blocks/logic/redirect";case ti.G.SCRIPT:return"https://docs.typebot.io/editor/blocks/logic/script";case ti.G.WAIT:return"https://docs.typebot.io/editor/blocks/logic/wait";case es.iQ.TEXT:return"https://docs.typebot.io/editor/blocks/inputs/text";case es.iQ.NUMBER:return"https://docs.typebot.io/editor/blocks/inputs/number";case es.iQ.EMAIL:return"https://docs.typebot.io/editor/blocks/inputs/email";case es.iQ.URL:return"https://docs.typebot.io/editor/blocks/inputs/website";case es.iQ.DATE:return"https://docs.typebot.io/editor/blocks/inputs/date";case es.iQ.TIME:return"https://docs.typebot.io/editor/blocks/inputs/time";case es.iQ.PHONE:return"https://docs.typebot.io/editor/blocks/inputs/phone-number";case es.iQ.CHOICE:return"https://docs.typebot.io/editor/blocks/inputs/buttons";case es.iQ.PAYMENT:return"https://docs.typebot.io/editor/blocks/inputs/payment";case es.iQ.RATING:return"https://docs.typebot.io/editor/blocks/inputs/rating";case es.iQ.FILE:return"https://docs.typebot.io/editor/blocks/inputs/file-upload";case tt.I.EMAIL:return"https://docs.typebot.io/editor/blocks/integrations/email";case tt.I.CHATWOOT:return"https://docs.typebot.io/editor/blocks/integrations/chatwoot";case tt.I.GOOGLE_ANALYTICS:return"https://docs.typebot.io/editor/blocks/integrations/google-analytics";case tt.I.GOOGLE_SHEETS:return"https://docs.typebot.io/editor/blocks/integrations/google-sheets";case tt.I.ZAPIER:return"https://docs.typebot.io/editor/blocks/integrations/zapier";case tt.I.PABBLY_CONNECT:return"https://docs.typebot.io/editor/blocks/integrations/pabbly";case tt.I.HTTP_REQUEST:return"https://docs.typebot.io/editor/blocks/integrations/http-request";case es.iQ.PICTURE_CHOICE:return"https://docs.typebot.io/editor/blocks/inputs/picture-choice";case es.iQ.CARDS:return"https://docs.typebot.io/editor/blocks/inputs/cards";case tt.I.OPEN_AI:return"https://docs.typebot.io/editor/blocks/integrations/openai";case tt.I.MAKE_COM:return"https://docs.typebot.io/editor/blocks/integrations/make-com";case ti.G.AB_TEST:return"https://docs.typebot.io/editor/blocks/logic/ab-test";case ti.G.JUMP:return"https://docs.typebot.io/editor/blocks/logic/jump";case tt.I.PIXEL:return"https://docs.typebot.io/editor/blocks/integrations/pixel";case ti.G.CONDITION:return"https://docs.typebot.io/editor/blocks/logic/condition";case ti.G.WEBHOOK:return"https://docs.typebot.io/editor/blocks/logic/webhook";case R.B.COMMAND:return"https://docs.typebot.io/editor/events/command";case R.B.REPLY:return"https://docs.typebot.io/editor/events/reply";case R.B.INVALID_REPLY:return"https://docs.typebot.io/editor/events/invalid-reply";default:return null==l?void 0:l.docsUrl}},tx=e=>{let{nodeType:l,blockDef:n,isVideoOnboardingItemDisplayed:t,isExpanded:o,onExpandClick:a,onVideoOnboardingClick:s}=e,{t:r}=(0,$.WD)(),d=tb(l,n);return(0,i.jsxs)(V.z,{rounded:"md",spacing:0,borderWidth:"1px",bgColor:(0,M.dU)("white","gray.900"),shadow:"md",children:[(0,i.jsx)(B.K,{icon:o?(0,i.jsx)(S.gR,{}):(0,i.jsx)(S.mS,{}),borderRightWidth:"1px",borderRightRadius:"none",borderLeftRadius:"none","aria-label":"Duplicate group",variant:"ghost",onClick:a,size:"xs"}),d&&(0,i.jsx)(A.$,{as:lN.N,leftIcon:(0,i.jsx)(S.Xb,{}),borderLeftRadius:"none",borderRightRadius:t?"none":void 0,borderRightWidth:t?"1px":void 0,size:"xs",variant:"ghost",href:d,isExternal:!0,children:r("help")}),t&&(0,i.jsx)(n6.K.TriggerIconButton,{onClick:s,size:"xs",borderLeftRadius:"none"})]})},tv=e=>{let{isOpen:l,...n}=e,[t,o]=(0,m.useState)(!1),a=(0,M.dU)("white","gray.900"),{blockDef:s}=(0,n9._)({nodeType:n.node.type}),[c,p]=(0,m.useState)(!1),h=(0,m.useRef)(null);return(0,m.useEffect)(()=>{c&&!l&&setTimeout(()=>{p(!1)},300)},[l,c]),(0,r.M)("wheel",e=>{e.stopPropagation()},h.current),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{onMouseDown:e=>e.stopPropagation(),pos:"relative",w:c?"650px":void 0,maxH:c?"70vh":"400px",h:"full",children:[(0,i.jsx)(te.R,{bgColor:a}),(0,i.jsx)(n6.K.Root,{type:n.node.type,blockDef:s,children:e=>{let{onOpen:l}=e;return(0,i.jsx)(tl.e,{py:"3",overflowY:"auto",ref:h,shadow:"md",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:(0,i.jsxs)(Z.B,{spacing:3,children:[(0,i.jsx)(d.s,{w:"full",pos:"absolute",top:"-56px",height:"64px",right:0,justifyContent:"flex-end",align:"center",children:(0,i.jsx)(tn.s,{in:t,unmountOnExit:!0,children:(0,i.jsx)(tx,{isExpanded:c,onExpandClick:()=>p(!c),onVideoOnboardingClick:l,nodeType:n.node.type,blockDef:s,isVideoOnboardingItemDisplayed:n8({nodeType:n.node.type,blockDef:s})})})}),(0,i.jsx)(tm,{...n})]})})}})]})})},tm=e=>{let{node:l,onNodeChange:n}=e,t=e=>{n({options:e})};switch(l.type){case es.iQ.TEXT:return(0,i.jsx)(eK,{options:l.options,onOptionsChange:t});case es.iQ.NUMBER:return(0,i.jsx)(ew,{options:l.options,onOptionsChange:t});case es.iQ.EMAIL:return(0,i.jsx)(ec,{options:l.options,onOptionsChange:t});case es.iQ.URL:return(0,i.jsx)(eJ,{options:l.options,onOptionsChange:t});case es.iQ.DATE:return(0,i.jsx)(ed,{options:l.options,onOptionsChange:t});case es.iQ.TIME:return(0,i.jsx)(eQ,{options:l.options,onOptionsChange:t});case es.iQ.PHONE:return(0,i.jsx)(eP,{options:l.options,onOptionsChange:t});case es.iQ.CHOICE:return(0,i.jsx)(el,{options:l.options,onOptionsChange:t});case es.iQ.PICTURE_CHOICE:return(0,i.jsx)(eG,{options:l.options,onOptionsChange:t});case es.iQ.PAYMENT:return(0,i.jsx)(eO,{options:l.options,onOptionsChange:t});case es.iQ.RATING:return(0,i.jsx)(eU,{options:l.options,onOptionsChange:t});case es.iQ.FILE:return(0,i.jsx)(ef,{options:l.options,onOptionsChange:t});case es.iQ.CARDS:return(0,i.jsx)(eo,{options:l.options,onOptionsChange:t});case ti.G.SET_VARIABLE:return(0,i.jsx)(nR,{options:l.options,onOptionsChange:t});case ti.G.REDIRECT:return(0,i.jsx)(nk,{options:l.options,onOptionsChange:t});case ti.G.SCRIPT:return(0,i.jsx)(nw,{options:l.options,onOptionsChange:t});case ti.G.TYPEBOT_LINK:return(0,i.jsx)(nz,{options:l.options,onOptionsChange:t});case ti.G.WAIT:return(0,i.jsx)(nK,{options:l.options,onOptionsChange:t});case ti.G.JUMP:return(0,i.jsx)(nI,{options:l.options,onOptionsChange:t});case ti.G.AB_TEST:return(0,i.jsx)(nr,{options:l.options,onOptionsChange:t});case tt.I.GOOGLE_SHEETS:return(0,i.jsx)(lr,{options:l.options,onOptionsChange:t,blockId:l.id});case tt.I.GOOGLE_ANALYTICS:return(0,i.jsx)(eq,{options:l.options,onOptionsChange:t});case tt.I.ZAPIER:return(0,i.jsx)(na,{block:l,onOptionsChange:t});case tt.I.MAKE_COM:return(0,i.jsx)(lG,{block:l,onOptionsChange:t});case tt.I.PABBLY_CONNECT:return(0,i.jsx)(l9,{block:l,onOptionsChange:t});case tt.I.HTTP_REQUEST:return(0,i.jsx)(lD,{block:l,onOptionsChange:t});case tt.I.EMAIL:return(0,i.jsx)(ni,{options:l.options,onOptionsChange:t});case tt.I.CHATWOOT:return(0,i.jsx)(eX,{options:l.options,onOptionsChange:t});case tt.I.OPEN_AI:return(0,i.jsx)(l3,{block:l,onOptionsChange:t});case tt.I.PIXEL:return(0,i.jsx)(l7,{options:l.options,onOptionsChange:t});case ti.G.CONDITION:return null;case ti.G.WEBHOOK:return(0,i.jsx)(n2,{blockId:l.id,options:l.options,onOptionsChange:t});case R.B.COMMAND:return(0,i.jsx)(n4,{options:l.options,onOptionsChange:t});case R.B.REPLY:return(0,i.jsx)(n5,{options:l.options,onOptionsChange:t});case R.B.INVALID_REPLY:return(0,i.jsx)(n3,{options:l.options,onOptionsChange:t});default:return(0,i.jsx)(th,{block:l,onOptionsChange:t})}},tg=e=>l=>e.forEach(e=>e.current=l);var tj=n(44605),tf=n(66737);let ty=(0,m.createContext)({sourceEndpointYOffsets:new Map,targetEndpointYOffsets:new Map}),tI=e=>{let{children:l}=e,[n,t]=(0,m.useState)(new Map),[o,a]=(0,m.useState)(new Map),s=(0,m.useCallback)(e=>{t(l=>new Map(l).set(e.id,e))},[]),r=(0,m.useCallback)(e=>{t(l=>(l.delete(e),l))},[]),d=(0,m.useCallback)(e=>{a(l=>new Map(l).set(e.id,e))},[]);return(0,i.jsx)(ty.Provider,{value:{sourceEndpointYOffsets:n,targetEndpointYOffsets:o,setSourceEndpointYOffset:s,deleteSourceEndpointYOffset:r,setTargetEnpointYOffset:d},children:l})},tC=()=>(0,m.useContext)(ty),tk=e=>{let{source:l,isHidden:n,...t}=e,o=(0,M.dU)("orange.200","orange.100"),a=(0,M.dU)("orange.300","orange.200"),s=(0,M.dU)("gray.100","gray.700"),{setConnectingIds:u,previewingEdge:c,graphPosition:p}=(0,w.u)(),{setSourceEndpointYOffset:h,deleteSourceEndpointYOffset:b}=tC(),[x,v]=(0,m.useState)(),[g,j]=(0,m.useState)(),f=(0,m.useRef)(null),y=(0,m.useMemo)(()=>{var e;return f.current?Number((((null==(e=f.current)?void 0:e.getBoundingClientRect().y)+32*p.scale/2-p.y)/p.scale).toFixed(2)):void 0},[p.scale,p.y,g,x]);return(0,m.useLayoutEffect)(()=>{let e=new ResizeObserver(e=>{j(e[0].contentRect.height)}),n=document.querySelector('[data-moving-element="event-'.concat(l.eventId,'"]'));if(n)return e.observe(n),()=>{e.disconnect()}},[l.eventId]),(0,m.useLayoutEffect)(()=>{let e=new MutationObserver(e=>{v(e[0].target.style.transform)}),n=document.querySelector('[data-moving-element="event-'.concat(l.eventId,'"]'));if(n)return e.observe(n,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[l.eventId]),(0,m.useEffect)(()=>{y&&(null==h||h({id:l.eventId,y:y}))},[h,y,l.eventId]),(0,m.useEffect)(()=>()=>{null==b||b(l.eventId)},[b,l.eventId]),(0,r.M)("pointerdown",e=>{e.stopPropagation(),u({source:l})},f.current),(0,r.M)("mousedown",e=>{e.stopPropagation()},f.current),(0,i.jsx)(d.s,{ref:f,"data-testid":"endpoint",boxSize:"32px",rounded:"full",cursor:"copy",justify:"center",align:"center",pointerEvents:"all",visibility:n?"hidden":"visible",...t,children:(0,i.jsx)(d.s,{boxSize:"20px",justify:"center",align:"center",bg:s,rounded:"full",children:(0,i.jsx)(d.s,{boxSize:"13px",rounded:"full",borderWidth:"3.5px",shadow:"sm",borderColor:c&&"eventId"in c.from&&c.from.eventId===l.eventId?a:o})})})},tE=()=>navigator.userAgentData?"macOS"===navigator.userAgentData.platform:/Macintosh|Mac Intel|MacPPC|Mac OS X/i.test(navigator.userAgent);var tw=n(4501),tS=n(3888);let tT=e=>{let{eventId:l,type:n,onPlayClick:t,onSettingsClick:o}=e,{hasCopied:a,onCopy:s}=(0,tw.i)(l),r=()=>{n!==R.B.START&&dispatchEvent(new KeyboardEvent("keydown",{key:"c",[tE()?"metaKey":"ctrlKey"]:!0}))};return(0,i.jsxs)(V.z,{rounded:"md",spacing:0,borderWidth:"1px",bgColor:(0,M.dU)("white","gray.900"),shadow:"md",children:[(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.ud,{}),borderRightWidth:"1px",borderRightRadius:"none","aria-label":"Preview bot from this group",variant:"ghost",onClick:t,size:"sm"}),(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.Ze,{}),"aria-label":"Show event settings",variant:"ghost",size:"sm",onClick:o}),n!==R.B.START&&(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.Td,{}),borderRightWidth:"1px",borderRightRadius:"none",borderLeftRadius:"none","aria-label":"Copy group",variant:"ghost",onClick:e=>{e.stopPropagation(),r()},size:"sm"}),(0,i.jsx)(tS.m,{label:a?"Copied!":l,closeOnClick:!1,placement:"top",children:(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.mo,{}),borderRightWidth:"1px",borderRightRadius:"none",borderLeftRadius:"none","aria-label":"Show group info",variant:"ghost",size:"sm",onClick:s})}),n!==R.B.START&&(0,i.jsx)(B.K,{"aria-label":"Delete",borderLeftRadius:"none",icon:(0,i.jsx)(S.uc,{}),onClick:()=>{n!==R.B.START&&dispatchEvent(new KeyboardEvent("keydown",{key:"Backspace"}))},variant:"ghost",size:"sm"})]})};var tV=n(4087),tM=n(10714);let tA=()=>(0,i.jsxs)(V.z,{spacing:3,children:[(0,i.jsx)(tV.C,{type:R.B.START}),(0,i.jsx)(tM.X,{type:R.B.START})]}),tB=e=>{let{options:l}=e,{t:n}=(0,$.WD)();return(0,i.jsxs)(V.z,{spacing:3,fontWeight:"normal",children:[(0,i.jsx)(tV.C,{type:R.B.COMMAND}),(null==l?void 0:l.command)?(0,i.jsx)(nV.vw,{p:"2",children:null==l?void 0:l.command}):(0,i.jsx)(eI.E,{color:"gray.500",fontWeight:"normal",children:n("configure")})]})},tR=e=>{var l;let{variableId:n,variables:t}=e,{t:o}=(0,$.WD)(),a=(0,M.dU)("gray.600","gray.400"),s=null==t||null==(l=t.find(e=>e.id===n))?void 0:l.name;return s?(0,i.jsxs)(V.z,{fontStyle:"italic",spacing:1,children:[(0,i.jsx)(eI.E,{fontSize:"sm",color:a,children:o("variables.set")}),(0,i.jsx)(nV.vw,{size:"sm",variant:"outline",colorScheme:"purple",wordBreak:"break-all",children:s})]}):null},tO=e=>{let{options:l}=e,{t:n}=(0,$.WD)(),{typebot:t}=(0,a.V)();return(0,i.jsxs)(V.z,{flex:"1",align:"flex-start",spacing:3,fontWeight:"normal",children:[(0,i.jsx)(tV.C,{type:R.B.INVALID_REPLY,mt:"5px"}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:n("blocks.events.invalidReply.node.prefix")}),(null==l?void 0:l.contentVariableId)?(0,i.jsx)(tR,{variables:null==t?void 0:t.variables,variableId:l.contentVariableId}):null,(null==l?void 0:l.inputTypeVariableId)?(0,i.jsx)(tR,{variables:null==t?void 0:t.variables,variableId:l.inputTypeVariableId}):null,(null==l?void 0:l.inputNameVariableId)?(0,i.jsx)(tR,{variables:null==t?void 0:t.variables,variableId:l.inputNameVariableId}):null]})]})},tD=e=>{let{options:l}=e,{t:n}=(0,$.WD)(),{typebot:t}=(0,a.V)();return(0,i.jsxs)(V.z,{flex:"1",align:"flex-start",spacing:3,fontWeight:"normal",children:[(0,i.jsx)(tV.C,{type:R.B.REPLY,mt:"5px"}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:n("blocks.events.reply.node.prefix")}),(null==l?void 0:l.contentVariableId)?(0,i.jsx)(tR,{variables:null==t?void 0:t.variables,variableId:l.contentVariableId}):null,(null==l?void 0:l.inputTypeVariableId)?(0,i.jsx)(tR,{variables:null==t?void 0:t.variables,variableId:l.inputTypeVariableId}):null,(null==l?void 0:l.inputNameVariableId)?(0,i.jsx)(tR,{variables:null==t?void 0:t.variables,variableId:l.inputNameVariableId}):null]})]})},tL=e=>{let{event:l}=e;switch(l.type){case R.B.START:return(0,i.jsx)(tA,{});case R.B.COMMAND:return(0,i.jsx)(tB,{options:l.options});case R.B.REPLY:return(0,i.jsx)(tD,{options:l.options});case R.B.INVALID_REPLY:return(0,i.jsx)(tO,{options:l.options})}},tP=()=>(0,i.jsxs)(ts.c,{children:[(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.Td,{}),onClick:()=>dispatchEvent(new KeyboardEvent("keydown",{key:"c",[tE()?"metaKey":"ctrlKey"]:!0})),children:"Duplicate"}),(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.uc,{}),onClick:()=>dispatchEvent(new KeyboardEvent("keydown",{key:"Backspace"})),children:"Delete"})]}),tN=e=>{let{event:l,eventIndex:n}=e,{openedNodeId:t,setOpenedNodeId:o}=(0,w.u)(),s=(0,M.dU)("white","gray.950"),r=(0,M.dU)("orange.400","orange.300"),{previewingEdge:d,isReadOnly:u,graphPosition:c}=(0,w.u)(),{updateEvent:p,updateEventsCoordinates:h}=(0,a.V)(),{setStartPreviewFrom:b}=(0,K.h)(),[,x]=(0,tj.o)(),[g,y]=(0,m.useState)(!1),I=(0,k.r)((0,j.k)(e=>e.focusedElementsId)),C=(0,k.r)((0,j.k)(e=>e.elementsCoordinates?e.elementsCoordinates[l.id]:l.graphCoordinates)),{moveFocusedElements:E,focusElement:S,getElementsCoordinates:T,blurElements:V}=(0,k.r)((0,j.k)(e=>({getElementsCoordinates:e.getElementsCoordinates,moveFocusedElements:e.moveFocusedElements,focusElement:e.focusElement,blurElements:e.blurElements}))),A=!!d&&"eventId"in d.from&&d.from.eventId===l.id,B=(0,m.useRef)(null),R=(0,k.r)(e=>e.isDraggingGraph),{isOpen:O,onOpen:D,onClose:L}=(0,eV.j)(),P=()=>{b({type:"event",id:l.id}),x("preview")},N=e=>p(n,{...l,...e});(0,v.useDrag)(e=>{let{first:n,last:t,delta:i,event:o}=e;if(o.stopPropagation(),n){if(y(!0),I.find(e=>e===l.id)&&!o.shiftKey)return;S(l.id,o.shiftKey)}if(E({x:i[0]/c.scale,y:i[1]/c.scale}),t){let e=T();if(!e)return;h(e),y(!1)}},{target:B,pointer:{keys:!1},from:()=>[C.x*c.scale,C.y*c.scale]});let G=I.includes(l.id);return(0,i.jsx)(F,{onOpen:()=>S(l.id),renderMenu:()=>(0,i.jsx)(tP,{}),isDisabled:u||"start"===l.type,children:(e,n)=>{var a,d;return(0,i.jsxs)(lT.A,{placement:"left",isLazy:!0,isOpen:t===l.id,closeOnBlur:!1,children:[(0,i.jsx)(tf.W,{children:(0,i.jsxs)(Z.B,{ref:tg([e,B]),"data-moving-element":"event-".concat(l.id),"data-selectable":l.id,userSelect:"none","data-testid":"event",py:"2",pl:"3",pr:"3",w:f.tq,rounded:"xl",bg:s,borderWidth:"1px",fontWeight:"medium",borderColor:n||A||G?r:void 0,transition:"border 300ms, box-shadow 200ms",pos:"absolute",style:{transform:"translate(".concat(null!=(a=null==C?void 0:C.x)?a:0,"px, ").concat(null!=(d=null==C?void 0:C.y)?d:0,"px)"),touchAction:"none"},cursor:g?"grabbing":"pointer",_hover:{shadow:"md"},zIndex:G?10:1,pointerEvents:R?"none":"auto",children:[(0,i.jsx)(tL,{event:l}),(0,i.jsx)(tk,{source:{eventId:l.id},pos:"absolute",right:"-19px",bottom:"4px",isHidden:!1}),!u&&(0,i.jsx)(tn.s,{in:G&&1===I.length,style:{position:"absolute",top:"-45px",right:0},unmountOnExit:!0,children:(0,i.jsx)(tT,{eventId:l.id,type:l.type,onPlayClick:P,onSettingsClick:()=>{V(),o(l.id)}})})]})}),tG(l)&&(0,i.jsx)(tv,{node:l,groupId:void 0,onNodeChange:N})]})}})},tG=e=>e.type!==R.B.START;var tW=n(64660),tU=n(5969),tz=n(23065),tF=n.n(tz),tK=n(65088);let t_=e=>{let{sourcePosition:l,targetPosition:n,sourceType:t,totalSegments:i}=e;switch(i){case 2:return tH(l,n);case 3:return tQ(l,n,t);case 4:return tY(l,n,t);default:return tJ(l,n,t)}},tH=(e,l)=>{let n=[];return n.push("L".concat(l.x,",").concat(e.y)),n.push("L".concat(l.x,",").concat(l.y)),n.join(" ")},tQ=(e,l,n)=>{let t=[],i="right"===n?e.x+(l.x-e.x)/2:e.x-(e.x-l.x)/2;return t.push("L".concat(i,",").concat(e.y)),t.push("L".concat(i,",").concat(l.y)),t.push("L".concat(l.x,",").concat(l.y)),t.join(" ")},tY=(e,l,n)=>{let t=[],i=e.x+("right"===n?f.t6:-f.t6);t.push("L".concat(i,",").concat(e.y));let o=e.y+(l.y-e.y)-f.t6;return t.push("L".concat(i,",").concat(o)),t.push("L".concat(l.x,",").concat(o)),t.push("L".concat(l.x,",").concat(l.y)),t.join(" ")},tJ=(e,l,n)=>{let t=[],i=e.x+("right"===n?f.t6:-f.t6);t.push("L".concat(i,",").concat(e.y));let o=e.y+(l.y-e.y)/2;t.push("L".concat(e.x+("right"===n?f.t6:-f.t6),",").concat(o));let a=l.x-("right"===n?f.t6:-f.t6);return t.push("L".concat(a,",").concat(o)),t.push("L".concat(a,",").concat(l.y)),t.push("L".concat(l.x,",").concat(l.y)),t.join(" ")},tZ=e=>{let{sourcePosition:l,targetPosition:n,sourceType:t,totalSegments:i}=e,o=t_({sourcePosition:l,targetPosition:n,sourceType:t,totalSegments:i});return(0,tK.Nh)("M".concat(l.x,",").concat(l.y," ").concat(o),f.wX).path},tX=e=>{let{sourcePosition:l,sourceTop:n,elementWidth:t}=e;return{x:l.x+t,y:n}},tq=e=>{let{sourceGroupCoordinates:l,targetGroupCoordinates:n,elementWidth:t,sourceTop:i,targetTop:o}=e,a=tX({sourcePosition:l,elementWidth:t,sourceTop:i}),s="right";l.x>n.x&&(a.x=l.x,s="left");let{targetPosition:r,totalSegments:d}=t$({sourceGroupPosition:l,targetGroupPosition:n,elementWidth:t,sourceOffsetY:i,targetOffsetY:o});return{sourcePosition:a,targetPosition:r,sourceType:s,totalSegments:d}},t$=e=>{let{sourceGroupPosition:l,targetGroupPosition:n,elementWidth:t,sourceOffsetY:i,targetOffsetY:o}=e,a=n.y>i&&n.x<l.x+t+f.t6&&n.x>l.x-t-f.t6,s=n.x<l.x,r=!o;return a&&r?{totalSegments:n.x<l.x-t/2-f.t6||n.x>l.x+t/2+f.t6?2:4,targetPosition:t0(n,"top")}:{totalSegments:n.x<l.x-t||n.x>l.x+t?3:5,targetPosition:t0(n,s?"right":"left",o)}},t0=(e,l,n)=>{switch(l){case"left":return{x:e.x+f.zT.left.x,y:null!=n?n:e.y+f.zT.left.y};case"top":return{x:e.x+f.zT.top.x,y:e.y+f.zT.top.y};case"right":return{x:e.x+f.zT.right.x,y:null!=n?n:e.y+f.zT.right.y}}},t1=e=>{let{sourceGroupCoordinates:l,targetGroupCoordinates:n,elementWidth:t,sourceTop:i,targetTop:o,graphScale:a}=e;return tZ(tq({sourceGroupCoordinates:l,targetGroupCoordinates:n,elementWidth:t,sourceTop:i,targetTop:o,graphScale:a}))},t2=e=>{let{sourceGroupCoordinates:l,mousePosition:n,sourceTop:t,elementWidth:i}=e,o={x:n.x-l.x>i/2?l.x+i:l.x,y:t},a=n.x-l.x>i/2?"right":"left",s=tQ(o,n,a);return(0,tK.Nh)("M".concat(o.x,",").concat(o.y," ").concat(s),f.wX).path},t4=e=>{var l,n,t;let{connectingIds:o}=e,{graphPosition:d,setConnectingIds:u}=(0,w.u)(),{sourceEndpointYOffsets:c,targetEndpointYOffsets:p}=tC(),h=(0,k.r)(e=>e.elementsCoordinates,()=>!0),{user:b}=(0,s.J)(),{createEdge:x,typebot:v,updateGroup:g}=(0,a.V)(),[j,y]=(0,m.useState)(null),I=o?"eventId"in o.source?null==h?void 0:h[null==o?void 0:o.source.eventId]:null==h?void 0:h[null!=(n=null==o?void 0:o.source.groupId)?n:""]:void 0,C=h&&h[null!=(t=null==o||null==(l=o.target)?void 0:l.groupId)?t:""],E=(0,m.useMemo)(()=>{var e,l,n;if(!o)return 0;let t="eventId"in o.source?o.source.eventId:null!=(n=null!=(l=o.source.pathId)?l:o.source.itemId)?n:o.source.blockId;return null==(e=c.get(t))?void 0:e.y},[o,c]),S=(0,m.useMemo)(()=>{var e,l;if(!o)return 0;let n=null==(e=o.target)?void 0:e.blockId;return n?null==(l=p.get(n))?void 0:l.y:void 0},[o,p]),T=(0,m.useMemo)(()=>E&&I&&j&&(null==o?void 0:o.source)?C?t1({sourceGroupCoordinates:I,targetGroupCoordinates:C,elementWidth:"eventId"in o.source?f.tq:f.mI,sourceTop:E,targetTop:S,graphScale:d.scale}):t2({sourceGroupCoordinates:I,mousePosition:j,sourceTop:E,elementWidth:"eventId"in o.source?f.tq:f.mI}):"",[E,I,j,C,null==o?void 0:o.source,S,d.scale]);(0,r.M)("mousemove",e=>{if(!o){j&&y(null);return}y({x:(e.clientX-d.x)/d.scale,y:(e.clientY-d.y)/d.scale})}),(0,r.M)("mouseup",()=>{(null==o?void 0:o.target)&&V(o),u(null)});let V=async e=>{tF()(e.target),x({from:"groupId"in e.source?(0,e0.cJ)(e.source,"groupId"):e.source,to:e.target});let l=null==b?void 0:b.groupTitlesAutoGeneration;if(v&&(null==l?void 0:l.isEnabled)&&l.credentialsId&&l.provider&&l.model&&"groupId"in e.source){let n=null==v?void 0:v.groups.findIndex(l=>l.id===e.source.groupId),t=v.groups[n];if(!t||!(null==t?void 0:t.title.startsWith("Group #")))return;try{let e=await e7.rP.generateGroupTitle.mutate({credentialsId:l.credentialsId,typebotId:v.id,groupContent:JSON.stringify({blocks:t.blocks.map(e=>{let{id:l,outgoingEdgeId:n,...t}=e;return t})}),model:l.model,prompt:l.prompt});g(n,{title:e.title})}catch(e){N.oR.error("Failed to auto generate group title"),console.error("Failed to generate group title:",e)}}};return j&&0===j.x&&0===j.y?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)("path",{d:T,stroke:tU.T.orange[400],strokeWidth:"2px",markerEnd:"url(#orange-arrow)",fill:"none"})},t3=e=>{let l=new Map,n=new Map;for(let o of e){var t,i;o.to&&((0,e0.pN)(o.to.blockId)?n.set(o.to.groupId,(null!=(t=n.get(o.to.groupId))?t:0)+o.total):l.set(o.to.blockId,(null!=(i=l.get(o.to.blockId))?i:0)+o.total))}return{byBlock:l,byGroupRoot:n}},t5=(e,l)=>{var n,t,i;let{publishedTypebot:o,edgesWithTotalUsers:a,totalAnswers:s}=l,r=t3(a),d=new Map(s.map(e=>[e.blockId,e.total])),u=o.groups.find(l=>l.blocks.some(l=>l.id===e));if(!u)return 0;let c=u.blocks.findIndex(l=>l.id===e);if(-1===c)return 0;let p=0;for(let l=c;l>=0;l--){let i=u.blocks[l];if(i.id!==e&&(0,b.Ke)(i))return null!=(n=d.get(i.id))?n:0;p+=null!=(t=r.byBlock.get(i.id))?t:0}return p+(null!=(i=r.byGroupRoot.get(u.id))?i:0)},t9=(e,l)=>{var n,t;let{publishedTypebot:i,totalAnswers:o}=l,a=i.groups.flatMap(e=>e.blocks).find((0,e0.$H)(e));if(!a)throw Error("Block ".concat(e," not found"));return null!=(t=null==(n=o.find(e=>e.blockId===a.id))?void 0:n.total)?t:0};var t6=n(55345),t7=n(91621),t8=n(9541);let ie=function(e){let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=tH(e,{x:e.x+(l?ii+il.width/2:ii),y:e.y+(l?it:0)});return(0,tK.Nh)("M".concat(e.x,",").concat(e.y," ").concat(n),f.wX).path},il={width:100,height:55},it=80,ii=30,io=e=>{var l;let{edgesWithTotalUsers:n,totalAnswers:t,blockId:o,onUnlockProPlanClick:s}=e,{workspace:r}=(0,eT.h)(),{publishedTypebot:d}=(0,a.V)(),u=(0,m.useMemo)(()=>{var e,l;return null==d||null==(l=d.groups.flatMap(e=>e.blocks))||null==(e=l.find((0,e0.$H)(o)))?void 0:e.id},[o,null==d?void 0:d.groups]),c=null==d||null==(l=d.groups.find(e=>e.blocks.some(e=>e.id===u)))?void 0:l.id,p=(0,k.r)((0,j.k)(e=>c&&e.elementsCoordinates?e.elementsCoordinates[c]:void 0)),{sourceEndpointYOffsets:h}=tC(),x=(0,t6.N)(r),{totalDroppedUser:v,dropOffRate:g,totalUsersAtBlock:y}=(0,m.useMemo)(()=>{if(!d||!u)return{};let e=t5(u,{publishedTypebot:d,edgesWithTotalUsers:n,totalAnswers:t}),l=t9(u,{publishedTypebot:d,totalAnswers:t});if(0===e)return{};let i=e-l;return{totalDroppedUser:i,dropOffRate:Math.round(i/e*100),totalUsersAtBlock:e}},[u,d,t,n]),I=(0,m.useMemo)(()=>{var e,l,n;let t=u?null==(e=h.get(u))?void 0:e.y:void 0;if(t)return t;let i=null==d?void 0:d.groups.flatMap(e=>e.blocks).find(e=>e.id===u);if(!i||!(0,b.mr)(i))return 0;let o=null==(l=i.items.at(-1))?void 0:l.id;return o?null==(n=h.get(o))?void 0:n.y:0},[u,null==d?void 0:d.groups,h]),C=(0,m.useMemo)(()=>{if(c&&p)return tX({sourcePosition:p,sourceTop:null!=I?I:0,elementWidth:f.mI})},[c,p,I]),E=(0,m.useMemo)(()=>{var e;if(!d)return!1;let l=null==(e=d.groups.find(e=>e.blocks.some(e=>e.id===u)))?void 0:e.blocks.at(-1);return(null==l?void 0:l.id)===u},[d,u]);return!C||(0,e0.pN)(g)?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:ie({x:C.x,y:C.y},E),stroke:t7.w4.colors.red[500],strokeWidth:2*(1-(null!=g?g:0)/100)+(null!=g?g:0)/100*20,fill:"none"}),(0,i.jsx)("foreignObject",{width:il.width,height:il.height,x:C.x+ii,y:C.y+(E?it:-(il.height/2)),children:(0,i.jsx)(tS.m,{label:x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eI.E,{children:["\uD83D\uDC40 Displayed ",y," times."]}),(0,i.jsx)(eI.E,{children:0===v?null:(0,i.jsxs)(i.Fragment,{children:["\uD83D\uDEB6 ",v," user",(null!=v?v:0)>1?"s":""," left."]})}),(0,i.jsxs)(eI.E,{children:["\uD83D\uDCA5 Drop-off rate: ",g,"%"]})]}):"Upgrade your plan to PRO to reveal drop-off rate.",placement:"top",children:(0,i.jsxs)(t8.T,{"data-testid":"dropoff-edge-".concat(o),bgColor:t7.w4.colors.red[500],color:"white",rounded:"md",p:"2",justifyContent:"center",w:"full",h:"full",onClick:x?void 0:s,cursor:x?"auto":"pointer",spacing:.5,children:[(0,i.jsxs)(eI.E,{filter:x?"":"blur(2px)",fontSize:"sm",children:[x?g:(0,i.jsx)(eI.E,{as:"span",filter:"blur(2px)",children:"X"}),"%"]}),(0,i.jsxs)(nV.vw,{colorScheme:"red",size:"sm",children:[x?v:(0,i.jsx)(eI.E,{as:"span",filter:"blur(3px)",mr:"1",children:"NN"})," ","user",(null!=v?v:2)>1?"s":""]})]})})})]})},ia=e=>{let{isOpen:l,onClose:n,position:t,onDeleteEdge:o}=e;return(0,i.jsxs)(U.W,{isOpen:l,gutter:0,onClose:n,isLazy:!0,children:[(0,i.jsx)(z.I,{"aria-hidden":!0,w:1,h:1,pos:"absolute",style:{left:t.x,top:t.y}}),(0,i.jsx)(ts.c,{children:(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.uc,{}),onClick:o,children:"Delete"})})]})},is=e=>{let{edge:l,fromElementId:n}=e,t="dark"===(0,M.G6)().colorMode,{deleteEdge:o}=(0,a.V)(),{previewingEdge:s,graphPosition:r,isReadOnly:d,setPreviewingEdge:c}=(0,w.u)(),{sourceEndpointYOffsets:p,targetEndpointYOffsets:h}=tC(),b=(0,k.r)((0,j.k)(e=>n&&e.elementsCoordinates?e.elementsCoordinates[n]:void 0)),x=(0,k.r)((0,j.k)(e=>e.elementsCoordinates?e.elementsCoordinates[l.to.groupId]:void 0)),[v,g]=(0,m.useState)(!1),{isOpen:y,onOpen:I,onClose:C}=(0,eV.j)(),[E,S]=(0,m.useState)({x:0,y:0}),V=v||(null==s?void 0:s.id)===l.id,A=(0,m.useMemo)(()=>{var e,n,t;let i="eventId"in l.from?l.from.eventId:null!=(t=null!=(n=null==l?void 0:l.from.pathId)?n:null==l?void 0:l.from.itemId)?t:null==l?void 0:l.from.blockId;if(i)return null==(e=p.get(i))?void 0:e.y},[l.from,p]),B=(0,m.useMemo)(()=>{if(0!==h.size&&l.to.blockId){let e=h.get(l.to.blockId);return e?e.y:void o(l.id)}},[o,l.id,l.to.blockId,h]),R=(0,m.useMemo)(()=>b&&x&&A?tZ(tq({sourceGroupCoordinates:b,targetGroupCoordinates:x,elementWidth:"eventId"in l.from?f.tq:f.mI,sourceTop:A,targetTop:B,graphScale:r.scale})):"",[b,x,A,l.from,B,r.scale]);return(0,T.K)({backspace:()=>{!d&&V&&o(l.id)}}),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{"data-testid":"clickable-edge",d:R,strokeWidth:"18px",stroke:"white",fill:"none",pointerEvents:"stroke",style:{cursor:"pointer",visibility:"hidden"},onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),onClick:()=>{c(l)},onContextMenu:e=>{d||(e.preventDefault(),S({x:e.clientX,y:e.clientY}),I())}}),(0,i.jsx)("path",{"data-testid":"edge",d:R,stroke:V?"var(--chakra-colors-orange-400)":t?tU.T.gray[700]:tU.T.gray[400],strokeWidth:"2px",markerEnd:V?"url(#orange-arrow)":"url(#arrow)",fill:"none",pointerEvents:"none"}),(0,i.jsx)(u.Z,{children:(0,i.jsx)(ia,{isOpen:y,position:E,onDeleteEdge:()=>o(l.id),onClose:C})})]})},ir=e=>{let{edges:l,groups:n,inputBlockIds:t,edgesWithTotalUsers:o,totalAnswers:a,onUnlockProPlanClick:s}=e,{connectingIds:r}=(0,w.u)(),d="dark"===(0,M.G6)().colorMode;return(0,i.jsxs)(tW.B.svg,{width:"full",height:"full",overflow:"visible",pos:"absolute",left:"0",top:"0",shapeRendering:"geometricPrecision",children:[r&&(0,i.jsx)(t4,{connectingIds:r}),l.map(e=>{var l;return(0,i.jsx)(is,{edge:e,fromElementId:"blockId"in e.from?null==(l=n.find(l=>l.blocks.some(l=>l.id===e.from.blockId)))?void 0:l.id:e.from.eventId},e.id)}),o&&a&&t.map(e=>(0,i.jsx)(io,{blockId:e,edgesWithTotalUsers:o,totalAnswers:a,onUnlockProPlanClick:s},e)),(0,i.jsx)("marker",{id:"arrow",refX:"8",refY:"4",orient:"auto",viewBox:"0 0 20 20",markerUnits:"userSpaceOnUse",markerWidth:"20",markerHeight:"20",children:(0,i.jsx)("path",{d:"M7.07138888,5.50174526 L2.43017246,7.82235347 C1.60067988,8.23709976 0.592024983,7.90088146 0.177278692,7.07138888 C0.0606951226,6.83822174 0,6.58111307 0,6.32042429 L0,1.67920787 C0,0.751806973 0.751806973,0 1.67920787,0 C1.93989666,0 2.19700532,0.0606951226 2.43017246,0.177278692 L7,3 C7.82949258,3.41474629 8.23709976,3.92128809 7.82235347,4.75078067 C7.6598671,5.07575341 7.39636161,5.33925889 7.07138888,5.50174526 Z",fill:d?tU.T.gray[600]:tU.T.gray[400]})}),(0,i.jsx)("marker",{id:"orange-arrow",refX:"8",refY:"4",orient:"auto",viewBox:"0 0 20 20",markerUnits:"userSpaceOnUse",markerWidth:"20",markerHeight:"20",children:(0,i.jsx)("path",{d:"M7.07138888,5.50174526 L2.43017246,7.82235347 C1.60067988,8.23709976 0.592024983,7.90088146 0.177278692,7.07138888 C0.0606951226,6.83822174 0,6.58111307 0,6.32042429 L0,1.67920787 C0,0.751806973 0.751806973,0 1.67920787,0 C1.93989666,0 2.19700532,0.0606951226 2.43017246,0.177278692 L7,3 C7.82949258,3.41474629 8.23709976,3.92128809 7.82235347,4.75078067 C7.6598671,5.07575341 7.39636161,5.33925889 7.07138888,5.50174526 Z",fill:"var(--chakra-colors-orange-400)"})})]})};var id=n(63015),iu=n(38831),ic=n(78334);let ip=function(){let{enabled:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enabled:!0},[l,n]=(0,m.useState)(!1),[t,i]=(0,m.useState)(!1);return(0,m.useEffect)(()=>{if(e)if(l){let e=setTimeout(()=>{i(!0)},500);return()=>clearTimeout(e)}else{let e=setTimeout(()=>{i(!1)},300);return()=>clearTimeout(e)}},[l,e]),{isExpanded:t,isHovered:l,onHover:()=>{e&&n(!0)},onLeave:()=>{e&&n(!1)},onAbort:()=>{e&&(n(!1),i(!1))}}},ih=(0,m.forwardRef)((e,l)=>{let{isVisible:n,isExpanded:t,initialHeightPixels:o=8,expandedHeightPixels:a=36,initialPaddingPixel:s=0,expandedPaddingPixel:r=6,children:u,onClick:c,...p}=e,{isExpanded:h,isHovered:b,onHover:x,onLeave:v,onAbort:m}=ip({enabled:(0,e0.O9)(c)});return(0,i.jsxs)(d.s,{role:"button",ref:l,onMouseEnter:x,onMouseLeave:v,fontWeight:"semibold",fontSize:"small",justify:"center",align:"center",onMouseUpCapture:m,onClick:c,pos:"relative",py:t||h?r+"px":s+"px",...p,children:[c&&(0,i.jsx)(tW.B.span,{pos:"absolute",w:"full",left:"0",zIndex:1}),(0,i.jsx)(d.s,{bgColor:(0,M.dU)("gray.200","gray.800"),w:"full",rounded:"lg",justify:"center",align:"center",opacity:n||b?1:0,h:t||h?a+"px":o+"px",transition:(0,e0.O9)(c)||n?"opacity 200ms, height 200ms":"opacity 200ms",children:b&&h?u:null})]})});ih.displayName="PlaceholderNode";var ib=n(49987),ix=n(21638),iv=n(39699),im=n(2747);let ig={placement:"bottom-start",middleware:[(0,iv.cY)(12),(0,iv.UU)({padding:12,fallbackPlacements:["bottom-end","top-start","top-end"]})]};var ij=n(45992),iy=n(32164);let iI=e=>({flex:1,padding:"1rem",backgroundColor:e,borderRadius:"0.25rem",outline:"none"}),iC=(0,iy.nkb)([(0,ij.NM)(),(0,ij.Ey)(),(0,ij.Ez)(),(0,im.Kn)({renderAfterEditable:function(e){let{state:l}=e,n=(0,M.dU)("white","gray.900"),t=(0,m.useRef)(null),o=(0,im.e)({...l,floatingOptions:{...ig,...null==l?void 0:l.floatingOptions}}),{props:a,ref:s,hidden:r,textInputProps:d}=(0,im.lj)(o),{props:u}=(0,im.pk)({ref:t}),c=(0,im.dX)({...l,floatingOptions:{...ig,...null==l?void 0:l.floatingOptions}}),{props:p,ref:h,editButtonProps:b,unlinkButtonProps:x}=(0,im.Ol)(c);if(r)return null;let v=(0,i.jsxs)(Z.B,{w:"330px",px:"4",py:"2",rounded:"md",borderWidth:1,shadow:"md",bgColor:n,children:[(0,i.jsxs)(nX.M,{children:[(0,i.jsx)(nq.W,{pointerEvents:"none",children:(0,i.jsx)(S.qY,{color:"gray.300"})}),(0,i.jsx)(la.p,{ref:t,placeholder:"Paste link",defaultValue:u.defaultValue,onChange:u.onChange})]}),(0,i.jsx)(ix.c,{}),(0,i.jsxs)(nX.M,{children:[(0,i.jsx)(nq.W,{pointerEvents:"none",children:(0,i.jsx)(ib.N,{color:"gray.300"})}),(0,i.jsx)(la.p,{placeholder:"Text to display",...d})]})]}),g=c.isEditing?v:(0,i.jsxs)(V.z,{bgColor:"white",p:"2",rounded:"md",borderWidth:1,shadow:"md",align:"center",children:[(0,i.jsx)(A.$,{...b,size:"sm",children:"Edit link"}),(0,i.jsx)(ix.c,{orientation:"vertical",h:"20px"}),(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.xP,{}),"aria-label":"Unlink",size:"sm",...x})]});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{ref:s,...a,children:v}),(0,i.jsx)("div",{ref:h,...p,children:g})]})},options:{isUrl:e=>e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("tel:")||e.startsWith("sms:"),forceSubmit:!0}})],{components:{[im.OW]:e=>(0,i.jsx)("a",{href:e.element.url,target:"_blank",rel:"noreferrer",className:e.className,children:e.children})}});var ik=n(98183),iE=n(62477),iw=n(59138);let iS=e=>{let{...l}=e,n=(0,im._M)(),{props:t}=(0,im.j6)(n);return(0,i.jsx)(B.K,{size:"sm",variant:t.pressed?"outline":"ghost",colorScheme:t.pressed?"blue":void 0,...t,...l})},iT=e=>{let{clear:l,nodeType:n,...t}=e,o=(0,iw.l4)({clear:l,nodeType:n}),{props:a}=(0,iw._K)(o);return(0,i.jsx)(B.K,{size:"sm",variant:a.pressed?"outline":"ghost",colorScheme:a.pressed?"blue":void 0,...a,...t})},iV=e=>{let{onVariablesButtonClick:l,...n}=e,t=(0,iy.Q_O)();return(0,i.jsxs)(V.z,{bgColor:(0,M.dU)("white","gray.900"),borderTopRadius:"md",p:2,w:"full",boxSizing:"border-box",borderBottomWidth:1,...n,children:[(0,i.jsx)(B.K,{"aria-label":"Insert variable",size:"sm",onMouseDown:e=>{e.stopPropagation(),e.preventDefault(),l()},icon:(0,i.jsx)(S.cZ,{})}),(0,i.jsx)("span",{"data-testid":"bold-button",children:(0,i.jsx)(iT,{nodeType:(0,iy.Ql$)(t,ij.e5),icon:(0,i.jsx)(S.$o,{}),"aria-label":"Toggle bold"})}),(0,i.jsx)("span",{"data-testid":"italic-button",children:(0,i.jsx)(iT,{nodeType:(0,iy.Ql$)(t,ij.lM),icon:(0,i.jsx)(S.yO,{}),"aria-label":"Toggle italic"})}),(0,i.jsx)("span",{"data-testid":"underline-button",children:(0,i.jsx)(iT,{nodeType:(0,iy.Ql$)(t,ij.Jd),icon:(0,i.jsx)(S.qp,{}),"aria-label":"Toggle underline"})}),(0,i.jsx)("span",{"data-testid":"link-button",children:(0,i.jsx)(iS,{icon:(0,i.jsx)(S.qY,{}),"aria-label":"Add link"})})]})},iM=e=>{let{closeEditor:l}=e,{t:n}=(0,$.WD)(),t=(0,iy.Q_O)(),[o,a]=(0,m.useState)(!1),[s,r]=(0,m.useState)(!0),c=(0,m.useRef)(null),p=(0,m.useRef)(null),h=(0,m.useRef)(null),b=(0,m.useRef)(null);(0,lS.j)({ref:h,handler:l});let x=(0,m.useCallback)(()=>{if(p.current)return{top:0,left:0};let e=window.getSelection(),l=h.current;if(!e||!l)return{top:0,left:0};let n=e.getRangeAt(0).getBoundingClientRect(),t=l.getBoundingClientRect();return{top:n.bottom-t.top,left:n.left-t.left}},[]);return(0,m.useEffect)(()=>{if(!o)return;let e=c.current;if(!e)return;let{top:l,left:n}=x();(0!==l||0!==n)&&(e.style.top="".concat(l,"px"),e.style.left="".concat(n,"px"))},[x,o]),(0,i.jsxs)(Z.B,{flex:"1",ref:h,borderWidth:"2px",borderColor:(0,M.dU)("orange.400","orange.300"),rounded:"md",pos:"relative",spacing:0,cursor:"text",className:"prevent-group-drag",onContextMenuCapture:e=>e.stopPropagation(),sx:{".slate-ToolbarButton-active":{color:(0,M.dU)("blue.500","blue.300")+" !important"},'[class^="PlateFloatingLink___Styled"]':{"--tw-bg-opacity":(0,M.dU)("1",".1")+"!important",backgroundColor:(0,M.dU)("white","gray.900"),borderRadius:"md",transitionProperty:"background-color",transitionDuration:"normal"},'[class^="FloatingVerticalDivider___"]':{"--tw-bg-opacity":(0,M.dU)("1",".4")+"!important"},".slate-a":{color:(0,M.dU)("blue.500","blue.300")}},children:[(0,i.jsx)(iV,{onVariablesButtonClick:()=>a(!0)}),(0,i.jsx)(iy.wPc,{ref:b,onKeyDown:e=>{!e.shiftKey&&"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&l()},style:iI((0,M.dU)("white",tU.T.gray[900])),autoFocus:!0,onClick:()=>{a(!1)},onFocus:()=>{p.current=null,s&&t&&0!==t.children.length&&((0,iw.uk)(t,{edge:"end"}),r(!1))},onBlur:()=>{t&&(p.current=t.selection)},"aria-label":"Text editor"}),(0,i.jsxs)(lT.A,{isOpen:o,isLazy:!0,children:[(0,i.jsx)(lV.d,{children:(0,i.jsx)(d.s,{pos:"absolute",ref:c})}),(0,i.jsx)(u.Z,{children:(0,i.jsx)(lM.h,{children:(0,i.jsx)(J.x,{initialVariableId:void 0,onSelectVariable:e=>{a(!1),e&&((0,ik.u9)(t),(0,iE.bc)(t,"{{"+e.name+"}}"))},placeholder:n("editor.blocks.bubbles.textEditor.searchVariable.placeholder"),autoFocus:!0})})})]})]})},iA=e=>{let{id:l,initialValue:n,onChange:t,onClose:o}=e,a=(0,m.useRef)(n);return(0,m.useEffect)(()=>()=>{t(a.current)},[t]),(0,i.jsx)(iy.T6o,{id:l,plugins:iC,initialValue:0===n.length?[{type:"p",children:[{text:""}]}]:n,onChange:e=>{a.current=e},children:(0,i.jsx)(iM,{closeEditor:o})})},iB=e=>{var l,n,t;return!(0,b.Ag)(e)&&!(0,b.Uk)(e)&&!(0,b.Rr)(e)&&!(0,b.UV)(e)&&e.type!==ti.G.AB_TEST||e.type===es.iQ.CHOICE&&(0,e0.O9)(null==(l=e.options)?void 0:l.dynamicVariableId)||e.type===es.iQ.PICTURE_CHOICE&&(null==(t=e.options)||null==(n=t.dynamicItems)?void 0:n.isEnabled)&&e.options.dynamicItems.pictureSrcsVariableId};var iR=n(31078),iO=n(70914);let iD=e=>{var l,n;let{source:t,groupId:o,isHidden:a,...s}=e,u=null!=(n=null!=(l=t.pathId)?l:t.itemId)?n:t.blockId,c=(0,M.dU)("orange.200","orange.100"),p=(0,M.dU)("orange.300","orange.200"),h=(0,M.dU)("white","gray.700"),{setConnectingIds:b,previewingEdge:x,graphPosition:v}=(0,w.u)(),{setSourceEndpointYOffset:g,deleteSourceEndpointYOffset:j}=tC(),f=(0,m.useRef)(null),[y,I]=(0,m.useState)(),[C,k]=(0,m.useState)(),E=(0,m.useMemo)(()=>{var e;return f.current?Number((((null==(e=f.current)?void 0:e.getBoundingClientRect().y)+32*v.scale/2-v.y)/v.scale).toFixed(2)):void 0},[v.scale,v.y,y,C]);return(0,m.useLayoutEffect)(()=>{let e=new ResizeObserver(e=>{I(e[0].contentRect.height)}),l=document.getElementById("group-".concat(o));if(l)return e.observe(l),()=>{e.disconnect()}},[o]),(0,m.useLayoutEffect)(()=>{let e=new MutationObserver(e=>{k(e[0].target.style.transform)}),l=document.getElementById("group-".concat(o));if(l)return e.observe(l,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[o]),(0,m.useEffect)(()=>{E&&(null==g||g({id:u,y:E}))},[g,E,u]),(0,m.useEffect)(()=>()=>{null==j||j(u)},[j,u]),(0,r.M)("pointerdown",e=>{e.stopPropagation(),o&&b({source:{...t,groupId:o}})},f.current),(0,r.M)("mousedown",e=>{e.stopPropagation()},f.current),(0,i.jsx)(d.s,{ref:f,"data-testid":"endpoint",boxSize:"32px",rounded:"full",cursor:"copy",justify:"center",align:"center",pointerEvents:"all",visibility:a?"hidden":"visible",...s,children:(0,i.jsx)(d.s,{boxSize:"20px",justify:"center",align:"center",bg:h,borderWidth:1,rounded:"full",children:(0,i.jsx)(d.s,{boxSize:"13px",rounded:"full",borderWidth:"3.5px",shadow:"sm",borderColor:x&&"blockId"in x.from&&x.from.blockId===t.blockId&&x.from.itemId===t.itemId&&x.from.pathId===t.pathId?p:c})})})},iL=e=>{let{groupId:l,blockId:n,...t}=e,{setTargetEnpointYOffset:o}=tC(),{graphPosition:a}=(0,w.u)(),s=(0,m.useRef)(null),[r,d]=(0,m.useState)(),[u,c]=(0,m.useState)(),h=(0,m.useMemo)(()=>{var e;return s.current?Number((((null==(e=s.current)?void 0:e.getBoundingClientRect().y)+20*a.scale/2-a.y)/a.scale).toFixed(2)):void 0},[a.scale,a.y,r,u]);return(0,m.useLayoutEffect)(()=>{let e=new ResizeObserver(e=>{d(e[0].contentRect.height)}),n=document.getElementById("group-".concat(l));if(n)return e.observe(n),()=>{e.disconnect()}},[l]),(0,m.useLayoutEffect)(()=>{let e=new MutationObserver(e=>{c(e[0].target.style.transform)}),n=document.getElementById("group-".concat(l));if(n)return e.observe(n,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[l]),(0,m.useEffect)(()=>{h&&(null==o||o({id:n,y:h}))},[o,n,h]),(0,i.jsx)(p.az,{ref:s,boxSize:"20px",rounded:"full",bgColor:"orange.500",cursor:"pointer",visibility:"hidden",...t})},iP=e=>{let{variableName:l}=e;return(0,i.jsx)(tW.B.span,{bgColor:"purple.600",color:"white",rounded:"md",py:"0.5",px:"1",wordBreak:"break-all",children:l})},iN=e=>l=>{if(!l||!l.startsWith("{{")||!l.endsWith("}}"))return null;let n=l.slice(2,-2),t=e.find(e=>e.name===n);return null!=t?t:null},iG=e=>{let{url:l}=e,{typebot:n}=(0,a.V)(),{t}=(0,$.WD)(),o=n?iN(null==n?void 0:n.variables)(l):null;return(0,e0.O9)(l)?o?(0,i.jsxs)(eI.E,{children:["Play ",(0,i.jsx)(iP,{variableName:o.name})]}):(0,i.jsx)(tW.B.audio,{src:l,controls:!0,maxW:"calc(100% - 25px)",rounded:"md"}):(0,i.jsx)(eI.E,{color:"gray.500",children:t("clickToEdit")})},iW=e=>{var l,n;let{block:t}=e,{typebot:o}=(0,a.V)(),{t:s}=(0,$.WD)();return(null==(l=t.content)?void 0:l.url)?(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{children:s("editor.blocks.bubbles.embed.node.show.text")}),o&&(null==(n=t.content.waitForEvent)?void 0:n.isEnabled)&&t.content.waitForEvent.saveDataInVariableId&&(0,i.jsx)(tR,{variables:o.variables,variableId:t.content.waitForEvent.saveDataInVariableId})]}):(0,i.jsx)(eI.E,{color:"gray.500",children:s("clickToEdit")})};var iU=n(30083);let iz=e=>{var l,n,t,o;let{block:s}=e,{typebot:r}=(0,a.V)(),{t:d}=(0,$.WD)(),u=r?iN(null==r?void 0:r.variables)(null==(l=s.content)?void 0:l.url):null;return(null==(n=s.content)?void 0:n.url)?u?(0,i.jsxs)(eI.E,{children:["Display ",(0,i.jsx)(iP,{variableName:u.name})]}):(0,i.jsx)(p.az,{w:"full",children:(0,i.jsx)(iU._,{pointerEvents:"none",src:null==(t=s.content)?void 0:t.url,alt:"Group image",maxH:(null==(o=s.content)?void 0:o.url.startsWith("data:image/svg"))?"80px":void 0,rounded:"md",objectFit:"cover"})}):(0,i.jsx)(eI.E,{color:"gray.500",children:d("clickToEdit")})},iF=e=>{let{text:l,bold:n,italic:t,underline:o}=e,a="";return(n&&(a+="slate-bold"),t&&(a+=" slate-italic"),o&&(a+=" slate-underline"),a)?(0,i.jsx)("span",{className:a,children:(0,i.jsx)(iK,{text:l})}):(0,i.jsx)(iK,{text:l})},iK=e=>{let{text:l}=e,{typebot:n}=(0,a.V)();return(0,i.jsx)(i.Fragment,{children:l.split(/\{\{=(.*?=\}\})/g).map((e,l)=>e.endsWith("=}}")?(0,i.jsx)("span",{className:"slate-inline-code",children:e.trim().slice(0,-3)},l):e.split(/\{\{(.*?\}\})/g).map((e,l)=>{if(e.endsWith("}}")){let t=e.trim().slice(0,-2);return(null==n?void 0:n.variables.find(e=>e.name===t))?(0,i.jsx)("span",{className:"slate-variable",children:e.trim().slice(0,-2)},l):"{{"+e}return e}))})},i_=e=>{var l,n;let{element:t}=e;return t.text?(0,i.jsx)(iF,{...t}):"a"===t.type?(0,i.jsx)("a",{href:t.url,target:"_blank",className:"slate-a",rel:"noreferrer",children:null==(l=t.children)?void 0:l.map((e,l)=>(0,i.jsx)(i_,{element:e},l))}):(0,i.jsx)("div",{children:null==(n=t.children)?void 0:n.map((e,l)=>(0,i.jsx)(i_,{element:e},l))})},iH=e=>{var l,n,t,o,a;let{block:s}=e,r=(null!=(a=null==(n=s.content)||null==(l=n.richText)?void 0:l.length)?a:0)===0;return(0,i.jsx)(d.s,{w:"90%",flexDir:"column",opacity:r?"0.5":"1",className:"slate-html-container",color:r?"gray.500":"inherit",children:null==(o=s.content)||null==(t=o.richText)?void 0:t.map((e,l)=>(0,i.jsx)(i_,{element:e},l))})};var iQ=n(74344);let iY=e=>{var l,n,t;let{block:o}=e,{typebot:s}=(0,a.V)(),{t:r}=(0,$.WD)();if(!(null==(l=o.content)?void 0:l.url)||!o.content.type)return(0,i.jsx)(eI.E,{color:"gray.500",children:r("clickToEdit")});let d=s?iN(null==s?void 0:s.variables)(null==(n=o.content)?void 0:n.url):null;switch(o.content.type){case iQ.z4.URL:return(0,i.jsx)(p.az,{w:"full",h:d?void 0:" 120px",pos:"relative",children:d?(0,i.jsxs)(eI.E,{children:["Display ",(0,i.jsx)(iP,{variableName:d.name})]}):(0,i.jsx)("video",{controls:null==(t=o.content)?void 0:t.areControlsDisplayed,style:{width:"100%",height:"100%",position:"absolute",left:"0",top:"0",borderRadius:"10px"},children:(0,i.jsx)("source",{src:o.content.url})},o.content.url)});case iQ.z4.GUMLET:case iQ.z4.VIMEO:case iQ.z4.YOUTUBE:{let e=iQ.he[o.content.type];return(0,i.jsx)(p.az,{w:"full",h:"120px",pos:"relative",children:(0,i.jsx)("iframe",{src:"".concat(e,"/").concat(o.content.id),style:{width:"100%",height:"100%",position:"absolute",left:"0",top:"0",borderRadius:"10px",pointerEvents:"none"}})})}case iQ.z4.TIKTOK:return(0,i.jsx)(p.az,{w:"full",h:"300px",pos:"relative",children:(0,i.jsx)("iframe",{src:"https://www.tiktok.com/embed/v2/".concat(o.content.id),style:{width:"100%",height:"100%",position:"absolute",left:"0",top:"0",borderRadius:"10px",pointerEvents:"none"}})})}};var iJ=n(39199);let iZ={logicalOperator:lt.u.AND},iX=e=>{var l;let{condition:n,variables:t,size:o="sm",displaySemicolon:a}=e,{t:s}=(0,$.WD)(),r=(0,M.dU)("gray.200","gray.700");return(0,i.jsx)(Z.B,{children:null==n||null==(l=n.comparisons)?void 0:l.map((e,l)=>{var d,u,c;let p=t.find((0,e0.$H)(e.variableId));return(0,i.jsxs)(iJ.B,{spacing:1,noOfLines:1,children:[0===l&&(0,i.jsx)(eI.E,{fontSize:o,children:s("blocks.inputs.button.conditionContent.if.label")}),l>0&&(0,i.jsx)(eI.E,{fontSize:o,children:null!=(u=n.logicalOperator)?u:iZ.logicalOperator}),(null==p?void 0:p.name)&&(0,i.jsx)(nV.vw,{bgColor:"purple.400",color:"white",size:"sm",wordBreak:"break-all",children:p.name}),e.comparisonOperator&&(0,i.jsx)(eI.E,{fontSize:o,children:iq(e.comparisonOperator)}),(null==e?void 0:e.value)&&e.comparisonOperator!==lt.J.IS_SET&&e.comparisonOperator!==lt.J.IS_EMPTY&&(0,i.jsx)(nV.vw,{bgColor:r,size:"sm",children:e.value}),l===(null!=(c=null==(d=n.comparisons)?void 0:d.length)?c:0)-1&&a&&(0,i.jsx)(eI.E,{fontSize:o,children:":"})]},e.id)})})},iq=e=>{switch(e){case lt.J.CONTAINS:return"contains";case lt.J.EQUAL:return"=";case lt.J.GREATER:return">";case lt.J.IS_SET:return"is set";case lt.J.LESS:return"<";case lt.J.NOT_EQUAL:return"!=";case lt.J.ENDS_WITH:return"ends with";case lt.J.STARTS_WITH:return"starts with";case lt.J.IS_EMPTY:return"is empty";case lt.J.NOT_CONTAINS:return"not contains";case lt.J.MATCHES_REGEX:return"matches";case lt.J.NOT_MATCH_REGEX:return"not matches";case lt.J.GREATER_OR_EQUAL:return">=";case lt.J.LESS_OR_EQUAL:return"<="}};var i$=n(2057),i0=n(34809);let i1=e=>{var l;let{item:n,onItemChange:t}=e,{t:o}=(0,$.WD)();return(0,i.jsxs)(Z.B,{p:"4",rounded:"md",flex:"1",borderWidth:"1px",children:[(0,i.jsx)(J.x,{initialVariableId:n.variableId,onSelectVariable:e=>{(null==e?void 0:e.id)!==n.variableId&&t({...n,variableId:null==e?void 0:e.id})},placeholder:o("variables.search")}),(0,i.jsx)(en.Q,{currentItem:n.comparisonOperator,onItemSelect:e=>{e!==n.comparisonOperator&&t({...n,comparisonOperator:e})},items:Object.values(lt.J),placeholder:o("blocks.inputs.button.buttonSettings.displayCondition.selectOperator.label")}),n.comparisonOperator!==lt.J.IS_SET&&n.comparisonOperator!==lt.J.IS_EMPTY&&(0,i.jsx)(Q.ks,{defaultValue:null!=(l=n.value)?l:"",onChange:e=>{e!==n.value&&t({...n,value:e})},placeholder:i2(n.comparisonOperator)})]})},i2=e=>{switch(e){case lt.J.NOT_EQUAL:case lt.J.EQUAL:case lt.J.CONTAINS:case lt.J.STARTS_WITH:case lt.J.ENDS_WITH:case lt.J.NOT_CONTAINS:case void 0:return"Type a value...";case lt.J.LESS:case lt.J.GREATER:case lt.J.LESS_OR_EQUAL:case lt.J.GREATER_OR_EQUAL:return"Type a number...";case lt.J.IS_SET:case lt.J.IS_EMPTY:return"";case lt.J.MATCHES_REGEX:case lt.J.NOT_MATCH_REGEX:return"/^[0-9]+$/"}},i4=e=>{let{condition:l,onConditionChange:n}=e,{t}=(0,$.WD)(),o=e=>n({...l,logicalOperator:e});return(0,i.jsx)(et.B,{initialItems:null==l?void 0:l.comparisons,onItemsChange:e=>n({...l,comparisons:e}),ComponentBetweenItems:()=>{var e;return(0,i.jsx)(d.s,{justify:"center",children:(0,i.jsx)(en.Q,{currentItem:null!=(e=null==l?void 0:l.logicalOperator)?e:iZ.logicalOperator,onItemSelect:o,items:Object.values(lt.u)})})},addLabel:t("blocks.inputs.button.buttonSettings.addComparisonButton.label"),children:e=>(0,i.jsx)(i1,{...e})})},i3=e=>{var l,n,t,o;let{item:a,onSettingsChange:s}=e,{t:r}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(H.J,{label:r("blocks.inputs.settings.displayCondition.label"),moreInfoContent:r("blocks.inputs.button.buttonSettings.displayCondition.infoText.label"),initialValue:null!=(t=null==(l=a.displayCondition)?void 0:l.isEnabled)&&t,onCheckChange:e=>s({...a,displayCondition:{...a.displayCondition,isEnabled:e}}),children:(0,i.jsx)(i4,{condition:null!=(o=null==(n=a.displayCondition)?void 0:n.condition)?o:{comparisons:[],logicalOperator:lt.u.AND},onConditionChange:e=>s({...a,displayCondition:{...a.displayCondition,condition:e}})})}),(0,i.jsx)(Q.ks,{label:r("blocks.inputs.internalValue.label"),moreInfoTooltip:r("blocks.inputs.button.buttonSettings.internalValue.helperText"),defaultValue:a.value,onChange:e=>s({...a,value:e})})]})},i5=e=>{var l;let{item:n,indices:t,isMouseOver:o}=e,{t:s}=(0,$.WD)(),{deleteItem:r,updateItem:c,createItem:p}=(0,a.V)(),{openedNodeId:h,setOpenedNodeId:b}=(0,w.u)(),[x,v]=(0,m.useState)(null!=(l=n.content)?l:0===t.itemIndex?s("blocks.inputs.button.clickToEdit.label"):""),g=(0,m.useRef)(null),j=(0,m.useRef)(null),f=(0,M.dU)("white","gray.900"),y=async e=>{"Escape"===e.key&&(x===s("blocks.inputs.button.clickToEdit.label")||""===x)&&r(t),"Enter"===e.key&&""!==x&&x!==s("blocks.inputs.button.clickToEdit.label")&&I()},I=()=>{let e=t.itemIndex+1;p({},{...t,itemIndex:e})};return(0,i.jsxs)(lT.A,{placement:"right",isLazy:!0,isOpen:h===n.id,closeOnBlur:!1,children:[(0,i.jsx)(lV.d,{children:(0,i.jsxs)(d.s,{px:4,py:2,justify:"center",w:"full",children:[(0,i.jsxs)(id.F,{ref:g,flex:"1",startWithEditView:(0,e0.Im)(n.content)||n.content===s("blocks.inputs.button.clickToEdit.label"),value:x,onChange:e=>{if(""!==x&&x!==s("blocks.inputs.button.clickToEdit.label"))return v(e);let l=(0,i0.C)(e);1===l.length?v(l[0]):(v(l[0]),l.slice(1).forEach((e,l)=>{p({content:e},{...t,itemIndex:t.itemIndex+l+1})}))},onSubmit:()=>{""===x?r(t):c(t,{content:""===x?void 0:x})},onKeyDownCapture:y,maxW:"180px",children:[(0,i.jsx)(iu.l,{w:"full",color:n.content!==s("blocks.inputs.button.clickToEdit.label")?"inherit":"gray.500",cursor:"pointer"}),(0,i.jsx)(i$.H,{onMouseDownCapture:e=>e.stopPropagation(),resize:"none",onWheelCapture:e=>e.stopPropagation()})]}),(0,i.jsx)(tn.s,{offsetY:"5px",offsetX:"-5px",in:o,style:{position:"absolute",right:"-0.25rem",top:"-0.25rem",zIndex:3},unmountOnExit:!0,children:(0,i.jsx)(d.s,{bgColor:(0,M.dU)("white","gray.900"),rounded:"md",children:(0,i.jsx)(B.K,{"aria-label":s("blocks.inputs.button.openSettings.ariaLabel"),icon:(0,i.jsx)(S.Ze,{}),variant:"ghost",size:"xs",shadow:"md",onClick:()=>b(n.id)})})})]})}),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{pos:"relative",onMouseDown:e=>e.stopPropagation(),children:[(0,i.jsx)(te.R,{bgColor:f}),(0,i.jsx)(tl.e,{py:"6",overflowY:"auto",maxH:"400px",shadow:"md",ref:j,children:(0,i.jsx)(i3,{item:n,onSettingsChange:e=>{c(t,{...n,...e})}})})]})})]})},i9=(0,m.forwardRef)((e,l)=>{let{src:n,...t}=e,{typebot:o}=(0,a.V)(),s=(0,M.dU)("gray.100","gray.700"),r=o?iN(null==o?void 0:o.variables)(n):null;return r?(0,i.jsx)(d.s,{ref:l,bgColor:s,rounded:"md",justify:"center",align:"center",...t,h:"75px",children:(0,i.jsx)(iP,{variableName:r.name})}):n?(0,i.jsx)(iU._,{ref:l,rounded:"md",userSelect:"none",draggable:!1,src:n,objectFit:"cover",...t}):(0,i.jsx)(d.s,{ref:l,bgColor:s,rounded:"md",justify:"center",align:"center",...t,children:(0,i.jsx)(S.xf,{})})});i9.displayName="ImageOrPlaceholder";var i6=n(10841);let i7=(0,m.createContext)(void 0),i8=()=>(0,m.useContext)(i7),oe=e=>{let{children:l,isExpanded:n,ghostItemHeight:t,closeExpanded:o}=e;return(0,i.jsx)(i7.Provider,{value:{isExpanded:n,ghostItemHeight:t,closeExpanded:o},children:l})},ol=(0,m.forwardRef)((e,l)=>{let{gapPixel:n,children:t,...o}=e,a=m.Children.toArray(t),s=(0,m.useMemo)(()=>{let e=[],l=[],n=!1;return a.forEach(t=>{let i=m.isValidElement(t)&&(0,e0.O9)(t.props.ghostLabel);if(!i)return void console.error("Child is not a GhostableItem",t,m.isValidElement(t));let o=i&&null===t.props.children;o&&!n||!o&&n?(l.length>0&&e.push({children:l,isNullGroup:n}),l=[t],n=o):l.push(t)}),l.length>0&&e.push({children:l,isNullGroup:n}),e},[a]);return(0,i.jsx)(Z.B,{ref:l,gap:0,...o,children:s.map((e,l)=>(0,i.jsx)(on,{gapPixel:n,groups:s,index:l,children:e.children},"".concat(e.isNullGroup,"-").concat(l)))})}),on=e=>{var l,n;let{children:t,gapPixel:o,index:a,groups:s}=e,r=null==(l=s.at(a))?void 0:l.isNullGroup,{isHovered:d,isExpanded:u,onHover:c,onLeave:p,onAbort:h}=ip({enabled:r}),b=m.Children.count(t);return(0,i.jsx)(oe,{isExpanded:u,ghostItemHeight:o/b,closeExpanded:h,children:(0,i.jsx)(Z.B,{gap:r?+!!u:o+"px",onMouseEnter:c,onMouseLeave:p,opacity:!r||d?1:0,transition:"opacity 0.2s ease",mb:r&&(null==(n=s.at(a+1))?void 0:n.isNullGroup)?o+"px":void 0,children:t})})},ot=e=>{let{children:l,ghostLabel:n,onGhostClick:t}=e,o=i8();if(!o)throw Error("GhostableItem must be used within StackWithGhostableItems");let{isExpanded:a,ghostItemHeight:s,closeExpanded:r}=o;return(0,i.jsx)(i.Fragment,{children:null===l?(0,i.jsx)(A.$,{h:a?"24px":s+"px",transition:"all 0.2s ease",fontSize:"12px",onClick:()=>{null==t||t(),r()},children:a?n:null}):l})};ol.displayName="StacksWithGhostableItems",ot.displayName="GhostableItem",on.displayName="StackWithGhostableItems";var oi=n(99279),oo=n(24092),oa=n(52719),os=n(37827),or=n(84974),od=n(21614);let ou=(0,m.forwardRef)((e,l)=>{let{colorMode:n}=(0,M.G6)();return(0,i.jsx)(oi.N,{ref:l,autoResize:!1,...e,className:(0,od.cn)("dark"===n&&"dark",e.className)})}),oc=(0,m.forwardRef)((e,l)=>{let{className:n,...t}=e;return(0,i.jsx)(oo.C,{ref:l,className:(0,od.cn)("w-full flex",n),...t})}),op=(0,m.forwardRef)((e,l)=>{let{className:n,...t}=e;return(0,i.jsx)(oa.j,{ref:l,className:(0,od.cn)((0,or.j)({variant:"noSize"}),"px-[3px] py-[3px] font-inherit text-align-inherit",n),...t})}),oh=(0,m.forwardRef)((e,l)=>{let{className:n,...t}=e,o=(0,m.useRef)(null),a=e=>{e&&(e.style.height="auto",e.style.height="".concat(e.scrollHeight+20,"px"))};return(0,r.M)("wheel",e=>{e.stopPropagation()},o.current),(0,i.jsx)(oa.j,{ref:l,...t,asChild:!0,children:(0,i.jsx)("textarea",{ref:o,className:(0,od.cn)((0,or.j)({variant:"noSize"}),"px-[3px] py-[3px] font-inherit text-align-inherit",n),onFocus:e=>a(e.currentTarget)})})}),ob={Root:ou,Area:oc,Input:op,Preview:(0,m.forwardRef)((e,l)=>{let{className:n,style:t,isMultiLine:o,...a}=e;return(0,i.jsx)(os.l,{ref:l,className:(0,od.cn)("cursor-pointer rounded-md hover:bg-gray-3 transition-colors p-1 w-full",n),style:{...t,whiteSpace:"pre-line"},...a})}),Textarea:oh},ox=e=>{var l,n,t,o,a;let{options:s,onSettingsChange:r}=e,{t:d}=(0,$.WD)();return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsx)(H.J,{label:d("blocks.inputs.settings.displayCondition.label"),moreInfoContent:d("blocks.inputs.button.buttonSettings.displayCondition.infoText.label"),initialValue:null!=(t=null==s||null==(l=s.displayCondition)?void 0:l.isEnabled)&&t,onCheckChange:e=>r({...s,displayCondition:{...null==s?void 0:s.displayCondition,isEnabled:e}}),children:(0,i.jsx)(i4,{condition:null!=(o=null==s||null==(n=s.displayCondition)?void 0:n.condition)?o:{comparisons:[],logicalOperator:lt.u.AND},onConditionChange:e=>r({...s,displayCondition:{...null==s?void 0:s.displayCondition,condition:e}})})}),(0,i.jsx)(e_.k,{label:d("blocks.inputs.internalValue.label"),moreInfoTooltip:d("blocks.inputs.button.buttonSettings.internalValue.helperText"),defaultValue:null!=(a=null==s?void 0:s.internalValue)?a:void 0,onChange:e=>r({...s,internalValue:e})})]})},ov=e=>{var l,n,t,o,s;let{item:r,indices:c,isMouseOver:p,blockId:b,groupId:x}=e,{t:v}=(0,$.WD)(),{typebot:g}=(0,a.V)(),{updateItem:j,deleteItemPath:f}=(0,a.V)(),{openedNodeId:y,setOpenedNodeId:I}=(0,w.u)(),C=(0,m.useRef)(null),k=(0,M.dU)("white","gray.900"),E=e=>{j(c,{title:e})},T=e=>{j(c,{description:e})},V=e=>{j(c,{...r,imageUrl:e})},A=e=>{f({...c,pathIndex:e})},R=(e,l)=>{var n;j(c,{paths:null==(n=r.paths)?void 0:n.map((n,t)=>t===e?{...n,text:l}:n)})};return(0,i.jsxs)(lT.A,{placement:"right",isLazy:!0,isOpen:y===r.id,closeOnBlur:!1,children:[(0,i.jsx)(lV.d,{children:(0,i.jsxs)(Z.B,{gap:0,justify:"center",w:"full",children:[(0,i.jsxs)(ol,{gapPixel:8,children:[(0,i.jsx)(ot,{ghostLabel:"Add image",onGhostClick:()=>{V(void 0)},children:null!==r.imageUrl?(0,i.jsxs)(lT.A,{isLazy:!0,placement:"right",isOpen:y==="".concat(r.id,"-").concat(c.itemIndex,"-image"),closeOnBlur:!1,children:[(0,i.jsx)(lV.d,{children:(0,i.jsx)(i9,{w:"full",h:"110px",flexShrink:0,_hover:{filter:"brightness(0.95)"},onClick:()=>{I("".concat(r.id,"-").concat(c.itemIndex,"-image"))},transition:"filter 0.2s ease",src:null!=(n=r.imageUrl)?n:void 0,roundedBottom:0})}),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{p:"4",w:"500px",children:[(0,i.jsx)(te.R,{bgColor:k}),g&&(0,i.jsx)(i6.K,{uploadFileProps:{workspaceId:null==g?void 0:g.workspaceId,typebotId:null==g?void 0:g.id,blockId:r.id,itemId:r.id},defaultUrl:null!=(t=r.imageUrl)?t:void 0,onSubmit:e=>{V(e)},onDelete:()=>{V(null)},additionalTabs:{giphy:!0,unsplash:!0}})]})})]}):null}),(0,i.jsx)(ot,{ghostLabel:"Add title",onGhostClick:()=>{E(void 0)},children:null!==r.title?(0,i.jsx)(om,{className:(0,nv.cx)("flex-1 text-sm font-semibold px-2",null!==r.description&&"-mb-2"),defaultValue:null!=(o=r.title)?o:"Title",defaultEdit:void 0===r.title,onValueCommit:E,onDelete:()=>E(null),children:(0,i.jsxs)(ob.Area,{children:[(0,i.jsx)(ob.Preview,{}),(0,i.jsx)(ob.Input,{})]})}):null}),(0,i.jsx)(ot,{ghostLabel:"Add description",onGhostClick:()=>{T(void 0)},children:null!==r.description?(0,i.jsx)(om,{className:(0,nv.cx)("flex-1 text-xs mb-2 px-2"),defaultValue:null!=(s=r.description)?s:"Description",defaultEdit:void 0===r.description,onValueCommit:T,onDelete:()=>T(null),children:(0,i.jsxs)(ob.Area,{children:[(0,i.jsx)(ob.Preview,{}),(0,i.jsx)(ob.Textarea,{})]})}):null})]}),(0,i.jsxs)(Z.B,{gap:0,px:"2",children:[null==(l=r.paths)?void 0:l.map((e,l)=>{var n,t,o;return(0,i.jsxs)(om,{onDelete:()=>A(l),onValueCommit:e=>R(l,e),defaultValue:null!=(t=e.text)?t:"Button",defaultEdit:void 0===e.text,className:"relative",children:[(0,i.jsxs)(ob.Area,{className:(0,od.cn)("text-center text-sm",0===l&&"rounded-t-md border border-b-0",0!==l&&"border border-b-0",l===(null!=(o=null==(n=r.paths)?void 0:n.length)?o:1)-1&&"rounded-b-md border-b"),children:[(0,i.jsx)(ob.Preview,{className:"w-full"}),(0,i.jsx)(ob.Input,{className:"border-white"})]}),(0,i.jsx)(iD,{source:{blockId:b,itemId:r.id,pathId:e.id},groupId:x,pos:"absolute",right:"-57px",bottom:"-2px",pointerEvents:"all"})]},e.id)}),(0,i.jsx)(ih,{hitboxYExtensionPixels:5,expandedHeightPixels:30,initialPaddingPixel:0,expandedPaddingPixel:0,roundedTop:0,fontSize:"xs",fontWeight:"medium",onClick:()=>{var e;j(c,{paths:[...null!=(e=r.paths)?e:[],{id:(0,h.sX)()}]})},children:"Add button"})]}),(0,i.jsx)(tn.s,{offsetY:"5px",offsetX:"-5px",in:p,style:{position:"absolute",right:"-0.25rem",top:"-0.25rem",zIndex:3},unmountOnExit:!0,children:(0,i.jsx)(d.s,{bgColor:(0,M.dU)("white","gray.900"),rounded:"md",children:(0,i.jsx)(B.K,{"aria-label":v("blocks.inputs.button.openSettings.ariaLabel"),icon:(0,i.jsx)(S.Ze,{}),variant:"ghost",size:"xs",shadow:"md",onClick:()=>I(r.id)})})})]})}),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{pos:"relative",onMouseDown:e=>e.stopPropagation(),children:[(0,i.jsx)(te.R,{bgColor:k}),(0,i.jsx)(tl.e,{py:"6",overflowY:"auto",maxH:"400px",shadow:"md",ref:C,children:(0,i.jsx)(ox,{options:r.options,onSettingsChange:e=>{j(c,{...r,options:e})}})})]})})]})},om=e=>{let{defaultValue:l,children:n,className:t,defaultEdit:o,onValueCommit:a,onDelete:s}=e,[r,d]=(0,m.useState)(l);return(0,i.jsx)(ob.Root,{className:t,value:r,defaultEdit:o,onValueChange:e=>{let{value:l}=e;return d(l)},onValueCommit:()=>a(r),onKeyDownCapture:e=>{"Backspace"===e.key&&""===r&&s()},children:n})};var og=n(43412);let oj=e=>{var l,n,t,o;let{workspaceId:a,typebotId:s,blockId:r,item:d,onItemChange:c}=e,{t:p}=(0,$.WD)(),h=e=>{c({...d,pictureSrc:e})};return(0,i.jsxs)(Z.B,{spacing:4,children:[(0,i.jsxs)(V.z,{children:[(0,i.jsx)(eI.E,{fontWeight:"medium",children:p("blocks.inputs.picture.itemSettings.image.label")}),(0,i.jsx)(lT.A,{isLazy:!0,children:e=>{let{onClose:l}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tf.W,{children:(0,i.jsx)(A.$,{size:"sm",children:d.pictureSrc?p("blocks.inputs.picture.itemSettings.image.change.label"):p("blocks.inputs.picture.itemSettings.image.pick.label")})}),(0,i.jsx)(u.Z,{children:(0,i.jsx)(lM.h,{p:"4",w:"500px",children:(0,i.jsx)(og.K,{uploadFileProps:{workspaceId:a,typebotId:s,blockId:r,itemId:d.id},defaultUrl:d.pictureSrc,onSubmit:e=>{h(e),l()},additionalTabs:{giphy:!0,unsplash:!0,icon:!0}})})})]})}})]}),(0,i.jsx)(Q.ks,{label:p("blocks.inputs.picture.itemSettings.title.label"),defaultValue:d.title,onChange:e=>c({...d,title:e})}),(0,i.jsx)(Q.TM,{label:p("blocks.inputs.settings.description.label"),defaultValue:d.description,onChange:e=>c({...d,description:e})}),(0,i.jsx)(Q.ks,{label:p("blocks.inputs.internalValue.label"),moreInfoTooltip:p("blocks.inputs.picture.itemSettings.pictureValue.helperText"),defaultValue:d.value,onChange:e=>c({...d,value:e})}),(0,i.jsx)(H.J,{label:p("blocks.inputs.settings.displayCondition.label"),initialValue:null!=(t=null==(l=d.displayCondition)?void 0:l.isEnabled)&&t,onCheckChange:e=>c({...d,displayCondition:{...d.displayCondition,isEnabled:e}}),children:(0,i.jsx)(i4,{condition:null!=(o=null==(n=d.displayCondition)?void 0:n.condition)?o:{comparisons:[],logicalOperator:lt.u.AND},onConditionChange:e=>c({...d,displayCondition:{...d.displayCondition,condition:e}})})})]})},of=e=>{var l,n,t;let{item:o,indices:s}=e,c=(0,M.dU)("gray.100","gray.700"),{openedNodeId:p,setOpenedNodeId:h}=(0,w.u)(),{updateItem:b,typebot:x}=(0,a.V)(),v=(0,m.useRef)(null);(0,r.M)("wheel",e=>{e.stopPropagation()},v.current);let g=x?null==(t=x.groups.at(s.groupIndex))||null==(n=t.blocks)||null==(l=n.at(s.blockIndex))?void 0:l.id:void 0;return(0,i.jsxs)(lT.A,{placement:"right",isLazy:!0,isOpen:p===o.id,closeOnBlur:!1,children:[(0,i.jsx)(lV.d,{children:(0,i.jsx)(d.s,{px:4,py:2,justify:"center",w:"full",pos:"relative",onClick:()=>{h(o.id)},"data-testid":"item-node",userSelect:"none",children:o.pictureSrc?(0,i.jsx)(iU._,{src:o.pictureSrc,alt:"Picture choice image",rounded:"md",maxH:(0,e0.vl)(o.pictureSrc)?"64px":"128px",w:"full",objectFit:(0,e0.vl)(o.pictureSrc)?"contain":"cover",p:(0,e0.vl)(o.pictureSrc)?"2":void 0,userSelect:"none",draggable:!1}):(0,i.jsx)(d.s,{width:"full",height:"100px",bgColor:c,rounded:"md",justify:"center",align:"center",children:(0,i.jsx)(S.xf,{})})})}),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{pos:"relative",onMouseDown:e=>e.stopPropagation(),children:[(0,i.jsx)(te.R,{}),(0,i.jsx)(tl.e,{py:"6",overflowY:"auto",maxH:"400px",shadow:"md",ref:v,children:x&&g&&(0,i.jsx)(oj,{workspaceId:x.workspaceId,typebotId:x.id,item:o,blockId:g,onItemChange:e=>{b(s,{...o,...e})}})})]})})]})},oy=e=>{var l,n,t,o,s;let{item:c,indices:p}=e,{typebot:h,updateItem:b}=(0,a.V)(),{openedNodeId:x,setOpenedNodeId:v}=(0,w.u)(),g=(0,m.useRef)(null);return(0,r.M)("wheel",e=>{e.stopPropagation()},g.current),(0,i.jsxs)(lT.A,{placement:"left",isLazy:!0,isOpen:x===c.id,closeOnBlur:!1,children:[(0,i.jsx)(lV.d,{children:(0,i.jsx)(d.s,{p:3,pos:"relative",maxW:"full",overflow:"hidden",onClick:()=>{v(c.id)},children:(null==(n=c.content)||null==(l=n.comparisons)?void 0:l.length)===0||oI(null==(o=c.content)||null==(t=o.comparisons)?void 0:t.at(0))?(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."}):(0,i.jsx)(iX,{condition:c.content,variables:null!=(s=null==h?void 0:h.variables)?s:[]})})}),(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{pos:"relative",onMouseDown:e=>e.stopPropagation(),children:[(0,i.jsx)(te.R,{}),(0,i.jsx)(tl.e,{py:"6",overflowY:"auto",maxH:"400px",shadow:"md",ref:g,children:(0,i.jsx)(i4,{condition:c.content,onConditionChange:e=>{b(p,{...c,content:e})}})})]})})]})},oI=e=>(0,e0.pN)(null==e?void 0:e.comparisonOperator)&&(0,e0.pN)(null==e?void 0:e.value)&&(0,e0.pN)(null==e?void 0:e.variableId),oC=e=>{let{item:l,blockType:n,indices:t,isMouseOver:o,blockId:a,groupId:s}=e;switch(n){case es.iQ.CHOICE:return(0,i.jsx)(i5,{item:l,isMouseOver:o,indices:t},"".concat(l.id,"-").concat(l.content));case es.iQ.PICTURE_CHOICE:return(0,i.jsx)(of,{item:l,isMouseOver:o,indices:t});case ti.G.CONDITION:return(0,i.jsx)(oy,{item:l,indices:t});case ti.G.AB_TEST:return(0,i.jsx)(i.Fragment,{});case es.iQ.CARDS:return(0,i.jsx)(ov,{item:l,indices:t,isMouseOver:o,blockId:a,groupId:s})}},ok=e=>{let{indices:l}=e,{deleteItem:n,duplicateItem:t}=(0,a.V)();return(0,i.jsxs)(ts.c,{children:[(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.Td,{}),onClick:()=>t(l),children:"Duplicate"}),(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.uc,{}),onClick:()=>n(l),children:"Delete"})]})},oE=e=>{var l;let{item:n,block:t,indices:o,onMouseDown:s,connectionDisabled:r}=e,u=(0,M.dU)("orange.400","orange.300"),c=(0,M.dU)("gray.200","gray.700"),p=(0,M.dU)("white","gray.900"),{typebot:h}=(0,a.V)(),{previewingEdge:b}=(0,w.u)(),{pathname:x}=(0,nW.useRouter)(),[v,g]=(0,m.useState)(!1),j=(0,m.useRef)(null),f=b&&"itemId"in b.from&&b.from.itemId===n.id,y=(0,e0.O9)(h)&&!r&&t.type!==es.iQ.CARDS&&!(t.options&&"isMultipleChoice"in t.options&&t.options.isMultipleChoice);(0,E.Lt)({ref:j,onDrag:e=>{s&&t.type!==ti.G.AB_TEST&&s(e,{...n,type:t.type,blockId:t.id})},isDisabled:!s});let I=()=>g(!0),C=()=>g(!1),k=null==h||null==(l=h.groups.at(o.groupIndex))?void 0:l.id,S=ow(n);return(0,i.jsx)(F,{renderMenu:()=>(0,i.jsx)(ok,{indices:o}),children:(e,l)=>{var a;return(0,i.jsxs)(Z.B,{"data-testid":"item",pos:"relative",ref:tg([e,j]),w:"full",children:[S&&(0,i.jsx)(iX,{condition:S,variables:null!=(a=null==h?void 0:h.variables)?a:[],size:"xs",displaySemicolon:!0}),(0,i.jsxs)(d.s,{align:"center",onMouseEnter:I,onMouseLeave:C,transition:"box-shadow 200ms, border-color 200ms",rounded:"md",bg:p,borderWidth:1,borderColor:l||f?u:c,w:"full",children:[k&&(0,i.jsx)(oC,{blockId:t.id,groupId:k,blockType:t.type,item:n,isMouseOver:v,indices:o}),h&&(y||x.endsWith("analytics"))&&k&&(0,i.jsx)(iD,{source:{blockId:t.id,itemId:n.id},groupId:k,pos:"absolute",right:"-49px",bottom:"9px",pointerEvents:"all",isHidden:!y})]})]})}})},ow=e=>{var l,n;return"displayCondition"in e&&(null==(l=e.displayCondition)?void 0:l.isEnabled)&&e.displayCondition.condition?e.displayCondition.condition:"options"in e&&e.options&&"displayCondition"in e.options&&(null==(n=e.options.displayCondition)?void 0:n.isEnabled)&&e.options.displayCondition.condition?e.options.displayCondition.condition:void 0},oS=e=>{switch(e){case es.iQ.CHOICE:return"Button";case es.iQ.PICTURE_CHOICE:return"Picture Choice";case es.iQ.CARDS:return"Card";case ti.G.CONDITION:return"Condition";case ti.G.AB_TEST:return"AB Test"}},oT=e=>{var l,n,t,o;let{block:s,indices:{groupIndex:c,blockIndex:p}}=e,{typebot:h,createItem:x,detachItemFromBlock:v}=(0,a.V)(),{draggedItem:g,setDraggedItem:j,mouseOverBlock:f}=(0,E.jh)(),y=(0,m.useRef)([]),{graphPosition:I,setOpenedNodeId:C}=(0,w.u)(),k=null!=(o=g&&(null==f?void 0:f.id)===s.id)&&o,S=void 0!==g&&s.type===g.type,T=(0,e0.O9)(h)&&(null==(n=h.groups.at(c))||null==(l=n.blocks)?void 0:l.at(p+1))===void 0,[V,M]=(0,m.useState)({x:0,y:0}),[A,B]=(0,m.useState)({x:0,y:0}),[R,O]=(0,m.useState)();(0,r.M)("mousemove",e=>{if(!g)return;let{clientX:l,clientY:n}=e;M({...V,x:l-A.x,y:n-A.y})}),(0,m.useEffect)(()=>{S&&(null==f?void 0:f.id)!==s.id&&O(void 0)},[s.id,null==f?void 0:f.id,S]),(0,r.M)("mousemove",e=>{k&&S&&O((0,E.ZV)(e.pageY,y))},null==f?void 0:f.element),(0,r.M)("mouseup",e=>{if(!S||!k||!g||(null==f?void 0:f.id)!==s.id)return;O(void 0);let l=(0,E.ZV)(e.pageY,y);e.stopPropagation(),j(void 0),x(g,{groupIndex:c,blockIndex:p,itemIndex:l})},null==f?void 0:f.element,{capture:!0});let D=e=>(l,n)=>{let{absolute:t,relative:i}=l;h&&!(s.items.length<=1)&&(y.current.splice(e+1,1),v({groupIndex:c,blockIndex:p,itemIndex:e}),M(t),B(i),j({...n}))},L=e=>l=>{l&&(y.current[e]=l)},P=null==h||null==(t=h.groups.at(c))?void 0:t.id,N=oS(s.type),G=e=>{let l=x({},{groupIndex:c,blockIndex:p,itemIndex:e});l&&(0,b.wT)(s.type)&&C(l)};return(0,i.jsxs)(Z.B,{flex:1,spacing:0,maxW:"full",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)(ih,{isVisible:S,isExpanded:0===R,ref:L(0),onClick:()=>G(0),initialHeightPixels:5,children:["Add ",N]}),s.items.map((e,l)=>(0,i.jsxs)(Z.B,{spacing:0,children:[(0,i.jsx)(oE,{item:e,block:s,indices:{groupIndex:c,blockIndex:p,itemIndex:l},onMouseDown:D(l)}),(0,i.jsxs)(ih,{isVisible:S,isExpanded:R===l+1,ref:L(l+1),onClick:()=>G(l+1),children:["Add ",N]})]},e.id)),oM(s,T)&&P&&(0,i.jsx)(oV,{block:s,groupId:P}),g&&g.blockId===s.id&&(0,i.jsx)(u.Z,{children:(0,i.jsx)(d.s,{pointerEvents:"none",pos:"fixed",top:"0",left:"0",style:{transform:"translate(".concat(V.x,"px, ").concat(V.y,"px) rotate(-2deg) scale(").concat(I.scale,")")},w:"220px",transformOrigin:"0 0 0",children:(0,i.jsx)(oE,{item:g,block:s,indices:{groupIndex:c,blockIndex:p,itemIndex:0},connectionDisabled:!0})})})]})},oV=e=>{let{block:l,groupId:n}=e,{t}=(0,$.WD)();return(0,i.jsxs)(d.s,{px:"4",py:"2",borderWidth:"1px",borderColor:(0,M.dU)("gray.300",void 0),bgColor:(0,M.dU)("gray.50","gray.900"),rounded:"md",pos:"relative",align:"center",cursor:"not-allowed",children:[(0,i.jsx)(eI.E,{color:"gray.500",children:t(l.type===ti.G.CONDITION?"blocks.inputs.button.else.label":"blocks.inputs.button.default.label")}),(0,i.jsx)(iD,{source:{blockId:l.id},groupId:n,pos:"absolute",right:"-49px"})]})},oM=(e,l)=>!!l&&(!!e.outgoingEdgeId||e.type===ti.G.CONDITION||1!==e.items.length&&(e.type===es.iQ.CARDS?e.items.some(e=>{var l;return null==(l=e.paths)?void 0:l.some(e=>void 0===e.outgoingEdgeId)}):e.type!==es.iQ.CHOICE&&e.type!==es.iQ.PICTURE_CHOICE||e.items.some(e=>void 0===e.outgoingEdgeId))),oA=e=>{var l,n,t;let{block:o,indices:s}=e,{typebot:r}=(0,a.V)(),{t:d}=(0,$.WD)(),u=null==r||null==(l=r.variables.find(e=>{var l;return e.id===(null==(l=o.options)?void 0:l.dynamicVariableId)}))?void 0:l.name;return(0,i.jsxs)(Z.B,{w:"90%",children:[(null==(n=o.options)?void 0:n.dynamicVariableId)?(0,i.jsxs)(iJ.B,{spacing:1,children:[(0,i.jsx)(eI.E,{children:d("blocks.inputs.button.variables.display.label")}),(0,i.jsx)(nV.vw,{bg:"orange.400",color:"white",children:u}),(0,i.jsx)(eI.E,{children:d("blocks.inputs.button.variables.buttons.label")})]}):(0,i.jsx)(oT,{block:o,indices:s}),(null==(t=o.options)?void 0:t.variableId)?(0,i.jsx)(tR,{variableId:o.options.variableId,variables:null==r?void 0:r.variables}):null]})},oB=e=>{var l,n;let{block:t,indices:o}=e,{typebot:s}=(0,a.V)(),r=null==(n=t.options)||null==(l=n.saveResponseMapping)?void 0:l.map(e=>null==e?void 0:e.variableId).filter(e0.O9);return(0,i.jsxs)(Z.B,{w:"90%",children:[(0,i.jsx)(oT,{block:t,indices:o}),null==r?void 0:r.map(e=>(0,i.jsx)(tR,{variableId:e,variables:null==s?void 0:s.variables},e))]})},oR=e=>{var l;let{variableId:n,...t}=e,{typebot:o}=(0,a.V)(),s=null==o||null==(l=o.variables.find((0,e0.$H)(n)))?void 0:l.name;return(0,i.jsxs)(eI.E,{w:"calc(100% - 25px)",...t,children:["Collect ",(0,i.jsx)(iP,{variableName:null!=s?s:""})]})},oO=e=>{let{variableId:l}=e;return l?(0,i.jsx)(oR,{variableId:l}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Pick a date"})},oD=e=>{var l;let{options:{variableId:n,labels:t}={}}=e,{typebot:o}=(0,a.V)();return(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{color:"gray.500",children:null!=(l=null==t?void 0:t.placeholder)?l:eu.labels.placeholder}),n&&(0,i.jsx)(tR,{variables:null==o?void 0:o.variables,variableId:n})]})},oL=e=>{let{options:l}=e,{t:n}=(0,$.WD)();return(null==l?void 0:l.variableId)?(0,i.jsx)(oR,{variableId:l.variableId}):(0,i.jsx)(eI.E,{noOfLines:1,pr:"6",children:n((null==l?void 0:l.isMultipleAllowed)?"blocks.inputs.file.collectMultiple.label":"blocks.inputs.file.collectSingle.label")})},oP=e=>{var l;let{options:{variableId:n,labels:t}={}}=e;return n?(0,i.jsx)(oR,{variableId:n}):(0,i.jsx)(eI.E,{color:"gray.500",children:null!=(l=null==t?void 0:t.placeholder)?l:eC.iF})},oN=e=>{var l,n;let{block:t}=e,{t:o}=(0,$.WD)();return(null==(l=t.options)?void 0:l.amount)&&t.options.credentialsId?(0,i.jsxs)(eI.E,{noOfLines:1,pr:"6",children:[o("blocks.inputs.payment.collect.label")," ",t.options.amount," ",null!=(n=t.options.currency)?n:eA.Q.currency]}):(0,i.jsx)(eI.E,{color:"gray.500",children:o("configure")})},oG=e=>{var l;let{options:{variableId:n,labels:t}={}}=e;return n?(0,i.jsx)(oR,{variableId:n}):(0,i.jsx)(eI.E,{color:"gray.500",children:null!=(l=null==t?void 0:t.placeholder)?l:eD.labels.placeholder})},oW=e=>{var l,n,t,o;let{block:s,indices:r}=e,{t:d}=(0,$.WD)(),{typebot:u}=(0,a.V)(),c=null==u||null==(l=u.variables.find(e=>{var l,n;return e.id===(null==(n=s.options)||null==(l=n.dynamicItems)?void 0:l.pictureSrcsVariableId)}))?void 0:l.name;return(0,i.jsxs)(Z.B,{w:"90%",children:[(null==(t=s.options)||null==(n=t.dynamicItems)?void 0:n.isEnabled)&&c?(0,i.jsxs)(iJ.B,{spacing:1,children:[(0,i.jsx)(eI.E,{children:d("blocks.inputs.picture.settings.dynamicVariables.display.label")}),(0,i.jsx)(nV.vw,{bg:"orange.400",color:"white",children:c}),(0,i.jsx)(eI.E,{children:d("blocks.inputs.picture.settings.dynamicVariables.pictures.label")})]}):(0,i.jsx)(oT,{block:s,indices:r}),(null==(o=s.options)?void 0:o.variableId)?(0,i.jsx)(tR,{variableId:s.options.variableId,variables:null==u?void 0:u.variables}):null]})},oU=e=>{var l,n,t,o,a;let{variableId:s,block:r}=e,{t:d}=(0,$.WD)();return s?(0,i.jsx)(oR,{variableId:s}):(0,i.jsxs)(eI.E,{noOfLines:1,pr:"6",children:[d("blocks.inputs.rating.from.label")," ",(null==(l=r.options)?void 0:l.buttonType)==="Icons"?1:null!=(o=null==(n=r.options)?void 0:n.startsAt)?o:eW.startsAt," ",d("blocks.inputs.rating.to.label")," ",null!=(a=null==(t=r.options)?void 0:t.length)?a:eW.length]})},oz=e=>{var l,n,t,o;let{options:s}=e,{typebot:r}=(0,a.V)(),d=r&&(null==s||null==(l=s.attachments)?void 0:l.isEnabled)&&(null==s?void 0:s.attachments.saveVariableId),u=r&&(null==s||null==(n=s.audioClip)?void 0:n.isEnabled)&&(null==s?void 0:s.audioClip.saveVariableId);return(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{color:"gray.500",h:(null==s?void 0:s.isLong)?"100px":"auto",children:null!=(o=null==s||null==(t=s.labels)?void 0:t.placeholder)?o:ez.labels.placeholder}),(null==s?void 0:s.variableId)&&(0,i.jsx)(tR,{variables:null==r?void 0:r.variables,variableId:s.variableId}),d&&(0,i.jsx)(tR,{variables:null==r?void 0:r.variables,variableId:d}),u&&(0,i.jsx)(tR,{variables:null==r?void 0:r.variables,variableId:u})]})},oF=e=>{let{variableId:l}=e;return l?(0,i.jsx)(oR,{variableId:l}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Pick a time"})},oK=e=>{var l,n;let{options:t}=e;return(null==t?void 0:t.variableId)?(0,i.jsx)(oR,{variableId:t.variableId}):(0,i.jsx)(eI.E,{color:"gray.500",w:"90%",children:null!=(n=null==t||null==(l=t.labels)?void 0:l.placeholder)?n:eY.labels.placeholder})},o_=e=>{var l,n,t,o;let{block:a}=e;return(null==(l=a.options)?void 0:l.task)==="Close widget"?(0,i.jsx)(eI.E,{children:"Close Chatwoot"}):(null!=(o=null==(t=a.options)||null==(n=t.websiteToken)?void 0:n.length)?o:0)===0?(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."}):(0,i.jsx)(eI.E,{children:"Open Chatwoot"})},oH=e=>{let{action:l}=e;return(0,i.jsx)(eI.E,{color:l?"currentcolor":"gray.500",noOfLines:1,children:l?'Track "'.concat(l,'"'):"Configure..."})},oQ=e=>{var l,n;let{options:t}=e,{typebot:o}=(0,a.V)();return(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{color:(null==t?void 0:t.action)?"currentcolor":"gray.500",noOfLines:1,children:null!=(n=null==t?void 0:t.action)?n:"Configure..."}),o&&(null==t?void 0:t.action)===e$.GE.GET&&(null==t||null==(l=t.cellsToExtract)?void 0:l.map(e=>e.variableId).map((e,l)=>e?(0,i.jsx)(tR,{variables:o.variables,variableId:e},e+l):null))]})},oY=e=>{var l;let{block:{options:n}}=e,{typebot:t}=(0,a.V)(),o=null==n?void 0:n.webhook;return(null==o?void 0:o.url)?(0,i.jsxs)(Z.B,{w:"full",children:[(0,i.jsxs)(eI.E,{noOfLines:2,pr:"6",children:[o.method," ",o.url]}),null==n||null==(l=n.responseVariableMapping)?void 0:l.filter(e=>e.variableId).map(e=>(0,i.jsx)(tR,{variableId:e.variableId,variables:null==t?void 0:t.variables},e.variableId))]}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."})},oJ=e=>{var l,n;let{block:t}=e;return(null==(n=t.options)||null==(l=n.webhook)?void 0:l.url)?(0,i.jsx)(eI.E,{noOfLines:1,pr:"6",children:"Trigger scenario"}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."})},oZ=e=>{var l,n;let{options:t}=e,{typebot:o}=(0,a.V)();return(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{color:(null==t?void 0:t.task)?"currentcolor":"gray.500",noOfLines:1,children:null!=(n=null==t?void 0:t.task)?n:"Configure..."}),o&&t&&"responseMapping"in t&&(null==(l=t.responseMapping)?void 0:l.map(e=>e.variableId).map((e,l)=>e?(0,i.jsx)(tR,{variables:o.variables,variableId:e},e+l):null)),o&&t&&"saveUrlInVariableId"in t&&t.saveUrlInVariableId&&(0,i.jsx)(tR,{variables:o.variables,variableId:t.saveUrlInVariableId})]})},oX=e=>{var l,n;let{block:t}=e;return(null==(n=t.options)||null==(l=n.webhook)?void 0:l.url)?(0,i.jsx)(eI.E,{noOfLines:1,pr:"6",children:"Trigger scenario"}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."})},oq=e=>{let{options:l}=e;return(0,i.jsx)(eI.E,{color:(null==l?void 0:l.eventType)||(null==l?void 0:l.pixelId)?"currentcolor":"gray.500",noOfLines:1,children:(null==l?void 0:l.eventType)?'Track "'.concat(l.eventType,'"'):(null==l?void 0:l.pixelId)?"Init Pixel":"Configure..."})},o$=e=>{var l,n,t,o,a;let{block:s}=e;return(null!=(a=null==(n=s.options)||null==(l=n.recipients)?void 0:l.length)?a:0)===0?(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."}):(0,i.jsxs)(iJ.B,{noOfLines:2,pr:"6",children:[(0,i.jsx)(iJ.Q,{children:(0,i.jsx)(eI.E,{children:"Send email to"})}),null==(o=s.options)||null==(t=o.recipients)?void 0:t.map(e=>(0,i.jsx)(iJ.Q,{children:(0,i.jsx)(nV.vw,{children:e})},e))]})},o0=e=>{var l,n;let{block:t}=e;return(null==(n=t.options)||null==(l=n.webhook)?void 0:l.url)?(0,i.jsx)(eI.E,{noOfLines:1,pr:"6",children:"Trigger zap"}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."})},o1=e=>{var l,n,t,o;let{block:a,groupId:s}=e,r=(0,M.dU)("gray.200","gray.700"),u=(0,M.dU)("white",void 0);return(0,i.jsxs)(Z.B,{spacing:2,w:"full",children:[(0,i.jsxs)(d.s,{pos:"relative",align:"center",shadow:"sm",rounded:"md",bg:u,borderWidth:"1px",borderColor:r,w:"full",children:[(0,i.jsxs)(eI.E,{p:"3",children:["A"," ",(0,i.jsxs)(nV.vw,{children:[null!=(t=null==(l=a.options)?void 0:l.aPercent)?t:ns.aPercent,"%"]})]}),(0,i.jsx)(iD,{source:{blockId:a.id,itemId:a.items[0].id},groupId:s,pos:"absolute",right:"-49px",pointerEvents:"all"})]}),(0,i.jsxs)(d.s,{pos:"relative",align:"center",shadow:"sm",rounded:"md",bg:u,borderWidth:"1px",borderColor:r,w:"full",children:[(0,i.jsxs)(eI.E,{p:"3",children:["B"," ",(0,i.jsxs)(nV.vw,{children:[100-(null!=(o=null==(n=a.options)?void 0:n.aPercent)?o:ns.aPercent),"%"]})]}),(0,i.jsx)(iD,{source:{blockId:a.id,itemId:a.items[1].id},groupId:s,pos:"absolute",right:"-49px",pointerEvents:"all"})]})]})},o2=e=>{let{block:l,indices:n}=e;return(0,i.jsx)(Z.B,{w:"90%",children:(0,i.jsx)(oT,{block:l,indices:n})})},o4=e=>{let{options:l}=e,{typebot:n}=(0,a.V)(),{groupTitle:t,blockIndex:o}=(0,m.useMemo)(()=>{if(!(null==l?void 0:l.groupId))return{};if((0,nu.J)(l.groupId))return{groupTitle:l.groupId};let e=null==n?void 0:n.groups.find((0,e0.$H)(l.groupId));if(!e)return{};let t=e.blocks.findIndex((0,e0.$H)(l.blockId));return{groupTitle:e.title,blockIndex:t>=0?t+1:void 0}},[null==l?void 0:l.groupId,null==l?void 0:l.blockId,null==n?void 0:n.groups]);return t?(0,i.jsxs)(eI.E,{children:["Jump to ",(0,i.jsx)(nV.vw,{colorScheme:"purple",children:t})," ",(0,e0.O9)(o)&&o>=0?(0,i.jsxs)(i.Fragment,{children:["at block ",(0,i.jsx)(nV.vw,{colorScheme:"purple",children:o+1})]}):null]}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."})},o3=e=>{let{url:l}=e;return(0,i.jsx)(eI.E,{color:l?"currentcolor":"gray.500",noOfLines:2,children:l?"Redirect to ".concat(l):"Configure..."})},o5=()=>(0,i.jsx)(eI.E,{children:"Return"}),o9=e=>{let{options:{name:l,content:n}={}}=e;return(0,i.jsx)(eI.E,{color:n?"currentcolor":"gray.500",noOfLines:1,children:n?"Run ".concat(null!=l?l:nE.name):"Configure..."})},o6=e=>{var l,n,t,o;let{block:s}=e,{typebot:r}=(0,a.V)(),d=null!=(t=null==r||null==(l=r.variables.find((0,e0.$H)(null==(n=s.options)?void 0:n.variableId)))?void 0:l.name)?t:"";return(0,i.jsx)(eI.E,{color:"gray.500",noOfLines:4,children:""===d?"Click to edit...":(0,i.jsx)(o7,{options:s.options,variables:null!=(o=null==r?void 0:r.variables)?o:[]})})},o7=e=>{var l,n,t,o,a,s,r;let{options:d,variables:u}=e,c=null!=(n=null==(l=u.find((0,e0.$H)(null==d?void 0:d.variableId)))?void 0:l.name)?n:"";switch(null==d?void 0:d.type){case"Custom":case void 0:return(0,i.jsxs)(Z.B,{maxH:"60vh",children:[(0,i.jsx)(eI.E,{as:"span",children:(0,i.jsx)(o8,{variableName:c,expressionDescription:null==d?void 0:d.expressionDescription,isCode:null!=(t=null==d?void 0:d.isCode)&&t,expression:null==d?void 0:d.expressionToEvaluate})}),(null==d?void 0:d.saveErrorInVariableId)&&(0,i.jsx)(tR,{variables:u,variableId:null==d?void 0:d.saveErrorInVariableId})]});case"Map item with same index":{let e=u.find((0,e0.$H)(null==(o=d.mapListItemParams)?void 0:o.baseItemVariableId)),l=u.find((0,e0.$H)(null==(a=d.mapListItemParams)?void 0:a.baseListVariableId)),n=u.find((0,e0.$H)(null==(s=d.mapListItemParams)?void 0:s.targetListVariableId));return(0,i.jsxs)(eI.E,{as:"span",children:[c," = item in $",null==n?void 0:n.name," with same index as $",null==e?void 0:e.name," in $",null==l?void 0:l.name]})}case"Append value(s)":return(0,i.jsxs)(eI.E,{as:"span",children:["Append ",d.item," in ",c]});case"Empty":return(0,i.jsxs)(eI.E,{as:"span",children:["Reset ",c," "]});case"Shift":case"Pop":{let e=null==(r=u.find((0,e0.$H)(d.saveItemInVariableId)))?void 0:r.name;return(0,i.jsxs)(eI.E,{as:"span",children:[d.type," ",c,e?" into ".concat(e):""]})}case"Random ID":case"Today":case"Now":case"Tomorrow":case"User ID":case"Result ID":case"Moment of the day":case"Environment name":case"Device type":case"Transcript":case"Yesterday":return(0,i.jsxs)(eI.E,{as:"span",children:[c," = ",(0,i.jsxs)(nV.vw,{colorScheme:"purple",children:["System.",d.type]})]});case"Contact name":case"Phone number":case"Referral Click ID":case"Referral Source ID":return(0,i.jsxs)(eI.E,{as:"span",children:[c," ="," ",(0,i.jsxs)(nV.vw,{colorScheme:"purple",children:["WhatsApp.",d.type]})]})}},o8=e=>{let{expressionDescription:l,isCode:n,expression:t,variableName:o}=e;return t?l?(0,i.jsxs)(eI.E,{as:"span",children:[o," = ",(0,i.jsx)(nV.vw,{colorScheme:"gray",children:l})]}):n?(0,i.jsxs)(Z.B,{spacing:1,children:[(0,i.jsxs)(eI.E,{children:[o," ="]}),(0,i.jsx)(tW.B.pre,{bgColor:"gray.100",rounded:"md",p:"2",noOfLines:6,children:t})]}):(0,i.jsxs)(eI.E,{as:"span",noOfLines:5,children:[o," = ",t]}):null},ae=e=>{var l,n,t,o,s,r,d;let{block:u}=e,{typebot:c}=(0,a.V)(),{data:p}=(0,e8.I)(e7.id.typebot.getTypebot.queryOptions({typebotId:null==(l=u.options)?void 0:l.typebotId},{enabled:(0,e0.hj)(null==(n=u.options)?void 0:n.typebotId)&&(null==(t=u.options)?void 0:t.typebotId)!=="current"})),h=c&&((null==(o=u.options)?void 0:o.typebotId)===c.id||(null==(s=u.options)?void 0:s.typebotId)==="current"),b=h?c:null==p?void 0:p.typebot,x=(0,m.useMemo)(()=>{var e,l;if(null==(e=u.options)?void 0:e.groupId)return(0,nu.J)(u.options.groupId)?u.options.groupId:null==b||null==(l=b.groups.find((0,e0.$H)(u.options.groupId)))?void 0:l.title},[null==(r=u.options)?void 0:r.groupId,null==b?void 0:b.groups]);return(null==(d=u.options)?void 0:d.typebotId)?(0,i.jsxs)(eI.E,{children:["Jump"," ",x?(0,i.jsxs)(i.Fragment,{children:["to ",(0,i.jsx)(nV.vw,{colorScheme:"purple",children:x})]}):(0,i.jsx)(i.Fragment,{})," ",h?(0,i.jsx)(i.Fragment,{}):(0,i.jsxs)(i.Fragment,{children:["in ",(0,i.jsx)(nV.vw,{children:null==b?void 0:b.name})]})]}):(0,i.jsx)(eI.E,{color:"gray.500",children:"Configure..."})},al=e=>{let{options:{secondsToWaitFor:l}={}}=e;return(0,i.jsx)(eI.E,{color:l?"currentcolor":"gray.500",noOfLines:1,children:l?"Wait for ".concat(l,"s"):"Configure..."})},an=e=>{var l;let{options:n}=e,{typebot:t}=(0,a.V)();return(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{noOfLines:1,children:"Listen for webhook"}),t&&(null==n||null==(l=n.responseVariableMapping)?void 0:l.filter(e=>(0,e0.O9)(e.variableId)).map((e,l)=>(0,i.jsx)(tR,{variables:t.variables,variableId:e.variableId},e.variableId+l)))]})};var at=n(24688);let ai=e=>{var l,n,t,o;let{block:s,indices:r}=e,{blockDef:u,actionDef:c}=(0,n9._)({nodeType:s.type,action:null==(l=s.options)?void 0:l.action}),{typebot:p}=(0,a.V)(),h=(0,m.useMemo)(()=>{var e,l,n,t,i;if(!(null==c||null==(l=c.run)||null==(e=l.stream)?void 0:e.getStreamVariableId))return!1;let o=null==p?void 0:p.variables.find(e=>e.id===c.run.stream.getStreamVariableId(s.options));if(!o)return!1;let a=null==p||null==(n=p.groups[r.groupIndex])?void 0:n.blocks[r.blockIndex+1];return(null==a?void 0:a.type)===at.o.TEXT&&(null==(i=a.content)||null==(t=i.richText)?void 0:t.length)===1&&"p"===a.content.richText[0].type&&1===a.content.richText[0].children.length&&a.content.richText[0].children[0].text==="{{".concat(o.name,"}}")},[null==c?void 0:c.run,s.options,r.blockIndex,r.groupIndex,null==p?void 0:p.groups,null==p?void 0:p.variables]),b=null!=(o=null==c||null==(n=c.getSetVariableIds)?void 0:n.call(c,s.options))?o:[],x=(null==(t=s.options)?void 0:t.action)&&(!(null==u?void 0:u.auth)||s.options.credentialsId);return(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(eI.E,{color:x?"currentcolor":"gray.500",noOfLines:1,children:x?(null==c?void 0:c.parseBlockNodeLabel)?c.parseBlockNodeLabel(s.options):s.options.action:"Configure..."}),p&&x&&b.map((e,l)=>(0,i.jsx)(tR,{variables:p.variables,variableId:e},e+l)),h&&(0,i.jsx)(tS.m,{label:"Text bubble content will be streamed",children:(0,i.jsx)(d.s,{rounded:"full",p:"1",bgColor:"gray.100",color:"purple.500",borderWidth:1,pos:"absolute",bottom:"-15px",left:"118px",zIndex:10,children:(0,i.jsx)(S.ui,{fontSize:"sm"})})})]})},ao=e=>{var l,n,t,o,a;let{block:s,indices:r,groupId:d}=e;switch(s.type){case at.o.TEXT:return(0,i.jsx)(iH,{block:s});case at.o.IMAGE:return(0,i.jsx)(iz,{block:s});case at.o.VIDEO:return(0,i.jsx)(iY,{block:s});case at.o.EMBED:return(0,i.jsx)(iW,{block:s});case at.o.AUDIO:return(0,i.jsx)(iG,{url:null==(l=s.content)?void 0:l.url});case es.iQ.TEXT:return(0,i.jsx)(oz,{options:s.options});case es.iQ.NUMBER:return(0,i.jsx)(oP,{options:s.options});case es.iQ.EMAIL:return(0,i.jsx)(oD,{options:s.options});case es.iQ.URL:return(0,i.jsx)(oK,{options:s.options});case es.iQ.CHOICE:return(0,i.jsx)(oA,{block:s,indices:r});case es.iQ.PICTURE_CHOICE:return(0,i.jsx)(oW,{block:s,indices:r});case es.iQ.PHONE:return(0,i.jsx)(oG,{options:s.options});case es.iQ.DATE:return(0,i.jsx)(oO,{variableId:null==(n=s.options)?void 0:n.variableId});case es.iQ.TIME:return(0,i.jsx)(oF,{variableId:null==(t=s.options)?void 0:t.variableId});case es.iQ.PAYMENT:return(0,i.jsx)(oN,{block:s});case es.iQ.RATING:return(0,i.jsx)(oU,{block:s});case es.iQ.FILE:return(0,i.jsx)(oL,{options:s.options});case es.iQ.CARDS:return(0,i.jsx)(oB,{block:s,indices:r});case ti.G.SET_VARIABLE:return(0,i.jsx)(o6,{block:s});case ti.G.REDIRECT:return(0,i.jsx)(o3,{url:null==(o=s.options)?void 0:o.url});case ti.G.SCRIPT:return(0,i.jsx)(o9,{options:s.options});case ti.G.WAIT:return(0,i.jsx)(al,{options:s.options});case ti.G.JUMP:return(0,i.jsx)(o4,{options:s.options});case ti.G.AB_TEST:return(0,i.jsx)(o1,{block:s,groupId:d});case ti.G.TYPEBOT_LINK:return(0,i.jsx)(ae,{block:s});case ti.G.CONDITION:return(0,i.jsx)(o2,{block:s,indices:r});case ti.G.WEBHOOK:return(0,i.jsx)(an,{options:s.options});case ti.G.RETURN:return(0,i.jsx)(o5,{});case tt.I.GOOGLE_SHEETS:return(0,i.jsx)(oQ,{options:s.options});case tt.I.GOOGLE_ANALYTICS:return(0,i.jsx)(oH,{action:null==(a=s.options)?void 0:a.action});case tt.I.HTTP_REQUEST:return(0,i.jsx)(oY,{block:s});case tt.I.ZAPIER:return(0,i.jsx)(o0,{block:s});case tt.I.PABBLY_CONNECT:return(0,i.jsx)(oX,{block:s});case tt.I.MAKE_COM:return(0,i.jsx)(oJ,{block:s});case tt.I.EMAIL:return(0,i.jsx)(o$,{block:s});case tt.I.CHATWOOT:return(0,i.jsx)(o_,{block:s});case tt.I.OPEN_AI:return(0,i.jsx)(oZ,{options:s.options});case tt.I.PIXEL:return(0,i.jsx)(oq,{options:s.options});default:return(0,i.jsx)(ai,{block:s,indices:r})}};var aa=n(32226);let as=e=>{var l;let{block:n,onTurnIntoClick:t}=e,{actionDef:o}=(0,n9._)({nodeType:n.type,action:"options"in n?null==(l=n.options)?void 0:l.action:void 0}),{onClose:a,onOpen:s,isOpen:r}=(0,eV.j)(),d=(0,g.YQ)(a,200),u=()=>{d.cancel(),s()};return o&&(null==o?void 0:o.turnableInto)&&(null==o?void 0:o.turnableInto.length)!==0?(0,i.jsxs)(U.W,{isOpen:r,placement:"right",offset:[0,0],onClose:a,children:[(0,i.jsx)(z.I,{as:tr.D,onClick:s,onMouseEnter:u,onMouseLeave:d,icon:(0,i.jsx)(S.Ho,{}),children:(0,i.jsxs)(V.z,{justifyContent:"space-between",children:[(0,i.jsx)(eI.E,{children:"Turn into"}),(0,i.jsx)(S.vK,{})]})}),(0,i.jsx)(ts.c,{onMouseEnter:u,onMouseLeave:d,children:o.turnableInto.map(e=>(0,i.jsx)(ar,{blockType:e.blockId,onClick:l=>t(e,l)},e.blockId))})]}):null},ar=e=>{let{blockType:l,onClick:n}=e,{blockDef:t,blockSchema:o}=(0,n9._)({nodeType:l});return t&&o?(0,i.jsx)(tr.D,{icon:(0,i.jsx)(aa.y,{type:l}),onClick:()=>n(o),children:t.name}):null},ad=e=>{let{indices:l,block:n,onTurnIntoClick:t}=e,{t:o}=(0,$.WD)(),{deleteBlock:s,duplicateBlock:r}=(0,a.V)();return(0,i.jsxs)(ts.c,{children:[(0,i.jsx)(as,{block:n,onTurnIntoClick:t}),(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.Td,{}),onClick:()=>r(l),children:o("duplicate")}),(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.uc,{}),onClick:()=>s(l),children:o("delete")})]})};var au=n(10522);let ac={isAutoplayEnabled:!0},ap=e=>{var l,n;let{uploadFileProps:t,content:o,onContentChange:a}=e,{t:s}=(0,$.WD)(),[r,u]=(0,m.useState)("link"),c=e=>a({...o,url:e});return(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(V.z,{children:[(0,i.jsx)(A.$,{variant:"upload"===r?"solid":"ghost",onClick:()=>u("upload"),size:"sm",children:s("editor.blocks.bubbles.audio.settings.upload.label")}),(0,i.jsx)(A.$,{variant:"link"===r?"solid":"ghost",onClick:()=>u("link"),size:"sm",children:s("editor.blocks.bubbles.audio.settings.embedLink.label")})]}),(0,i.jsxs)(Z.B,{p:"2",spacing:4,children:[(0,i.jsxs)(Z.B,{children:["upload"===r&&(0,i.jsx)(d.s,{justify:"center",py:"2",children:(0,i.jsx)(au.s,{fileType:"audio",filePathProps:t,onFileUploaded:c,colorScheme:"orange",children:s("editor.blocks.bubbles.audio.settings.chooseFile.label")})}),"link"===r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q.ks,{placeholder:s("editor.blocks.bubbles.audio.settings.worksWith.placeholder"),defaultValue:null!=(l=null==o?void 0:o.url)?l:"",onChange:c}),(0,i.jsx)(eI.E,{fontSize:"sm",color:"gray.400",textAlign:"center",children:s("editor.blocks.bubbles.audio.settings.worksWith.text")})]})]}),(0,i.jsx)(Y.R,{label:s("editor.blocks.bubbles.audio.settings.autoplay.label"),initialValue:null!=(n=null==o?void 0:o.isAutoplayEnabled)?n:ac.isAutoplayEnabled,onCheckChange:e=>a({...o,isAutoplayEnabled:e})})]})]})},ah={height:400},ab=e=>{var l,n,t,o,a,s;let{content:r,onSubmit:d}=e,{t:u}=(0,$.WD)();return(0,i.jsxs)(Z.B,{p:"2",spacing:6,children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(Q.ks,{placeholder:u("editor.blocks.bubbles.embed.settings.worksWith.placeholder"),defaultValue:null!=(o=null==r?void 0:r.url)?o:"",onChange:e=>{let l=(0,e0.Jf)(e.trim().startsWith("<iframe")?ax(e):e);d({...r,url:l})}}),(0,i.jsx)(eI.E,{fontSize:"sm",color:"gray.400",textAlign:"center",children:u("editor.blocks.bubbles.embed.settings.worksWith.text")})]}),(0,i.jsx)(Q.Q7,{label:"Height:",defaultValue:null!=(a=null==r?void 0:r.height)?a:ah.height,onValueChange:e=>e&&d({...r,height:e}),suffix:u("editor.blocks.bubbles.embed.settings.numberInput.unit"),direction:"row"}),(0,i.jsxs)(H.J,{label:"Wait for event?",initialValue:null!=(s=null==r||null==(l=r.waitForEvent)?void 0:l.isEnabled)&&s,onCheckChange:e=>d({...r,waitForEvent:{...null==r?void 0:r.waitForEvent,isEnabled:e}}),children:[(0,i.jsx)(Q.ks,{direction:"row",label:"Name:",defaultValue:null==r||null==(n=r.waitForEvent)?void 0:n.name,onChange:e=>d({...r,waitForEvent:{...null==r?void 0:r.waitForEvent,name:e}})}),(0,i.jsx)(J.x,{onSelectVariable:e=>d({...r,waitForEvent:{...null==r?void 0:r.waitForEvent,saveDataInVariableId:null==e?void 0:e.id}}),initialVariableId:null==r||null==(t=r.waitForEvent)?void 0:t.saveDataInVariableId,label:"Save data in variable"})]})]})},ax=e=>[...e.matchAll(/src="([^"]+)"/g)][0][1],av={clickLink:{alt:"Bubble image"}},am=e=>{var l,n,t,o,a,s,r,d;let{uploadFileProps:u,block:c,onContentChange:p}=e,{t:h}=(0,$.WD)(),[b,x]=(0,m.useState)((0,e0.hj)(null==(n=c.content)||null==(l=n.clickLink)?void 0:l.url));return(0,i.jsxs)(Z.B,{p:"2",spacing:4,children:[(0,i.jsx)(og.K,{uploadFileProps:u,defaultUrl:null==(t=c.content)?void 0:t.url,onSubmit:e=>{p({...c.content,url:e})},additionalTabs:{giphy:!0,unsplash:!0,icon:!0}}),(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(Y.R,{label:h("editor.blocks.bubbles.image.switchWithLabel.onClick.label"),initialValue:b,onCheckChange:()=>{var e;(0,e0.O9)(null==(e=c.content)?void 0:e.clickLink)&&b&&p({...c.content,clickLink:void 0}),x(!b)}}),b&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q.ks,{autoFocus:!0,placeholder:"https://example.com",onChange:e=>{var l;p({...c.content,clickLink:{...null==(l=c.content)?void 0:l.clickLink,url:e}})},defaultValue:null==(a=c.content)||null==(o=a.clickLink)?void 0:o.url}),(0,i.jsx)(Q.ks,{placeholder:h("editor.blocks.bubbles.image.switchWithLabel.onClick.placeholder"),onChange:e=>{var l;p({...c.content,clickLink:{...null==(l=c.content)?void 0:l.clickLink,alt:e}})},defaultValue:null!=(d=null==(r=c.content)||null==(s=r.clickLink)?void 0:s.alt)?d:av.clickLink.alt})]})]})]})};var ag=n(18408),aj=n(46614),af=n(53295),ay=n(95453),aI=n(3495);let aC=e=>(0,i.jsx)(aI.I,{viewBox:"0 0 130.318 50",...e,children:(0,i.jsxs)("g",{transform:"translate(-3894 2762)",children:[(0,i.jsx)("rect",{width:"50",height:"50",rx:"8",transform:"translate(3894 -2762)",fill:"#07a081"}),(0,i.jsx)("path",{d:"M32.671,44.73h7.091V37.935H41.9a5.657,5.657,0,1,0,0-11.314H32.671Zm10.763,3.622H29V23H41.9a9.271,9.271,0,0,1,1.53,18.435Z",transform:"translate(3880 -2773)",fill:"#fff"}),(0,i.jsx)("path",{d:"M1.694,0h2.6V-6.16H7.656a6.579,6.579,0,0,0,2.915-.616,4.639,4.639,0,0,0,1.969-1.76,5.1,5.1,0,0,0,.7-2.728,5.146,5.146,0,0,0-.7-2.75,4.639,4.639,0,0,0-1.969-1.76,6.579,6.579,0,0,0-2.915-.616H1.694Zm2.6-8.47v-5.61H7.722a3.03,3.03,0,0,1,2.134.748,2.641,2.641,0,0,1,.814,2.046A2.684,2.684,0,0,1,9.856-9.24a2.978,2.978,0,0,1-2.134.77ZM20.372.264a5.925,5.925,0,0,0,3.179-.836,4.64,4.64,0,0,0,1.9-2.112l-2.024-.99a3.73,3.73,0,0,1-1.2,1.243,3.29,3.29,0,0,1-1.837.5A3.458,3.458,0,0,1,18-2.827a3.433,3.433,0,0,1-1.1-2.409H25.74a3.34,3.34,0,0,0,.088-.572q.022-.308.022-.594a6.154,6.154,0,0,0-.671-2.849,5.361,5.361,0,0,0-1.936-2.112,5.61,5.61,0,0,0-3.069-.8,5.7,5.7,0,0,0-3,.8,5.773,5.773,0,0,0-2.1,2.2,6.476,6.476,0,0,0-.77,3.179A6.482,6.482,0,0,0,15.081-2.8,5.9,5.9,0,0,0,17.226-.561,5.958,5.958,0,0,0,20.372.264Zm-.2-10.34a3,3,0,0,1,2.112.792,2.9,2.9,0,0,1,.924,2.068H16.94a3.313,3.313,0,0,1,1.122-2.112A3.208,3.208,0,0,1,20.174-10.076ZM26.422,0h2.926l2.706-3.982L34.738,0h2.926L33.506-5.962l4.18-5.94H34.76L32.054-7.964,29.348-11.9H26.422l4.158,5.94ZM44.088.264a5.925,5.925,0,0,0,3.179-.836,4.64,4.64,0,0,0,1.9-2.112l-2.024-.99a3.73,3.73,0,0,1-1.2,1.243,3.29,3.29,0,0,1-1.837.5,3.458,3.458,0,0,1-2.4-.891,3.433,3.433,0,0,1-1.1-2.409h8.844a3.34,3.34,0,0,0,.088-.572q.022-.308.022-.594A6.154,6.154,0,0,0,48.9-9.251a5.361,5.361,0,0,0-1.936-2.112,5.61,5.61,0,0,0-3.069-.8,5.7,5.7,0,0,0-3,.8,5.773,5.773,0,0,0-2.1,2.2,6.476,6.476,0,0,0-.77,3.179A6.482,6.482,0,0,0,38.8-2.8,5.9,5.9,0,0,0,40.942-.561,5.958,5.958,0,0,0,44.088.264Zm-.2-10.34A3,3,0,0,1,46-9.284a2.9,2.9,0,0,1,.924,2.068h-6.27a3.313,3.313,0,0,1,1.122-2.112A3.208,3.208,0,0,1,43.89-10.076ZM51.546,0h2.486V-16.654H51.546ZM60.9.264a5.6,5.6,0,0,0,2.321-.451,3.635,3.635,0,0,0,1.551-1.254,3.21,3.21,0,0,0,.55-1.859,3.088,3.088,0,0,0-.792-2.123A4.635,4.635,0,0,0,62.26-6.732L60.324-7.3a4.436,4.436,0,0,1-1.034-.484,1.023,1.023,0,0,1-.484-.924,1.212,1.212,0,0,1,.484-1.012,2.068,2.068,0,0,1,1.3-.374,3.005,3.005,0,0,1,1.705.506A2.944,2.944,0,0,1,63.4-8.228l1.914-.9a4.344,4.344,0,0,0-1.8-2.233,5.337,5.337,0,0,0-2.9-.8,5.1,5.1,0,0,0-2.178.451,3.7,3.7,0,0,0-1.518,1.243,3.2,3.2,0,0,0-.55,1.87,3.1,3.1,0,0,0,.759,2.09,4.624,4.624,0,0,0,2.3,1.32l1.87.528a3.923,3.923,0,0,1,1.078.473,1.057,1.057,0,0,1,.506.957,1.259,1.259,0,0,1-.55,1.078,2.391,2.391,0,0,1-1.43.4,3.2,3.2,0,0,1-1.881-.594A4.049,4.049,0,0,1,57.684-3.96l-1.914.9a4.774,4.774,0,0,0,1.925,2.42A5.7,5.7,0,0,0,60.9.264Z",transform:"translate(3959 -2728)",fill:(0,M.dU)("#000","#fff")})]})}),ak=(0,ay.U)(null!=(t=le._.NEXT_PUBLIC_PEXELS_API_KEY)?t:"dummy"),aE=e=>{let{onVideoSelect:l}=e,[n,t]=(0,m.useState)(!1),[o,a]=(0,m.useState)([]),[s,r]=(0,m.useState)(null),[u,c]=(0,m.useState)(""),p=(0,m.useRef)(null),h=(0,m.useRef)(null),[b,x]=(0,m.useState)("landscape"),[v,g]=(0,m.useState)("medium"),[j,f]=(0,m.useState)(0),y=(0,m.useCallback)(async(e,l,n)=>{let{orientation:i,size:o}=n;if(""===e&&a([]),e.length<=2)return void f(0);r(null),t(!0);try{let n=await ak.videos.search({query:e,per_page:24,size:o,orientation:i,page:l});n.error&&r(n.error),(0,e0.O9)(n.videos)&&(0===l?a(n.videos):a(e=>{var l;return[...e,...null!=(l=null==n?void 0:n.videos)?l:[]]}),f(e=>e+1))}catch(e){e&&"object"==typeof e&&"message"in e&&r(e.message),r("Something went wrong")}t(!1)},[]);(0,m.useEffect)(()=>{if(!h.current)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&y(u,j+1,{orientation:b,size:v})},{root:p.current});return h.current&&j>0&&e.observe(h.current),()=>{e.disconnect()}},[y,j,u,b,v]);let I=e=>{let n=e.video_files[0].link;(0,e0.O9)(n)&&l(n)};return le._.NEXT_PUBLIC_PEXELS_API_KEY?(0,i.jsxs)(Z.B,{spacing:4,pt:"2",children:[(0,i.jsxs)(V.z,{align:"flex-start",children:[(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(Q.ks,{autoFocus:!0,placeholder:"Search...",onChange:e=>{c(e),y(e,0,{orientation:b,size:v})},withVariableButton:!1,debounceTimeout:500,forceDebounce:!0,width:"full"}),(0,i.jsxs)(V.z,{children:[(0,i.jsx)(en.Q,{size:"sm",currentItem:b,onItemSelect:e=>{x(e),y(u,0,{orientation:e,size:v})},items:["landscape","portrait","square"]}),(0,i.jsx)(en.Q,{size:"sm",currentItem:v,onItemSelect:e=>{g(e),y(u,0,{orientation:b,size:e})},items:["small","medium","large"]})]})]}),(0,i.jsx)(lN.N,{isExternal:!0,href:"https://www.pexels.com",children:(0,i.jsx)(aC,{width:"100px",height:"40px"})})]}),(0,e0.O9)(s)&&(0,i.jsxs)(lL.F,{status:"error",children:[(0,i.jsx)(lP._,{}),s]}),(0,i.jsxs)(Z.B,{overflowY:"auto",maxH:"400px",ref:p,children:[o.length>0&&(0,i.jsx)(ag.x,{templateColumns:"repeat(3, 1fr)",columnGap:2,rowGap:3,children:o.map((e,l)=>(0,i.jsx)(aj.E,{as:Z.B,boxSize:"100%",spacing:"0",ref:l===o.length-1?h:void 0,children:(0,i.jsx)(aw,{video:e,onClick:()=>I(e)})},e.id))}),n&&(0,i.jsx)(d.s,{justifyContent:"center",py:"4",children:(0,i.jsx)(af.y,{})})]})]}):(0,i.jsx)(eI.E,{children:"NEXT_PUBLIC_PEXELS_API_KEY is missing in environment"})},aw=e=>{let{video:l,onClick:n}=e,{user:t,url:o,video_pictures:a}=l,[s,r]=(0,m.useState)(!1),[d,u]=(0,m.useState)(a[0].picture),[c,h]=(0,m.useState)(1);return(0,m.useEffect)(()=>{let e;return s&&a.length>0?e=setInterval(()=>{h(e=>(e+1)%a.length),u(a[c].picture)},200):(u(a[0].picture),h(1)),()=>{e&&clearInterval(e)}},[s,c,a]),(0,i.jsxs)(p.az,{pos:"relative",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[(0,i.jsx)(iU._,{objectFit:"cover",src:d,alt:"Pexels Video ".concat(l.id),onClick:n,rounded:"md",h:l.height<l.width?"100%":void 0,w:l.height<l.width?"100%":void 0,aspectRatio:4/3,cursor:"pointer"}),(0,i.jsx)(p.az,{pos:"absolute",bottom:0,left:0,bgColor:"rgba(0,0,0,.5)",px:"2",rounded:"md",opacity:+!!s,transition:"opacity .2s ease-in-out",children:(0,i.jsx)(lU.Y,{fontSize:"xs",isExternal:!0,href:o,noOfLines:1,color:"white",children:t.name})})]})},aS=e=>{var l,n,t,o,a,s;let{content:r,updateUrl:d,onSubmit:u}=e,{t:c}=(0,$.WD)(),p=e=>u({...r,isAutoplayEnabled:e});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(Z.B,{py:"2",children:[(0,i.jsx)(Q.ks,{placeholder:c("video.urlInput.placeholder"),defaultValue:null!=(l=null==r?void 0:r.url)?l:"",onChange:d}),(0,i.jsx)(eI.E,{fontSize:"xs",color:"gray.400",textAlign:"center",children:c("video.urlInput.helperText")})]}),(null==r?void 0:r.url)&&(0,i.jsxs)(Z.B,{children:[(0,i.jsx)(Q.ks,{label:c("video.aspectRatioInput.label"),moreInfoTooltip:c("video.aspectRatioInput.moreInfoTooltip"),defaultValue:null!=(n=null==r?void 0:r.aspectRatio)?n:iQ.cf.aspectRatio,onChange:e=>u({...r,aspectRatio:e}),direction:"row"}),(0,i.jsx)(Q.ks,{label:c("video.maxWidthInput.label"),moreInfoTooltip:c("video.maxWidthInput.moreInfoTooltip"),defaultValue:null!=(t=null==r?void 0:r.maxWidth)?t:iQ.cf.maxWidth,onChange:e=>u({...r,maxWidth:e}),direction:"row"})]}),(null==r?void 0:r.url)&&(null==r?void 0:r.type)==="url"&&(0,i.jsx)(Y.R,{label:"Display controls",initialValue:null!=(o=null==r?void 0:r.areControlsDisplayed)?o:iQ.cf.areControlsDisplayed,onCheckChange:e=>!1===e?u({...r,isAutoplayEnabled:!0,areControlsDisplayed:e}):u({...r,areControlsDisplayed:e})}),(0,i.jsx)(Y.R,{label:c("editor.blocks.bubbles.audio.settings.autoplay.label"),initialValue:null!=(a=null==r?void 0:r.isAutoplayEnabled)?a:iQ.cf.isAutoplayEnabled,isChecked:null!=(s=null==r?void 0:r.isAutoplayEnabled)?s:iQ.cf.isAutoplayEnabled,isDisabled:(null==r?void 0:r.areControlsDisplayed)===!1,onCheckChange:()=>{var e;return p(!(null!=(e=null==r?void 0:r.isAutoplayEnabled)?e:iQ.cf.isAutoplayEnabled))}})]})};var aT=n(40904);let aV=["link","pexels"],aM=e=>{var l,n;let{content:t,onSubmit:o,initialTab:a,...s}=e,r="includedTabs"in s&&null!=(l=s.includedTabs)?l:aV,d="excludedTabs"in s&&null!=(n=s.excludedTabs)?n:[],u=aV.filter(e=>!d.includes(e)&&r.includes(e)),[c,p]=(0,m.useState)(null!=a?a:u[0]),h=e=>{let{type:l,url:n,id:i,videoSizeSuggestion:a}=(0,aT.u)(e);return"link"!==c&&p("link"),o({...t,type:l,url:n,id:i,...!(null==t?void 0:t.aspectRatio)&&!(null==t?void 0:t.maxWidth)?a:{}})};return(0,i.jsxs)(Z.B,{children:[(0,i.jsxs)(V.z,{children:[u.includes("link")&&(0,i.jsx)(A.$,{variant:"link"===c?"solid":"ghost",onClick:()=>p("link"),size:"sm",children:"Link"}),u.includes("pexels")&&(0,i.jsx)(A.$,{variant:"pexels"===c?"solid":"ghost",onClick:()=>p("pexels"),size:"sm",children:"Pexels"})]}),"link"===c&&(0,i.jsx)(aS,{content:t,updateUrl:h,onSubmit:o}),"pexels"===c&&(0,i.jsx)(aE,{onVideoSelect:h})]})},aA=e=>{let l=(0,m.useRef)(null);return(0,i.jsx)(u.Z,{children:(0,i.jsxs)(lM.h,{onMouseDown:e=>e.stopPropagation(),w:e.block.type===at.o.IMAGE?"500px":"400px",children:[(0,i.jsx)(te.R,{}),(0,i.jsx)(tl.e,{ref:l,shadow:"md",children:(0,i.jsx)(aB,{...e})})]})})},aB=e=>{let{uploadFileProps:l,block:n,onContentChange:t}=e;switch(n.type){case at.o.IMAGE:return(0,i.jsx)(am,{uploadFileProps:l,block:n,onContentChange:t});case at.o.VIDEO:return(0,i.jsx)(aM,{content:n.content,onSubmit:t});case at.o.EMBED:return(0,i.jsx)(ab,{content:n.content,onSubmit:t});case at.o.AUDIO:return(0,i.jsx)(ap,{content:n.content,uploadFileProps:l,onContentChange:t})}},aR=e=>{var l,n,t;let{block:o,isConnectable:s,indices:r,onMouseDown:u}=e,c=(0,M.dU)("gray.50","gray.900"),p=(0,M.dU)("orange.400","orange.300"),h=(0,M.dU)("gray.200","gray.900"),{pathname:x,query:v}=(0,nW.useRouter)(),{setConnectingIds:g,connectingIds:j,openedNodeId:f,setOpenedNodeId:y,setFocusedGroupId:I,previewingEdge:C,isReadOnly:S,isAnalytics:T,previewingBlock:A}=(0,w.u)(),{mouseOverBlock:B,setMouseOverBlock:R}=(0,E.jh)(),{typebot:O,updateBlock:D}=(0,a.V)(),[L,P]=(0,m.useState)(!1),[G,W]=(0,m.useState)(!0),U=(0,m.useRef)(null),z=L||(null==C?void 0:C.to.blockId)===o.id||(null==A?void 0:A.id)===o.id,K=null==O||null==(l=O.groups.at(r.groupIndex))?void 0:l.id,_=(0,k.r)(e=>e.isDraggingGraph);(0,E.Lt)({ref:U,onDrag:e=>{u&&u(e,o)},isDisabled:!u,deps:[f]});let{isOpen:H,onOpen:Q,onClose:Y}=(0,eV.j)();(0,m.useEffect)(()=>{var e;(null==(e=v.blockId)?void 0:e.toString())===o.id&&y(o.id)},[o.id,v,y]),(0,m.useEffect)(()=>{var e,l;P((null==j||null==(e=j.target)?void 0:e.groupId)===K&&(null==j||null==(l=j.target)?void 0:l.blockId)===o.id)},[j,o.id,K]);let J=()=>{!S&&((null==B?void 0:B.id)!==o.id&&U.current&&R({id:o.id,element:U.current}),j&&K&&g({...j,target:{groupId:K,blockId:o.id}}))},Z=()=>{B&&R(void 0),(null==j?void 0:j.target)&&g({...j,target:{...j.target,blockId:void 0}})},X=e=>{I(K),e.stopPropagation(),y(o.id)},q=e=>D(r,{...o,...e}),$=e=>D(r,{...o,content:e});(0,m.useEffect)(()=>{if(!U.current)return;let e=U.current;return e.addEventListener("pointerdown",e=>e.stopPropagation()),()=>{e.removeEventListener("pointerdown",e=>e.stopPropagation())}},[]);let ee=(e,l)=>{if(!("options"in o)||!o.options)return;let n=e.transform?e.transform(o.options):o.options;try{D(r,l.parse({...o,type:e.blockId,options:{...n,credentialsId:void 0}})),y(o.id)}catch(e){if(e instanceof iR.G){let l=(0,iO.yu)(e);console.error(l),N.oR.error("Could not convert block",{description:l.toString()})}else N.oR.error("An error occured while converting the block")}},el=null==O?void 0:O.edges.some(e=>e.to.blockId===o.id);return f===o.id&&(0,b.p6)(o)?(0,i.jsx)(iA,{id:o.id,initialValue:null!=(t=null==(n=o.content)?void 0:n.richText)?t:[],onChange:e=>{D(r,{...o,content:{richText:e}})},onClose:()=>{y(void 0),W(!1),setTimeout(()=>{W(!0)},100)}}):(0,i.jsx)(F,{renderMenu:e=>{let{onClose:l}=e;return(0,i.jsx)(ad,{indices:r,block:o,onTurnIntoClick:(e,n)=>{ee(e,n),l()}})},isDisabled:!G,children:(e,l)=>{var n,t;return(0,i.jsxs)(lT.A,{placement:"left",isLazy:!0,isOpen:f===o.id,closeOnBlur:!1,children:[(0,i.jsx)(tf.W,{children:(0,i.jsx)(d.s,{pos:"relative",ref:tg([e,U]),onMouseEnter:J,onMouseLeave:Z,onClick:X,"data-testid":"block ".concat(o.id),w:"full",className:"prevent-group-drag",pointerEvents:T||_?"none":"auto",children:(0,i.jsxs)(V.z,{flex:"1",userSelect:"none",p:"3",borderWidth:l||z?"2px":"1px",borderColor:l||z?p:h,margin:l||z?"-1px":0,rounded:"lg",cursor:"pointer",bg:c,align:"flex-start",w:"full",transition:"border-color 0.2s",children:[(0,i.jsx)(nd.t,{type:o.type,mt:".25rem"}),(null==O||null==(n=O.groups.at(r.groupIndex))?void 0:n.id)&&(0,i.jsx)(ao,{block:o,indices:r,groupId:null==(t=O.groups.at(r.groupIndex))?void 0:t.id}),(el||(0,e0.O9)(j))&&(0,i.jsx)(iL,{pos:"absolute",left:"-34px",top:"16px",blockId:o.id,groupId:K}),(s||x.endsWith("analytics")&&(0,b.Ke)(o))&&iB(o)&&K&&(0,i.jsx)(iD,{source:{blockId:o.id},groupId:K,pos:"absolute",right:"-34px",bottom:"10px",isHidden:!s})]})})}),aO(o)&&(0,i.jsx)(tv,{node:o,groupId:K,onNodeChange:q,isOpen:f===o.id}),O&&aD(o)&&(0,i.jsx)(aA,{uploadFileProps:{workspaceId:O.workspaceId,typebotId:O.id,blockId:o.id},block:o,onContentChange:$})]})}})},aO=e=>!(0,b.c9)(e)&&e.type!==ti.G.CONDITION&&e.type!==ti.G.RETURN,aD=e=>(0,b.c9)(e)&&!(0,b.p6)(e),aL=e=>{let{block:l,indices:n,...t}=e;return(0,i.jsxs)(V.z,{p:"3",borderWidth:"1px",rounded:"lg",borderColor:(0,M.dU)("gray.200","gray.900"),bgColor:(0,M.dU)("gray.50","gray.900"),cursor:"grab",w:"264px",pointerEvents:"none",shadow:"md",...t,children:[(0,i.jsx)(nd.t,{type:l.type}),(0,i.jsx)(ao,{block:l,indices:n,groupId:""})]})},aP=e=>{var l;let{blocks:n,groupIndex:t,groupRef:o}=e,{draggedBlock:s,setDraggedBlock:r,draggedBlockType:d,mouseOverGroup:c,setDraggedBlockType:p}=(0,E.jh)(),{typebot:h,createBlock:x,detachBlockFromGroup:v}=(0,a.V)(),{isReadOnly:g,graphPosition:j,setOpenedNodeId:f}=(0,w.u)(),[y,I]=(0,m.useState)(),C=(0,m.useRef)([]),[k,S]=(0,m.useState)({x:0,y:0}),[T,V]=(0,m.useState)({x:0,y:0}),M=null==h||null==(l=h.groups.at(t))?void 0:l.id,A=(s||d)&&(null==c?void 0:c.id)===M,B=(0,e0.O9)(s||d);(0,m.useEffect)(()=>{(null==c?void 0:c.id)!==M&&I(void 0)},[M,null==c?void 0:c.id]);let R=e=>(l,n)=>{let{relative:i,absolute:o}=l;!g&&M&&(C.current.splice(e+1,1),V(i),S({x:o.x-i.x,y:o.y-i.y}),r({...n,groupId:M}),v({groupIndex:t,blockIndex:e}))},O=e=>l=>{l&&(C.current[e]=l)},D=(0,m.useCallback)(e=>{A&&I((0,E.ZV)(e.pageY,C))},[A]);(0,m.useEffect)(()=>{var e;return null==(e=o.current)||e.addEventListener("mousemove",D),()=>{var e;null==(e=o.current)||e.removeEventListener("mousemove",D)}},[D]);let L=(0,m.useCallback)(e=>{if(!(null==s?void 0:s.groupId)||s.groupId!==M)return;let{clientX:l,clientY:n}=e;S({x:l-T.x,y:n-T.y})},[null==s?void 0:s.groupId,M,T.x,T.y]);(0,m.useEffect)(()=>(window.addEventListener("mousemove",L),()=>{window.removeEventListener("mousemove",L)}),[L]);let P=(0,m.useCallback)(e=>{if(I(void 0),!A||!M)return;let l=x(s||d,{groupIndex:t,blockIndex:(0,E.ZV)(e.clientY,C)});r(void 0),p(void 0),(0,b.sU)(d)&&f(l)},[A,M,s,d,t]);return(0,m.useEffect)(()=>{var e;return null==(e=o.current)||e.addEventListener("mouseup",P,{capture:!0}),()=>{var e;null==(e=o.current)||e.removeEventListener("mouseup",P,{capture:!0})}},[P]),(0,i.jsxs)(Z.B,{spacing:0,transition:"none",children:[(0,i.jsx)(ih,{isVisible:B,isExpanded:0===y,ref:O(0),expandedHeightPixels:50,expandedPaddingPixel:8,initialPaddingPixel:2,initialHeightPixels:4}),h&&n.map((e,l)=>(0,i.jsxs)(Z.B,{spacing:0,children:[(0,i.jsx)(aR,{block:e,indices:{groupIndex:t,blockIndex:l},isConnectable:n.length-1===l,onMouseDown:R(l)},e.id),(0,i.jsx)(ih,{isVisible:B,isExpanded:y===l+1,ref:O(l+1),expandedHeightPixels:50,expandedPaddingPixel:8,initialPaddingPixel:2,initialHeightPixels:4})]},e.id)),s&&s.groupId===M&&(0,i.jsx)(u.Z,{children:(0,i.jsx)(aL,{block:s,indices:{groupIndex:t,blockIndex:0},pos:"fixed",top:"0",left:"0",style:{transform:"translate(".concat(k.x,"px, ").concat(k.y,"px) rotate(-2deg) scale(").concat(j.scale,")")},transformOrigin:"0 0 0"})})]})},aN=()=>{let{pathname:e}=(0,nW.useRouter)();return e.includes("/analytics")},aG=e=>{let{groupId:l,isReadOnly:n,onPlayClick:t}=e,o=aN(),{hasCopied:a,onCopy:s}=(0,tw.i)(l),r=()=>{dispatchEvent(new KeyboardEvent("keydown",{key:"c",[tE()?"metaKey":"ctrlKey"]:!0}))};return(0,i.jsxs)(V.z,{rounded:"md",spacing:0,borderWidth:"1px",bgColor:(0,M.dU)("white","gray.900"),shadow:"md",children:[!o&&(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.ud,{}),borderRightWidth:"1px",borderRightRadius:"none","aria-label":"Preview bot from this group",variant:"ghost",onClick:t,size:"sm"}),!n&&(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.Td,{}),borderRightWidth:"1px",borderRightRadius:"none",borderLeftRadius:"none","aria-label":"Copy group",variant:"ghost",onClick:e=>{e.stopPropagation(),r()},size:"sm"}),(0,i.jsx)(tS.m,{label:a?"Copied!":l,closeOnClick:!1,placement:"top",children:(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.mo,{}),borderRightWidth:"1px",borderRightRadius:"none",borderLeftRadius:"none","aria-label":"Show group info",variant:"ghost",size:"sm",onClick:s})}),!n&&(0,i.jsx)(B.K,{"aria-label":"Delete",borderLeftRadius:"none",icon:(0,i.jsx)(S.uc,{}),onClick:()=>{dispatchEvent(new KeyboardEvent("keydown",{key:"Backspace"}))},variant:"ghost",size:"sm"})]})},aW=()=>{let{t:e}=(0,$.WD)();return(0,i.jsxs)(ts.c,{children:[(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.Td,{}),onClick:()=>dispatchEvent(new KeyboardEvent("keydown",{key:"c",[tE()?"metaKey":"ctrlKey"]:!0})),children:e("copy")}),(0,i.jsx)(tr.D,{icon:(0,i.jsx)(S.uc,{}),onClick:()=>dispatchEvent(new KeyboardEvent("keydown",{key:"Backspace"})),children:e("delete")})]})},aU=e=>{let{group:l,groupIndex:n}=e,t=(0,M.dU)("white","gray.950"),o=(0,M.dU)("orange.400","orange.300"),s=(0,M.dU)("gray.200","gray.700"),{connectingIds:r,setConnectingIds:d,previewingEdge:u,previewingBlock:c,isReadOnly:p,graphPosition:h}=(0,w.u)(),{typebot:b,updateGroup:x,updateGroupsCoordinates:g}=(0,a.V)(),{setMouseOverGroup:y,mouseOverGroup:I}=(0,E.jh)(),{setStartPreviewFrom:C}=(0,K.h)(),[,S]=(0,tj.o)(),[T,V]=(0,m.useState)(!1),[A,B]=(0,m.useState)(!1),[R,O]=(0,m.useState)(l.title),D=(null==c?void 0:c.groupId)===l.id||u&&("groupId"in u.from&&u.from.groupId===l.id||u.to.groupId===l.id&&(0,e0.pN)(u.to.blockId)),L=(0,m.useRef)(null),P=(0,k.r)(e=>e.isDraggingGraph),N=(0,k.r)((0,j.k)(e=>e.focusedElementsId)),G=(0,k.r)((0,j.k)(e=>e.elementsCoordinates?e.elementsCoordinates[l.id]:l.graphCoordinates)),{moveFocusedElements:W,focusElement:U,getElementsCoordinates:z}=(0,k.r)((0,j.k)(e=>({getElementsCoordinates:e.getElementsCoordinates,moveFocusedElements:e.moveFocusedElements,focusElement:e.focusElement})));(0,m.useEffect)(()=>{var e,n;B((null==r||null==(e=r.target)?void 0:e.groupId)===l.id&&(0,e0.pN)(null==(n=r.target)?void 0:n.blockId))},[r,l.id]),(0,m.useEffect)(()=>{l.title!==R&&O(l.title)},[l.title]);let _=e=>x(n,{title:e}),H=()=>{!p&&((null==I?void 0:I.id)!==l.id&&L.current&&y({id:l.id,element:L.current}),r&&d({...r,target:{groupId:l.id}}))},Q=()=>{!p&&(y(void 0),r&&d({...r,target:void 0}))},Y=()=>{C({type:"group",id:l.id}),S("preview")};(0,v.useDrag)(e=>{var n;let{first:t,last:i,delta:o,event:a,target:s}=e;if(a.stopPropagation(),null==(n=s.closest(".prevent-group-drag"))||!n.classList.contains("prevent-group-drag")){if(t){if(V(!0),N.find(e=>e===l.id)&&!a.shiftKey)return;U(l.id,a.shiftKey)}if(W({x:o[0]/h.scale,y:o[1]/h.scale}),i){let e=z();if(!e)return;g(e),V(!1)}}},{target:L,pointer:{keys:!1},from:()=>[G.x*h.scale,G.y*h.scale]});let J=N.includes(l.id);return(0,i.jsx)(F,{onOpen:()=>U(l.id),renderMenu:()=>(0,i.jsx)(aW,{}),isDisabled:p,children:(e,a)=>{var r,d;return(0,i.jsxs)(Z.B,{ref:tg([e,L]),id:"group-".concat(l.id),"data-testid":"group",className:"group","data-selectable":l.id,userSelect:"none",px:"4",pt:"4",pb:"2",rounded:"xl",bg:t,borderWidth:"1px",borderColor:A||a||D||J?o:void 0,w:f.mI,transition:"border 300ms, box-shadow 200ms",pos:"absolute",style:{transform:"translate(".concat(null!=(r=null==G?void 0:G.x)?r:0,"px, ").concat(null!=(d=null==G?void 0:G.y)?d:0,"px)"),touchAction:"none"},onMouseEnter:H,onMouseLeave:Q,cursor:T?"grabbing":"pointer",_hover:{shadow:"md"},zIndex:J?1:void 0,spacing:0,pointerEvents:P?"none":"auto",children:[(0,i.jsxs)(id.F,{value:R,onChange:O,onSubmit:_,fontWeight:"medium",pr:"8",children:[(0,i.jsx)(iu.l,{_hover:{bg:s},px:"1",style:(0,e0.Im)(R)?{display:"block",position:"absolute",top:"10px",width:"50px"}:void 0}),(0,i.jsx)(ic.j,{minW:"0",px:"1",className:"prevent-group-drag"})]}),b&&(0,i.jsx)(aP,{blocks:l.blocks,groupIndex:n,groupRef:e}),1===N.length&&(0,i.jsx)(tn.s,{in:J,style:{position:"absolute",top:"-50px",right:0},unmountOnExit:!0,children:(0,i.jsx)(aG,{groupId:l.id,isReadOnly:p,onPlayClick:Y})})]})}})},az=(0,m.memo)(e=>{let{edges:l,groups:n,events:t,edgesWithTotalUsers:o,totalAnswers:a,onUnlockProPlanClick:s}=e,r=n.flatMap(e=>e.blocks).filter(b.Ke).map(e=>e.id);return(0,i.jsxs)(tI,{children:[(0,i.jsx)(ir,{edges:l,groups:n,totalAnswers:a,edgesWithTotalUsers:o,inputBlockIds:r,onUnlockProPlanClick:s}),t.map((e,l)=>(0,i.jsx)(tN,{event:e,eventIndex:l},e.id)),n.map((e,l)=>(0,i.jsx)(aU,{group:e,groupIndex:l},e.id))]})}),aF=e=>{let{origin:l,dimension:n}=e;return(0,i.jsx)(p.az,{pos:"absolute",rounded:"md",borderWidth:1,borderColor:"orange.200",bgColor:"rgba(255, 214, 199, 0.1)",style:{left:l.x,top:l.y,width:n.width,height:n.height}})},aK=e=>{let{onZoomInClick:l,onZoomOutClick:n}=e;return(0,i.jsxs)(Z.B,{bgColor:(0,M.dU)("white","gray.950"),rounded:"md",spacing:"0",shadow:"md",children:[(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.c1,{}),"aria-label":"Zoom in",size:"sm",onClick:l,bgColor:(0,M.dU)("white",void 0),borderBottomRadius:0}),(0,i.jsx)(B.K,{icon:(0,i.jsx)(S.QG,{}),"aria-label":"Zoom out",size:"sm",onClick:n,bgColor:(0,M.dU)("white",void 0),borderTopRadius:0})]})},a_=e=>{var l;let{typebot:n,totalAnswers:t,edgesWithTotalUsers:S,onUnlockProPlanClick:T,...V}=e,{draggedBlockType:M,setDraggedBlockType:A,draggedEventType:B,setDraggedEventType:R,draggedBlock:O,setDraggedBlock:D,draggedItem:L,setDraggedItem:P}=(0,E.jh)(),{createGroup:N,createEvent:W}=(0,a.V)(),{user:U}=(0,s.J)(),{isReadOnly:z,setGraphPosition:F,setOpenedNodeId:K,setPreviewingEdge:_,connectingIds:H}=(0,w.u)(),Q=(0,k.r)(e=>e.isDraggingGraph),Y=(0,k.r)(e=>e.setIsDraggingGraph),J=(0,k.r)((0,j.k)(e=>e.focusedElementsId)),{setElementsCoordinates:Z,blurElements:X,setFocusedElements:q,updateElementCoordinates:$}=(0,k.r)((0,j.k)(e=>({updateElementCoordinates:e.updateElementCoordinates,setElementsCoordinates:e.setElementsCoordinates,blurElements:e.blurElements,setFocusedElements:e.setFocusedElements}))),[ee,el]=(0,m.useState)((0,f.wA)(null!=(l=n.events[0].graphCoordinates)?l:{x:0,y:0})),[en,et]=(0,m.useState)(),[ei,eo]=(0,m.useState)(),[ea,es]=(0,m.useState)(),[er,ed]=(0,m.useState)(!1),eu=(0,m.useRef)(null),ec=(0,m.useRef)(null);aH(en,el);let[ep]=(0,g.d7)(ee,200),eh=(0,m.useMemo)(()=>"translate(".concat(Number(ee.x.toFixed(2)),"px, ").concat(Number(ee.y.toFixed(2)),"px) scale(").concat(ee.scale,")"),[ee]);(0,m.useEffect)(()=>{ec.current=document.getElementById("editor-container")},[]),(0,m.useEffect)(()=>{if(!eu.current)return;let{top:e,left:l}=eu.current.getBoundingClientRect();F({x:l+ep.x,y:e+ep.y,scale:ep.scale})},[ep,F]),(0,m.useEffect)(()=>{Z({groups:n.groups,events:n.events})},[]),(0,v.useGesture)({onDrag:e=>{if(Q||(null==U?void 0:U.graphNavigation)!==x.xU.TRACKPAD&&!e.shiftKey){e.first&&ed(!0),e.last&&ed(!1),el({...ee,x:ee.x+e.delta[0],y:ee.y+e.delta[1]});return}if(z)return;let l=e.first?Array.from(document.querySelectorAll("[data-selectable]")).map(e=>({elementId:e.dataset.selectable,rect:e.getBoundingClientRect()})):ea;e.first&&es(l);let n=y(e);eo(n);let t=l.reduce((e,l)=>I(n,l.rect)?[...e,l.elementId]:e,[]);t.length>0&&q(t)},onWheel:e=>{let{shiftKey:l,delta:[n,t],pinching:i}=e;i||el({...ee,x:l?ee.x-t:ee.x-n,y:l?ee.y:ee.y-t})},onPinch:e=>{let{origin:[l,n],offset:[t]}=e;ex({scale:t,mousePosition:{x:l,y:n}})}},{target:eu,pinch:{scaleBounds:{min:.2,max:2},modifierKey:"ctrlKey"},drag:{pointer:{keys:!1}}}),(0,r.M)("wheel",e=>{e.preventDefault()},eu.current,{passive:!1});let eb=()=>{var e,l,n,t;return{x:(null!=(n=null==(e=eu.current)?void 0:e.clientWidth)?n:0)/2,y:(null!=(t=null==(l=eu.current)?void 0:l.clientHeight)?t:0)/2}},ex=e=>{let{scale:l,mousePosition:n,delta:t}=e,{x:i,y:a}=null!=n?n:eb(),s=a-o.$,r=ee.scale+(null!=t?t:0);if(l){let e=l-ee.scale;r+=Math.min(.2,Math.abs(e))*Math.sign(e)}if(r>=2&&2===ee.scale||r<=.2&&.2===ee.scale)return;r=r>=2?2:r<=.2?.2:r;let d=(i-ee.x)/ee.scale,u=(s-ee.y)/ee.scale;el({...ee,x:i-d*r,y:s-u*r,scale:r})};return(0,r.M)("keydown",e=>{" "!==e.key||e.metaKey||e.ctrlKey||e.altKey||e.shiftKey||Y(!0)}),(0,r.M)("keyup",e=>{" "===e.key&&(Y(!1),ed(!1))}),(0,r.M)("blur",()=>{Y(!1),ed(!1)},window),(0,r.M)("mousedown",e=>{2===e.button&&e.stopPropagation()},void 0,{capture:!0}),(0,r.M)("mouseup",e=>{if(!n||(L&&P(void 0),!O&&!M&&!B))return;let l=C({x:e.clientX,y:e.clientY},ee),t=(0,h.sX)();if($(t,l),B)W({id:t,type:B,graphCoordinates:l}),R(void 0),K(t);else{let e=N({id:t,...l,block:null!=O?O:M,indices:{groupIndex:n.groups.length,blockIndex:0}});D(void 0),A(void 0),e&&(0,b.sU)(M)&&K(e)}},eu.current),(0,r.M)("pointerup",e=>{Q||2===e.button||((!ei||Math.abs(null==ei?void 0:ei.dimension.width)+Math.abs(null==ei?void 0:ei.dimension.height)<5)&&X(),eo(void 0),K(void 0),_(void 0))},ec.current),(0,r.M)("mousemove",e=>H?e.clientX<=50?et("left"):e.clientY<=50+o.$?et("top"):e.clientX>=window.innerWidth-50?et("right"):e.clientY>=window.innerHeight-50?et("bottom"):void et(void 0):en?et(void 0):void 0),(0,r.M)("gesturestart",e=>e.preventDefault()),(0,r.M)("gesturechange",e=>e.preventDefault()),(0,i.jsxs)(d.s,{ref:eu,style:{touchAction:"none",cursor:Q?er?"grabbing":"grab":"auto"},...V,children:[(0,i.jsx)(d.s,{flex:"1",w:"full",h:"full",position:"absolute","data-testid":"graph",style:{transform:eh,perspective:1e3,backfaceVisibility:"hidden",transformStyle:"preserve-3d"},willChange:"transform",transformOrigin:"0px 0px 0px",children:(0,i.jsx)(az,{edges:n.edges,groups:n.groups,events:n.events,totalAnswers:t,edgesWithTotalUsers:S,onUnlockProPlanClick:T})}),!z&&(0,i.jsxs)(u.Z,{children:[ei&&(0,i.jsx)(aF,{...ei}),(0,i.jsx)(c.z,{in:!z&&J.length>1,children:(0,i.jsx)(p.az,{pos:"absolute",top:"calc(".concat(o.$,"px + 20px)"),right:"140px",children:(0,i.jsx)(G,{graphPosition:ee,focusedElementIds:J,blurElements:X,isReadOnly:z})})})]}),(0,i.jsx)(p.az,{pos:"absolute",top:"70px",right:"40px",children:(0,i.jsx)(aK,{onZoomInClick:()=>ex({delta:.2}),onZoomOutClick:()=>ex({delta:-.2})})})]})},aH=(e,l)=>(0,m.useEffect)(()=>{if(!e)return;let n=setInterval(()=>{l(l=>({...l,x:"right"===e?l.x-5:"left"===e?l.x+5:l.x,y:"bottom"===e?l.y-5:"top"===e?l.y+5:l.y}))},5);return()=>{clearInterval(n)}},[e,l])},92812:(e,l,n)=>{n.d(l,{h:()=>u});var t=n(6029),i=n(12525),o=n(29328),a=n(58671),s=n(66425),r=n(49377),d=n(90869);let u=e=>{let{options:l,value:n,defaultValue:a,direction:s="row",size:r="md",onSelect:d}=e,{getRootProps:u,getRadioProps:b}=(0,i.m)({value:n,defaultValue:a,onChange:d}),x=u();return(0,t.jsx)(o.B,{...x,direction:s,children:l.map(e=>{let l=b({value:p(e)});return(0,t.jsx)(c,{...l,size:r,children:h(e)},p(e))})})},c=e=>{let{getInputProps:l,getCheckboxProps:n}=(0,a.z)(e),i=l(),o=n();return(0,t.jsxs)(s.az,{as:"label",flex:"1",children:[(0,t.jsx)("input",{...i}),(0,t.jsx)(r.s,{...o,cursor:"pointer",borderWidth:"2px",borderRadius:"md",_checked:{borderColor:"orange.400"},_hover:{bgColor:(0,d.dU)("gray.100","gray.700")},_active:{bgColor:(0,d.dU)("gray.200","gray.600")},px:"sm"===e.size?3:5,py:"sm"===e.size?1:2,transition:"background-color 150ms, color 150ms, border 150ms",justifyContent:"center",fontSize:"sm"===e.size?"sm":void 0,children:e.children})]})},p=e=>"string"==typeof e?e:e.value,h=e=>"string"==typeof e?e:e.label},97894:(e,l,n)=>{n.d(l,{i:()=>s,u:()=>r});var t=n(6029),i=n(55729),o=n(25685);let a=(0,i.createContext)({graphPosition:(0,o.wA)({x:0,y:0}),connectingIds:null}),s=e=>{let{children:l,isReadOnly:n=!1,isAnalytics:s=!1}=e,[r,d]=(0,i.useState)((0,o.wA)({x:0,y:0})),[u,c]=(0,i.useState)(null),[p,h]=(0,i.useState)(),[b,x]=(0,i.useState)(),[v,m]=(0,i.useState)(),[g,j]=(0,i.useState)();return(0,t.jsx)(a.Provider,{value:{graphPosition:r,setGraphPosition:d,connectingIds:u,setConnectingIds:c,previewingEdge:p,setPreviewingEdge:h,openedNodeId:v,setOpenedNodeId:m,isReadOnly:n,focusedGroupId:g,setFocusedGroupId:j,setPreviewingBlock:x,previewingBlock:b,isAnalytics:s},children:l})},r=()=>(0,i.useContext)(a)}}]);